!function(t,e){
"object"==typeof exports&&"object"==typeof module?module.exports=e(require("uu_appg01_core"),require("module")):"function"==typeof define&&define.amd?define("uu_appg01_oidc",["uu_appg01_core","module"],e):"object"==typeof exports?exports.uu_appg01_oidc=e(require("uu_appg01_core"),require("module")):(t.UuApp=t.UuApp||{},
t.UuApp.Oidc=e(t.UuApp,t[void 0]))}(window,(function(t,e){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}}
;return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){
"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),
8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),
2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t}
;return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=19)}([function(t,e,n){t.exports=n(4).Authentication},function(t,e,n){t.exports=n(4).Util
},function(t,e,n){t.exports=n(4).AppClient},function(t,e,n){t.exports=n(4).Logging},function(e,n){e.exports=t},function(t,e,n){"use strict";function r(t,e,n,r,i,s,o){try{var a=t[s](o),u=a.value
}catch(t){return void n(t)}a.done?e(u):Promise.resolve(u).then(r,i)}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),
Object.defineProperty(t,r.key,r)}}
var s=n(1),o=s.Config,a=(s.BaseError,n(2)),u=a.AppClient,c=a.PerflogHandler,h=a.RemoteErrorHandler,l=a.TransformParametersHandler,f=a.ApplicationError,d=n(7),p=n(10),g=n(6),v=document.querySelector("base"),y=location.protocol+"//"+location.host+(v&&v.getAttribute("data-uu-app-base"))||"/",m=[c,h,l],S=new d("client_id",{
maxSize:256,maxAge:36e5}),b=Math.random().toString(16).substring(2,10),x=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}
var e,n,s,a,c;return e=t,n=null,s=[{key:"getClientCredentials",value:(a=regeneratorRuntime.mark((function t(e){var n,r,i,s,a,c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){
case 0:if(n=p.sha1("".concat(y,":").concat(e)),r=S.get(n)){t.next=25;break}if(!o.getBoolean("uu_app_oidc_backend_available")){t.next=20;break}return i=null,t.prev=5,s={serviceName:e},a={interceptors:m
},t.next=10,u.get("".concat(y,"oidc/getClientId"),s,a);case 10:i=t.sent,r=i.data.clientId,t.next=20;break;case 14:if(t.prev=14,t.t0=t.catch(5),!(t.t0 instanceof f&&404===t.t0.status)){t.next=19;break}
t.next=20;break;case 19:throw t.t0;case 20:!r&&(c=o.get("".concat("uu_app_oidc_providers_").concat(e,"_client_credentials")))&&(r=c.client_id||c.clientId),
r||(r=o.get("".concat("uu_app_oidc_providers_").concat(e,"_client_id"))),r||(r=o.get("uuoidc.clientId")),
r||(r=o.get("".concat("uu_app_oidc_providers_").concat(e,"_unregistered_client_id"))||"".concat("uu-oidc:unregistered-client:").concat(b)),S.set(n,r);case 25:return this._clientIds[n]=r,
t.abrupt("return",{client_id:r,client_secret:null});case 27:case"end":return t.stop()}}),t,this,[[5,14]])})),c=function(){var t=this,e=arguments;return new Promise((function(n,i){var s=a.apply(t,e)
;function o(t){r(s,n,i,o,u,"next",t)}function u(t){r(s,n,i,o,u,"throw",t)}o(void 0)}))},function(t){return c.apply(this,arguments)})},{key:"getClientCredentialsSync",value:function(t){
var e=p.sha1("".concat(y,":").concat(t)),n=this._clientIds[e];if(!n)throw new g("Asynchronous method getClientCredentials must be invoked prior to synchronous invocation");return{client_id:n,
client_secret:null}}}],n&&i(e.prototype,n),s&&i(e,s),t}();x._clientIds={},t.exports=x},function(t,e,n){"use strict";function r(t){
return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){
return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}
function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function o(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1
;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){
var n,r=u(t);if(e){var i=u(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return a(this,n)}}function a(t,e){
return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function u(t){
return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var c=function(t){!function(t,e){
if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}
}),e&&s(t,e)}(n,t);var e=o(n);function n(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return i(this,n),e.call(this,t,r)}return n}(n(1).BaseError);t.exports=c},function(t,e,n){
"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){
return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}
function s(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function o(t,e,n){
return(o="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=l(t)););return t}(t,e);if(r){
var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){
var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{
return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=l(t);if(e){var i=l(this).constructor
;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return c(this,n)}}function c(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?h(t):e}function h(t){
if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){
return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function")
;t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}(f,t);var e,n,r,c=u(f);function f(t){
var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};i(this,f),(e=c.call(this,n))._name="uu_app_oidc_cache_".concat(t);var r=localStorage.getItem(e._name);return r&&e.fromJSON(r),
localStorage.setItem(e._name,JSON.stringify(h(e))),e}return e=f,(n=[{key:"set",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null
;this.fromJSON(localStorage.getItem(this._name));var r=o(l(f.prototype),"set",this).call(this,t,e,n);return localStorage.setItem(this._name,JSON.stringify(this)),r}},{key:"get",value:function(t){
this.fromJSON(localStorage.getItem(this._name));var e=o(l(f.prototype),"get",this).call(this,t);return localStorage.setItem(this._name,JSON.stringify(this)),e}},{key:"delete",value:function(t){
this.fromJSON(localStorage.getItem(this._name));var e=o(l(f.prototype),"delete",this).call(this,t);return localStorage.setItem(this._name,JSON.stringify(this)),e}},{key:"clear",value:function(){
var t=o(l(f.prototype),"clear",this).call(this);return localStorage.setItem(this._name,JSON.stringify(this)),t}}])&&s(e.prototype,n),r&&s(e,r),f}(n(12));t.exports=f},function(t,e,n){"use strict"
;(function(e){function n(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var r=function(){
function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var r,i,s;return r=t,s=[{key:"encode",value:function(t){
return e.from(t,"utf8").toString("base64")}},{key:"decode",value:function(t){return e.from(t,"base64").toString("utf8")}},{key:"urlSafeEncode",value:function(t){
var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.encode(t);return n=n.replace(/\+/g,"-").replace(/\//g,"_"),e&&(n=n.replace(/=/g,"")),n}},{key:"urlSafeDecode",value:function(t){
var e=t.replace(/-/g,"+").replace(/_/g,"/");return this.decode(e)}}],(i=null)&&n(r.prototype,i),s&&n(r,s),t}();t.exports=r}).call(this,n(13).Buffer)},function(t,e,n){"use strict";function r(t){
return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){
return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e,n,r,i,s,o){try{var a=t[s](o),u=a.value}catch(t){return void n(t)}
a.done?e(u):Promise.resolve(u).then(r,i)}function s(t){return function(){var e=this,n=arguments;return new Promise((function(r,s){var o=t.apply(e,n);function a(t){i(o,r,s,a,u,"next",t)}function u(t){
i(o,r,s,a,u,"throw",t)}a(void 0)}))}}function o(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return
;var n=[],r=!0,i=!1,s=void 0;try{for(var o,a=t[Symbol.iterator]();!(r=(o=a.next()).done)&&(n.push(o.value),!e||n.length!==e);r=!0);}catch(t){i=!0,s=t}finally{try{r||null==a.return||a.return()}finally{
if(i)throw s}}return n}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return a(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name)
;if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return a(t,e)}(t,e)||function(){
throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(t,e){
(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function u(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function c(t,e){
for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function h(t,e,n){
return(h="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=p(t)););return t}(t,e);if(r){
var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function l(t,e){return(l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function f(t){
var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{
return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=p(t);if(e){var i=p(this).constructor
;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return d(this,n)}}function d(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){
if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function p(t){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(t){
return t.__proto__||Object.getPrototypeOf(t)})(t)}
var g=n(1),v=g.Config,y=g.BaseError,m=n(15).UriBuilder,S=n(3).LoggerFactory,b=n(0).AuthenticationService,x=n(0).Session,w=n(0),_=w.Identity,E=w.ClientIdentity,A=w.ApplicationIdentity,F=n(34),C=n(5),k=n(10),T=("urn:ietf:params:oauth:token-type:".concat("id_token"),
function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,
writable:!0,configurable:!0}}),e&&l(t,e)}(w,t);var e,n,r,i,a,d,g,x=f(w);function w(t,e,n){
var r,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null
;u(this,w);var c=null,h=null,l=null,f=null,d=null,p=null,g=null,y=i,m="".concat("uu_app_oidc_providers_").concat(t,"_");if(y){c=y.jti,h=y.auth_id||y.sid;var b=y.auth_time||y.iat;b&&(l=new Date(1e3*b))
;var F,C=y.acr;f=null==C?1:n.indexOf(C)>-1?n.indexOf(C):n.indexOf(C.toString())>-1?n.indexOf(C.toString()):n.indexOf(Number(C.toString()))>-1?n.indexOf(Number(C.toString())):Number(C.toString())
;var k=v.getString("".concat(m,"uu_identity_claim"));if(F=k?y[k]:y.uuidentity||y.uu_identity){var T=y.loa,P=y.name;"0-0"===F&&(f=0);var R=y.uuidentity_type||y.identity_type,I={name:P,
levelOfAssurance:T,type:R};d=new _(F,I)}var D=y.client_app_code,B=y.client_uuidentity;if(D||B){var N={};N.id=y.client_app_id,N.code=D,N.name=y.client_app_name;var O=y.client_uri;if(O){
if(N.clientUri=y.client_uri,N.clientUri&&N.clientUri.startsWith("urn:uuoidcclient:")){
var H=N.clientUri.replace("urn:uuoidcclient:","").split(/[:\/](.*)/),j=o(H,2),L=j[0],V=j[1],U=V.split(/[:\-]/),K=o(U,2),M=K[0],q=K[1];N.code||(N.code=L.toUpperCase().replace(/-/g,".")),
N.name||(N.name=L.replace(/(-\w)/g,(function(t){return t[1].toUpperCase()})));var z=L.split("-"),W=o(z,3),J=W[0],G=W[1],Y=W[2];N.product=L,N.vendor=J,N.app=G,N.subApp=Y,N.asid=M,N.awid=q}
}else if(N.code){var $=N.code.toLowerCase().split(/[\.\-_]/),X=o($,3),Z=X[0],Q=X[1],tt=X[2],et="".concat(Z,"-").concat(Q,"-").concat(tt);N.vendor=Z,N.app=Q,N.subApp=tt,N.product=et,
N.clientUri="".concat("urn:uuoidcclient:").concat(et)}p=new E(B,N),g=new A(B,N)}}return(r=x.call(this,{id:c,authenticationId:h,authenticationTime:l,authenticationLevelOfAssurance:f,identity:d,
clientIdentity:p,applicationIdentity:g,attributes:y}))._configPrefix=m,r._serviceName=t,r._oauthClient=e,r._supportedAcrValues=n,r._idToken=s,r._accessToken=a,r._logger=S.get("uuapp.oidc.Session"),
r._authenticated||r._authenticationLevelOfAssurance||(r._authenticated=r._identity&&r._identity.getUuIdentity()&&"0-0"!==r._identity.getUuIdentity()),r}return e=w,n=[{key:"getServiceName",
value:function(){return this._serviceName}},{key:"getServiceUri",value:(g=s(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:
if("function"!=typeof(e=b.get(this._serviceName)).getServiceUri){t.next=7;break}return t.next=4,e.getServiceUri();case 4:t.t0=t.sent,t.next=8;break;case 7:t.t0=null;case 8:
return t.abrupt("return",t.t0);case 9:case"end":return t.stop()}}),t,this)}))),function(){return g.apply(this,arguments)})},{key:"getProviderUri",value:function(){var t=b.get(this._serviceName)
;return"function"==typeof t.getProviderUri?t.getProviderUri():null}},{key:"getCallTokenScope",value:(d=s(regeneratorRuntime.mark((function t(e){var n,r,i,s,o,a=arguments
;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=a.length>1&&void 0!==a[1]?a[1]:{},
(r=n?n.scopeMode:null)||(i="".concat(this._configPrefix,"default_call_token_scope_mode"),r=v.getString(i)||"allUseCases"),"none"!==r){t.next=5;break}return t.abrupt("return",null);case 5:if(t.prev=5,
(o=m.parse(e)).clearParameters(),"useCase"!==r){t.next=12;break}s=o.toUri().toString(),t.next=18;break;case 12:if("allUseCases"!==r){t.next=17;break}o.setUseCase(null),s=o.toUri().toString(),t.next=18
;break;case 17:throw new y("Unsupported scope mode: ".concat(r));case 18:t.next=23;break;case 20:t.prev=20,t.t0=t.catch(5),s=e.toString().split("?")[0];case 23:return t.abrupt("return",s);case 24:
case"end":return t.stop()}}),t,this,[[5,20]])}))),function(t){return d.apply(this,arguments)})},{key:"getCallToken",value:(a=s(regeneratorRuntime.mark((function t(e){
var n,r,i,s,o,a,u,c,h,l,f,d=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=d.length>1&&void 0!==d[1]?d[1]:{},
"boolean"!=typeof(r=n?n.useTokenExchange:null)&&(i="".concat(this._configPrefix,"use_token_exchange"),r=!v.hasKey(i)||v.getBoolean(i)),
(s=n?n.callTokenType:null)||(o="".concat(this._configPrefix,"call_token_type"),s=v.getString(o)),a=!!n&&n.excludeAuthenticationType,u=null,r){t.next=11;break}
"idToken"===s?u=this._idToken:"accessToken"===s?u=this._accessToken:s||(u=this._idToken||this._accessToken),t.next=25;break;case 11:return t.next=13,C.getClientCredentials(this._serviceName);case 13:
return c=t.sent,
h=Array.isArray(e)?k.sha1("".concat(this.getIdentity().getUuIdentity(),":").concat(this.getAuthenticationId(),":").concat(c.client_id,":").concat(e.sort().join("|"))):k.sha1("".concat(this.getIdentity().getUuIdentity(),":").concat(this.getAuthenticationId(),":").concat(c.client_id,":").concat(e)),
t.next=17,this._oauthClient.getToken(h);case 17:if(l=t.sent){t.next=24;break}return t.next=21,this._oauthClient.exchangeToken(this._idToken||this._accessToken,c,e);case 21:l=t.sent,
f=l.expires_at||Number(new Date/1e3+l.expires_in),this._oauthClient.cacheToken(h,f,l);case 24:"idToken"===s?u=l.id_token:"accessToken"===s?u=l.access_token:s||(u=l.id_token||l.access_token);case 25:
if(u){t.next=27;break}throw new y('Call token of type "'.concat(tokenType||"idToken",'" is not available.'));case 27:if(!0!==a){t.next=31;break}return t.abrupt("return",u);case 31:
return t.abrupt("return","Bearer ".concat(u));case 32:case"end":return t.stop()}}),t,this)}))),function(t){return a.apply(this,arguments)})},{key:"close",
value:(i=s(regeneratorRuntime.mark((function t(){var e,n=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return h(p(w.prototype),"close",this).call(this),t.next=3,
C.getClientCredentials(this._serviceName);case 3:if(e=t.sent,!this._idToken&&!this._accessToken){t.next=13;break}return t.prev=5,t.next=8,
this._oauthClient.revokeToken(this._idToken||this._accessToken,e);case 8:t.next=13;break;case 10:t.prev=10,t.t0=t.catch(5),this._logger.error("Token revocation failed.",t.t0);case 13:
this._oauthClient.listTokens((function(t,e){if(e.id_token==n._idToken||e.access_token==n._accessToken)return n._oauthClient.deleteToken(t),!1})),this._idToken=null,this._accessToken=null;case 16:
case"end":return t.stop()}}),t,this,[[5,10]])}))),function(){return i.apply(this,arguments)})}],r=[{key:"_createEmptySession",value:function(){return new F}}],n&&c(e.prototype,n),r&&c(e,r),w}(x))
;t.exports=T},function(t,e,n){"use strict";function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),
Object.defineProperty(t,r.key,r)}}var i=n(14).KJUR,s=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,s;return e=t,
s=[{key:"sha1",value:function(t){var e=new i.crypto.MessageDigest({alg:"sha1"});return e.updateString(t),e.digest()}}],(n=null)&&r(e.prototype,n),s&&r(e,s),t}();t.exports=s},function(t,e,n){
"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){
return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e,n,r,i,s,o){try{var a=t[s](o),u=a.value}catch(t){return void n(t)}
a.done?e(u):Promise.resolve(u).then(r,i)}function s(t){return function(){var e=this,n=arguments;return new Promise((function(r,s){var o=t.apply(e,n);function a(t){i(o,r,s,a,u,"next",t)}function u(t){
i(o,r,s,a,u,"throw",t)}a(void 0)}))}}function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),
Object.defineProperty(t,r.key,r)}}function a(t,e,n){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){
for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=l(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function u(t,e){
return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1
;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){
var n,r=l(t);if(e){var i=l(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return h(this,n)}}function h(t,e){
return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function l(t){
return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=n(0).AuthenticationError,d=function(t){!function(t,e){
if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}
}),e&&u(t,e)}(p,t);var e,n,r,i,h,d=c(p);function p(t,e,n,r){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,p),
(i=d.call(this,t,e,n))._oauthClient=t,i._serviceName=e,i}return e=p,(n=[{key:"authenticate",value:function(t){
var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=a(l(p.prototype),"authenticate",this).call(this,t,"id_token token",n),i=r.then((function(t){
var n=t.authResponse,r=t.state,i=t.nonce,s=t.scope,o=t.acrValues,a=t.maxAge,u=t.clientId;return e._processAuthResponse(n,r,i,s,o,a,u)}));return i.uiComponent=r.uiComponent,i}},{
key:"getAuthResponseFromCallback",value:function(t){var e={};return t.replace(/^[^#]*#?/,"").split(/&/).forEach((function(t){
var n=t.indexOf("="),r=decodeURIComponent((-1==n?t.substr(0):t.substr(0,n)).replace(/\+/g," ")),i=decodeURIComponent((-1==n?"":t.substr(n+1)).replace(/\+/g," "));e[r]=i})),e}},{key:"getEndSessionUri",
value:function(){return this._oauthClient.getEndSessionUriSync()}},{key:"_processAuthResponse",value:(h=s(regeneratorRuntime.mark((function t(e,n,r,i,s,o,a){var u,c,h,l,f,d,p,g
;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return u=Date.now(),t.next=3,this._validateAuthResponse(e,n,r);case 3:return c=t.sent,h=e.id_token,l=e.access_token,
f=e.session_expires_in,d=e.session_state,p=f?u+1e3*f:null,(g=sessionStorage.getItem("uu_app_oidc_auth_ctx"))&&(g=JSON.parse(g),sessionStorage.removeItem("uu_app_oidc_auth_ctx")),t.abrupt("return",{
claims:c,idToken:h,accessToken:l,authenticationContext:g,globalSessionExpiresAt:p,globalSessionState:d,clientId:a,scope:i,acrValues:s,maxAge:o});case 9:case"end":return t.stop()}}),t,this)}))),
function(t,e,n,r,i,s,o){return h.apply(this,arguments)})},{key:"_validateAuthResponse",value:(i=s(regeneratorRuntime.mark((function t(e,n,r){var i;return regeneratorRuntime.wrap((function(t){
for(;;)switch(t.prev=t.next){case 0:if(!n||e.state===n){t.next=2;break}
throw new f("Invalid 'state' in received authorization response. Expected "+n+" but got "+e.state+". Response: "+JSON.stringify(e));case 2:if(!this._isAuthResponseExpired(e)){t.next=4;break}
throw new f("Token expired "+JSON.stringify(e));case 4:return t.next=6,this._oauthClient.parseToken(e.id_token);case 6:if(i=t.sent,!r||i.nonce===r){t.next=9;break}
throw new f("Invalid nonce in ID token claims. Expected "+r+" but got "+i.nonce);case 9:return t.abrupt("return",i);case 10:case"end":return t.stop()}}),t,this)}))),function(t,e,n){
return i.apply(this,arguments)})},{key:"_isAuthResponseExpired",value:function(t){var e=(new Date).getTime()/1e3,n=!1;return t.issued_at||(t.issued_at=e),t.expires_at&&(n=n||t.expires_at<e-60),
t.expires_in&&t.issued_at&&(n=n||Number(t.expires_in)+Number(t.issued_at)<e-60),n}}])&&o(e.prototype,n),r&&o(e,r),p}(n(16));t.exports=d},function(t,e,n){"use strict";function r(t,e){
return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,i=!1,s=void 0;try{
for(var o,a=t[Symbol.iterator]();!(r=(o=a.next()).done)&&(n.push(o.value),!e||n.length!==e);r=!0);}catch(t){i=!0,s=t}finally{try{r||null==a.return||a.return()}finally{if(i)throw s}}return n
}(t,e)||i(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}
function i(t,e){if(t){if("string"==typeof t)return s(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),
"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(t,e):void 0}}function s(t,e){(null==e||e>t.length)&&(e=t.length)
;for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var n=0;n<e.length;n++){
var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function u(t,e,n){return e&&a(t.prototype,e),n&&a(t,n),t}var c=function(){
function t(e,n,r){o(this,t),this.key=e,this.value=n,this.exp=r,this.next=null,this.prev=null}return u(t,[{key:"isExpired",value:function(){return this.exp>-1&&this.exp<=Date.now()}},{key:"toJSON",
value:function(){return[this.key,this.value,this.exp]}}]),t}(),h=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o(this,t),
"number"==typeof e.maxSize?this._maxSize=e.maxSize:this._maxSize=-1,"number"==typeof e.maxAge?this._maxAge=e.maxAge:this._maxAge=-1,this._size=0,this._items={},this._first=null,this._last=null}
return u(t,[{key:"set",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=null,i=(n="number"==typeof n?n:this._maxAge)>-1?n+Date.now():-1,s=new c(t,e,i)
;return this._items[t]?r=this.delete(t):this._maxSize>-1&&this._size>=this._maxSize&&this._prune(1),this._push(s),r}},{key:"get",value:function(t){var e=this._items[t],n=null
;return e&&(e.isExpired()?this._remove(e):(n=e.value,this._touch(e))),n}},{key:"delete",value:function(t){var e=null;if(this._items[t]){var n=this._items[t];n.isExpired()||(e=n.value),this._remove(n)}
return e}},{key:"clear",value:function(){this._size=0,this._items={},this._first=null,this._last=null}},{key:"getSize",value:function(){return this._size}},{key:"toJSON",value:function(){
for(var t=[],e=this._last;e;)t.push(e.toJSON()),e=e.prev;return[this._maxSize,this._maxAge,t]}},{key:"fromJSON",value:function(t){this.clear(),"string"==typeof t&&(t=JSON.parse(t))
;var e=r(t,3),n=e[0],s=e[1],o=e[2];this._maxSize=n,this._maxAge=s;var a,u=function(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){
if(Array.isArray(t)||(n=i(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,s=function(){};return{s:s,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:s}
}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){
n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw o}}}}(o);try{
for(u.s();!(a=u.n()).done;){var h=r(a.value,3),l=h[0],f=h[1],d=h[2];this._push(new c(l,f,d))}}catch(t){u.e(t)}finally{u.f()}}},{key:"forEach",value:function(t){
if("function"!=typeof t)throw new BaseError("Parameter must be function");for(var e=this._first,n=null;e&&("boolean"!=typeof(n=t(e.key,e.value))||n);)e=e.next}},{key:"_push",value:function(t){
t.next=this._first,t.prev=null,this._first&&(this._first.prev=t),this._first=t,this._last||(this._last=t),this._items[t.key]=t,this._size++}},{key:"_touch",value:function(t){
t.prev&&(t.prev.next=t.next,t.next?t.next.prev=t.prev:this._last=t.prev,t.next=this._first,t.prev=null,this._first&&(this._first.prev=t),this._first=t)}},{key:"_remove",value:function(t){
t.prev?t.prev.next=t.next:this._first=t.next,t.next?t.next.prev=t.prev:this._last=t.prev,delete this._items[t.key],this._size--}},{key:"_prune",value:function(){
for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=0,n=this._last;n;)n.isExpired()&&(this._remove(n),e++),n=n.prev;if(e<t)for(var r=this._last,i=0;i<t-e&&(this._remove(r),
r=r.prev);i++);}}]),t}();t.exports=h},function(t,e,n){"use strict";(function(t){var r=n(31),i=n(32),s=n(33);function o(){return u.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function a(t,e){
if(o()<e)throw new RangeError("Invalid typed array length");return u.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=u.prototype:(null===t&&(t=new u(e)),t.length=e),t}function u(t,e,n){
if(!(u.TYPED_ARRAY_SUPPORT||this instanceof u))return new u(t,e,n);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string")
;return l(this,t)}return c(this,t,e,n)}function c(t,e,n,r){if("number"==typeof e)throw new TypeError('"value" argument must not be a number')
;return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,n,r){if(e.byteLength,n<0||e.byteLength<n)throw new RangeError("'offset' is out of bounds")
;if(e.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");e=void 0===n&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,n):new Uint8Array(e,n,r)
;u.TYPED_ARRAY_SUPPORT?(t=e).__proto__=u.prototype:t=f(t,e);return t}(t,e,n,r):"string"==typeof e?function(t,e,n){"string"==typeof n&&""!==n||(n="utf8")
;if(!u.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|p(e,n),i=(t=a(t,r)).write(e,n);i!==r&&(t=t.slice(0,i));return t}(t,e,n):function(t,e){if(u.isBuffer(e)){
var n=0|d(e.length);return 0===(t=a(t,n)).length||e.copy(t,0,0,n),t}if(e){
if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||(r=e.length)!=r?a(t,0):f(t,e);if("Buffer"===e.type&&s(e.data))return f(t,e.data)}
var r;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}function h(t){
if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function l(t,e){if(h(e),t=a(t,e<0?0:0|d(e)),
!u.TYPED_ARRAY_SUPPORT)for(var n=0;n<e;++n)t[n]=0;return t}function f(t,e){var n=e.length<0?0:0|d(e.length);t=a(t,n);for(var r=0;r<n;r+=1)t[r]=255&e[r];return t}function d(t){
if(t>=o())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o().toString(16)+" bytes");return 0|t}function p(t,e){if(u.isBuffer(t))return t.length
;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var n=t.length
;if(0===n)return 0;for(var r=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return V(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":
return 2*n;case"hex":return n>>>1;case"base64":return U(t).length;default:if(r)return V(t).length;e=(""+e).toLowerCase(),r=!0}}function g(t,e,n){var r=!1;if((void 0===e||e<0)&&(e=0),
e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return T(this,e,n);case"utf8":case"utf-8":
return F(this,e,n);case"ascii":return C(this,e,n);case"latin1":case"binary":return k(this,e,n);case"base64":return A(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return P(this,e,n)
;default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}}function v(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function y(t,e,n,r,i){if(0===t.length)return-1
;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=i?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(i)return-1;n=t.length-1}else if(n<0){
if(!i)return-1;n=0}if("string"==typeof e&&(e=u.from(e,r)),u.isBuffer(e))return 0===e.length?-1:m(t,e,n,r,i);if("number"==typeof e)return e&=255,
u.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):m(t,[e],n,r,i)
;throw new TypeError("val must be string, number or Buffer")}function m(t,e,n,r,i){var s,o=1,a=t.length,u=e.length
;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||e.length<2)return-1;o=2,a/=2,u/=2,n/=2}function c(t,e){
return 1===o?t[e]:t.readUInt16BE(e*o)}if(i){var h=-1;for(s=n;s<a;s++)if(c(t,s)===c(e,-1===h?0:s-h)){if(-1===h&&(h=s),s-h+1===u)return h*o}else-1!==h&&(s-=s-h),h=-1}else for(n+u>a&&(n=a-u),
s=n;s>=0;s--){for(var l=!0,f=0;f<u;f++)if(c(t,s+f)!==c(e,f)){l=!1;break}if(l)return s}return-1}function S(t,e,n,r){n=Number(n)||0;var i=t.length-n;r?(r=Number(r))>i&&(r=i):r=i;var s=e.length
;if(s%2!=0)throw new TypeError("Invalid hex string");r>s/2&&(r=s/2);for(var o=0;o<r;++o){var a=parseInt(e.substr(2*o,2),16);if(isNaN(a))return o;t[n+o]=a}return o}function b(t,e,n,r){
return K(V(e,t.length-n),t,n,r)}function x(t,e,n,r){return K(function(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}(e),t,n,r)}function w(t,e,n,r){return x(t,e,n,r)}
function _(t,e,n,r){return K(U(e),t,n,r)}function E(t,e,n,r){return K(function(t,e){for(var n,r,i,s=[],o=0;o<t.length&&!((e-=2)<0);++o)n=t.charCodeAt(o),r=n>>8,i=n%256,s.push(i),s.push(r);return s
}(e,t.length-n),t,n,r)}function A(t,e,n){return 0===e&&n===t.length?r.fromByteArray(t):r.fromByteArray(t.slice(e,n))}function F(t,e,n){n=Math.min(t.length,n);for(var r=[],i=e;i<n;){
var s,o,a,u,c=t[i],h=null,l=c>239?4:c>223?3:c>191?2:1;if(i+l<=n)switch(l){case 1:c<128&&(h=c);break;case 2:128==(192&(s=t[i+1]))&&(u=(31&c)<<6|63&s)>127&&(h=u);break;case 3:s=t[i+1],o=t[i+2],
128==(192&s)&&128==(192&o)&&(u=(15&c)<<12|(63&s)<<6|63&o)>2047&&(u<55296||u>57343)&&(h=u);break;case 4:s=t[i+1],o=t[i+2],a=t[i+3],
128==(192&s)&&128==(192&o)&&128==(192&a)&&(u=(15&c)<<18|(63&s)<<12|(63&o)<<6|63&a)>65535&&u<1114112&&(h=u)}null===h?(h=65533,l=1):h>65535&&(h-=65536,r.push(h>>>10&1023|55296),h=56320|1023&h),
r.push(h),i+=l}return function(t){var e=t.length;if(e<=4096)return String.fromCharCode.apply(String,t);var n="",r=0;for(;r<e;)n+=String.fromCharCode.apply(String,t.slice(r,r+=4096));return n}(r)}
e.Buffer=u,e.SlowBuffer=function(t){+t!=t&&(t=0);return u.alloc(+t)},e.INSPECT_MAX_BYTES=50,u.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{
var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}(),
e.kMaxLength=o(),u.poolSize=8192,u._augment=function(t){return t.__proto__=u.prototype,t},u.from=function(t,e,n){return c(null,t,e,n)},
u.TYPED_ARRAY_SUPPORT&&(u.prototype.__proto__=Uint8Array.prototype,u.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&u[Symbol.species]===u&&Object.defineProperty(u,Symbol.species,{
value:null,configurable:!0})),u.alloc=function(t,e,n){return function(t,e,n,r){return h(e),e<=0?a(t,e):void 0!==n?"string"==typeof r?a(t,e).fill(n,r):a(t,e).fill(n):a(t,e)}(null,t,e,n)},
u.allocUnsafe=function(t){return l(null,t)},u.allocUnsafeSlow=function(t){return l(null,t)},u.isBuffer=function(t){return!(null==t||!t._isBuffer)},u.compare=function(t,e){
if(!u.isBuffer(t)||!u.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var n=t.length,r=e.length,i=0,s=Math.min(n,r);i<s;++i)if(t[i]!==e[i]){n=t[i],r=e[i];break}
return n<r?-1:r<n?1:0},u.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":
case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(t,e){if(!s(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return u.alloc(0);var n
;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;var r=u.allocUnsafe(e),i=0;for(n=0;n<t.length;++n){var o=t[n]
;if(!u.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(r,i),i+=o.length}return r},u.byteLength=p,u.prototype._isBuffer=!0,u.prototype.swap16=function(){
var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)v(this,e,e+1);return this},u.prototype.swap32=function(){var t=this.length
;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)v(this,e,e+3),v(this,e+1,e+2);return this},u.prototype.swap64=function(){var t=this.length
;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)v(this,e,e+7),v(this,e+1,e+6),v(this,e+2,e+5),v(this,e+3,e+4);return this},
u.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?F(this,0,t):g.apply(this,arguments)},u.prototype.equals=function(t){
if(!u.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===u.compare(this,t)},u.prototype.inspect=function(){var t="",n=e.INSPECT_MAX_BYTES
;return this.length>0&&(t=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(t+=" ... ")),"<Buffer "+t+">"},u.prototype.compare=function(t,e,n,r,i){
if(!u.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),
e<0||n>t.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&e>=n)return 0;if(r>=i)return-1;if(e>=n)return 1;if(this===t)return 0
;for(var s=(i>>>=0)-(r>>>=0),o=(n>>>=0)-(e>>>=0),a=Math.min(s,o),c=this.slice(r,i),h=t.slice(e,n),l=0;l<a;++l)if(c[l]!==h[l]){s=c[l],o=h[l];break}return s<o?-1:o<s?1:0},
u.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},u.prototype.indexOf=function(t,e,n){return y(this,t,e,n,!0)},u.prototype.lastIndexOf=function(t,e,n){return y(this,t,e,n,!1)},
u.prototype.write=function(t,e,n,r){if(void 0===e)r="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)r=e,n=this.length,e=0;else{
if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-e
;if((void 0===n||n>i)&&(n=i),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var s=!1;;)switch(r){case"hex":return S(this,t,e,n)
;case"utf8":case"utf-8":return b(this,t,e,n);case"ascii":return x(this,t,e,n);case"latin1":case"binary":return w(this,t,e,n);case"base64":return _(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":
case"utf-16le":return E(this,t,e,n);default:if(s)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),s=!0}},u.prototype.toJSON=function(){return{type:"Buffer",
data:Array.prototype.slice.call(this._arr||this,0)}};function C(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(127&t[i]);return r}function k(t,e,n){var r=""
;n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(t[i]);return r}function T(t,e,n){var r=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>r)&&(n=r);for(var i="",s=e;s<n;++s)i+=L(t[s]);return i}
function P(t,e,n){for(var r=t.slice(e,n),i="",s=0;s<r.length;s+=2)i+=String.fromCharCode(r[s]+256*r[s+1]);return i}function R(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint")
;if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function I(t,e,n,r,i,s){if(!u.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance')
;if(e>i||e<s)throw new RangeError('"value" argument is out of bounds');if(n+r>t.length)throw new RangeError("Index out of range")}function D(t,e,n,r){e<0&&(e=65535+e+1)
;for(var i=0,s=Math.min(t.length-n,2);i<s;++i)t[n+i]=(e&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function B(t,e,n,r){e<0&&(e=4294967295+e+1)
;for(var i=0,s=Math.min(t.length-n,4);i<s;++i)t[n+i]=e>>>8*(r?i:3-i)&255}function N(t,e,n,r,i,s){if(n+r>t.length)throw new RangeError("Index out of range")
;if(n<0)throw new RangeError("Index out of range")}function O(t,e,n,r,s){return s||N(t,0,n,4),i.write(t,e,n,r,23,4),n+4}function H(t,e,n,r,s){return s||N(t,0,n,8),i.write(t,e,n,r,52,8),n+8}
u.prototype.slice=function(t,e){var n,r=this.length;if((t=~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),(e=void 0===e?r:~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),e<t&&(e=t),
u.TYPED_ARRAY_SUPPORT)(n=this.subarray(t,e)).__proto__=u.prototype;else{var i=e-t;n=new u(i,void 0);for(var s=0;s<i;++s)n[s]=this[s+t]}return n},u.prototype.readUIntLE=function(t,e,n){t|=0,e|=0,
n||R(t,e,this.length);for(var r=this[t],i=1,s=0;++s<e&&(i*=256);)r+=this[t+s]*i;return r},u.prototype.readUIntBE=function(t,e,n){t|=0,e|=0,n||R(t,e,this.length)
;for(var r=this[t+--e],i=1;e>0&&(i*=256);)r+=this[t+--e]*i;return r},u.prototype.readUInt8=function(t,e){return e||R(t,1,this.length),this[t]},u.prototype.readUInt16LE=function(t,e){
return e||R(t,2,this.length),this[t]|this[t+1]<<8},u.prototype.readUInt16BE=function(t,e){return e||R(t,2,this.length),this[t]<<8|this[t+1]},u.prototype.readUInt32LE=function(t,e){
return e||R(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},u.prototype.readUInt32BE=function(t,e){return e||R(t,4,this.length),
16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},u.prototype.readIntLE=function(t,e,n){t|=0,e|=0,n||R(t,e,this.length);for(var r=this[t],i=1,s=0;++s<e&&(i*=256);)r+=this[t+s]*i
;return r>=(i*=128)&&(r-=Math.pow(2,8*e)),r},u.prototype.readIntBE=function(t,e,n){t|=0,e|=0,n||R(t,e,this.length);for(var r=e,i=1,s=this[t+--r];r>0&&(i*=256);)s+=this[t+--r]*i
;return s>=(i*=128)&&(s-=Math.pow(2,8*e)),s},u.prototype.readInt8=function(t,e){return e||R(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},u.prototype.readInt16LE=function(t,e){
e||R(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},u.prototype.readInt16BE=function(t,e){e||R(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},
u.prototype.readInt32LE=function(t,e){return e||R(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},u.prototype.readInt32BE=function(t,e){return e||R(t,4,this.length),
this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},u.prototype.readFloatLE=function(t,e){return e||R(t,4,this.length),i.read(this,t,!0,23,4)},u.prototype.readFloatBE=function(t,e){
return e||R(t,4,this.length),i.read(this,t,!1,23,4)},u.prototype.readDoubleLE=function(t,e){return e||R(t,8,this.length),i.read(this,t,!0,52,8)},u.prototype.readDoubleBE=function(t,e){
return e||R(t,8,this.length),i.read(this,t,!1,52,8)},u.prototype.writeUIntLE=function(t,e,n,r){(t=+t,e|=0,n|=0,r)||I(this,t,e,n,Math.pow(2,8*n)-1,0);var i=1,s=0
;for(this[e]=255&t;++s<n&&(i*=256);)this[e+s]=t/i&255;return e+n},u.prototype.writeUIntBE=function(t,e,n,r){(t=+t,e|=0,n|=0,r)||I(this,t,e,n,Math.pow(2,8*n)-1,0);var i=n-1,s=1
;for(this[e+i]=255&t;--i>=0&&(s*=256);)this[e+i]=t/s&255;return e+n},u.prototype.writeUInt8=function(t,e,n){return t=+t,e|=0,n||I(this,t,e,1,255,0),u.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),
this[e]=255&t,e+1},u.prototype.writeUInt16LE=function(t,e,n){return t=+t,e|=0,n||I(this,t,e,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):D(this,t,e,!0),e+2},
u.prototype.writeUInt16BE=function(t,e,n){return t=+t,e|=0,n||I(this,t,e,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):D(this,t,e,!1),e+2},u.prototype.writeUInt32LE=function(t,e,n){
return t=+t,e|=0,n||I(this,t,e,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):B(this,t,e,!0),e+4},u.prototype.writeUInt32BE=function(t,e,n){
return t=+t,e|=0,n||I(this,t,e,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):B(this,t,e,!1),e+4},u.prototype.writeIntLE=function(t,e,n,r){
if(t=+t,e|=0,!r){var i=Math.pow(2,8*n-1);I(this,t,e,n,i-1,-i)}var s=0,o=1,a=0;for(this[e]=255&t;++s<n&&(o*=256);)t<0&&0===a&&0!==this[e+s-1]&&(a=1),this[e+s]=(t/o>>0)-a&255;return e+n},
u.prototype.writeIntBE=function(t,e,n,r){if(t=+t,e|=0,!r){var i=Math.pow(2,8*n-1);I(this,t,e,n,i-1,-i)}var s=n-1,o=1,a=0;for(this[e+s]=255&t;--s>=0&&(o*=256);)t<0&&0===a&&0!==this[e+s+1]&&(a=1),
this[e+s]=(t/o>>0)-a&255;return e+n},u.prototype.writeInt8=function(t,e,n){return t=+t,e|=0,n||I(this,t,e,1,127,-128),u.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},
u.prototype.writeInt16LE=function(t,e,n){return t=+t,e|=0,n||I(this,t,e,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):D(this,t,e,!0),e+2},
u.prototype.writeInt16BE=function(t,e,n){return t=+t,e|=0,n||I(this,t,e,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):D(this,t,e,!1),e+2},
u.prototype.writeInt32LE=function(t,e,n){return t=+t,e|=0,n||I(this,t,e,4,2147483647,-2147483648),u.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,
this[e+3]=t>>>24):B(this,t,e,!0),e+4},u.prototype.writeInt32BE=function(t,e,n){return t=+t,e|=0,n||I(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,
this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):B(this,t,e,!1),e+4},u.prototype.writeFloatLE=function(t,e,n){return O(this,t,e,!0,n)},u.prototype.writeFloatBE=function(t,e,n){return O(this,t,e,!1,n)
},u.prototype.writeDoubleLE=function(t,e,n){return H(this,t,e,!0,n)},u.prototype.writeDoubleBE=function(t,e,n){return H(this,t,e,!1,n)},u.prototype.copy=function(t,e,n,r){if(n||(n=0),
r||0===r||(r=this.length),e>=t.length&&(e=t.length),e||(e=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds")
;if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n)
;var i,s=r-n
;if(this===t&&n<e&&e<r)for(i=s-1;i>=0;--i)t[i+e]=this[i+n];else if(s<1e3||!u.TYPED_ARRAY_SUPPORT)for(i=0;i<s;++i)t[i+e]=this[i+n];else Uint8Array.prototype.set.call(t,this.subarray(n,n+s),e);return s
},u.prototype.fill=function(t,e,n,r){if("string"==typeof t){if("string"==typeof e?(r=e,e=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===t.length){var i=t.charCodeAt(0);i<256&&(t=i)}
if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!u.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof t&&(t&=255)
;if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;var s;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),
"number"==typeof t)for(s=e;s<n;++s)this[s]=t;else{var o=u.isBuffer(t)?t:V(new u(t,r).toString()),a=o.length;for(s=0;s<n-e;++s)this[s+e]=o[s%a]}return this};var j=/[^+\/0-9A-Za-z-_]/g;function L(t){
return t<16?"0"+t.toString(16):t.toString(16)}function V(t,e){var n;e=e||1/0;for(var r=t.length,i=null,s=[],o=0;o<r;++o){if((n=t.charCodeAt(o))>55295&&n<57344){if(!i){if(n>56319){
(e-=3)>-1&&s.push(239,191,189);continue}if(o+1===r){(e-=3)>-1&&s.push(239,191,189);continue}i=n;continue}if(n<56320){(e-=3)>-1&&s.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)
}else i&&(e-=3)>-1&&s.push(239,191,189);if(i=null,n<128){if((e-=1)<0)break;s.push(n)}else if(n<2048){if((e-=2)<0)break;s.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break
;s.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;s.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return s}function U(t){
return r.toByteArray(function(t){if((t=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}(t).replace(j,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function K(t,e,n,r){
for(var i=0;i<r&&!(i+n>=e.length||i>=t.length);++i)e[i+n]=t[i];return i}}).call(this,n(30))},function(t,e,n){(function(t){function n(t){
return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){
return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var r={userAgent:!1},i={};if(void 0===s)var s={};s.lang={extend:function(t,e,n){
if(!e||!t)throw new Error("YAHOO.lang.extend failed, please check that all dependencies are included.");var i=function(){};if(i.prototype=e.prototype,t.prototype=new i,t.prototype.constructor=t,
t.superclass=e.prototype,e.prototype.constructor==Object.prototype.constructor&&(e.prototype.constructor=e),n){var s;for(s in n)t.prototype[s]=n[s];var o=function(){},a=["toString","valueOf"];try{
/MSIE/.test(r.userAgent)&&(o=function(t,e){for(s=0;s<a.length;s+=1){var n=a[s],r=e[n];"function"==typeof r&&r!=Object.prototype[n]&&(t[n]=r)}})}catch(t){}o(t.prototype,n)}}}
;var o,a,u,c,h,l,f,d,p,g,v,y=y||(o=Math,u=(a={}).lib={},c=u.Base=function(){function t(){}return{extend:function(e){t.prototype=this;var n=new t;return e&&n.mixIn(e),
n.hasOwnProperty("init")||(n.init=function(){n.$super.init.apply(this,arguments)}),n.init.prototype=n,n.$super=this,n},create:function(){var t=this.extend();return t.init.apply(t,arguments),t},
init:function(){},mixIn:function(t){for(var e in t)t.hasOwnProperty(e)&&(this[e]=t[e]);t.hasOwnProperty("toString")&&(this.toString=t.toString)},clone:function(){
return this.init.prototype.extend(this)}}}(),h=u.WordArray=c.extend({init:function(t,e){t=this.words=t||[],this.sigBytes=null!=e?e:4*t.length},toString:function(t){return(t||f).stringify(this)},
concat:function(t){var e=this.words,n=t.words,r=this.sigBytes,i=t.sigBytes;if(this.clamp(),r%4)for(var s=0;s<i;s++){var o=n[s>>>2]>>>24-s%4*8&255;e[r+s>>>2]|=o<<24-(r+s)%4*8
}else for(s=0;s<i;s+=4)e[r+s>>>2]=n[s>>>2];return this.sigBytes+=i,this},clamp:function(){var t=this.words,e=this.sigBytes;t[e>>>2]&=4294967295<<32-e%4*8,t.length=o.ceil(e/4)},clone:function(){
var t=c.clone.call(this);return t.words=this.words.slice(0),t},random:function(t){for(var e=[],n=0;n<t;n+=4)e.push(4294967296*o.random()|0);return new h.init(e,t)}}),l=a.enc={},f=l.Hex={
stringify:function(t){for(var e=t.words,n=t.sigBytes,r=[],i=0;i<n;i++){var s=e[i>>>2]>>>24-i%4*8&255;r.push((s>>>4).toString(16)),r.push((15&s).toString(16))}return r.join("")},parse:function(t){
for(var e=t.length,n=[],r=0;r<e;r+=2)n[r>>>3]|=parseInt(t.substr(r,2),16)<<24-r%8*4;return new h.init(n,e/2)}},d=l.Latin1={stringify:function(t){for(var e=t.words,n=t.sigBytes,r=[],i=0;i<n;i++){
var s=e[i>>>2]>>>24-i%4*8&255;r.push(String.fromCharCode(s))}return r.join("")},parse:function(t){for(var e=t.length,n=[],r=0;r<e;r++)n[r>>>2]|=(255&t.charCodeAt(r))<<24-r%4*8;return new h.init(n,e)}
},p=l.Utf8={stringify:function(t){try{return decodeURIComponent(escape(d.stringify(t)))}catch(t){throw new Error("Malformed UTF-8 data")}},parse:function(t){
return d.parse(unescape(encodeURIComponent(t)))}},g=u.BufferedBlockAlgorithm=c.extend({reset:function(){this._data=new h.init,this._nDataBytes=0},_append:function(t){
"string"==typeof t&&(t=p.parse(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes},_process:function(t){
var e=this._data,n=e.words,r=e.sigBytes,i=this.blockSize,s=r/(4*i),a=(s=t?o.ceil(s):o.max((0|s)-this._minBufferSize,0))*i,u=o.min(4*a,r);if(a){for(var c=0;c<a;c+=i)this._doProcessBlock(n,c)
;var l=n.splice(0,a);e.sigBytes-=u}return new h.init(l,u)},clone:function(){var t=c.clone.call(this);return t._data=this._data.clone(),t},_minBufferSize:0}),u.Hasher=g.extend({cfg:c.extend(),
init:function(t){this.cfg=this.cfg.extend(t),this.reset()},reset:function(){g.reset.call(this),this._doReset()},update:function(t){return this._append(t),this._process(),this},finalize:function(t){
return t&&this._append(t),this._doFinalize()},blockSize:16,_createHelper:function(t){return function(e,n){return new t.init(n).finalize(e)}},_createHmacHelper:function(t){return function(e,n){
return new v.HMAC.init(t,n).finalize(e)}}}),v=a.algo={},a);!function(t){var e,n=(e=y).lib,r=n.Base,i=n.WordArray;(e=e.x64={}).Word=r.extend({init:function(t,e){this.high=t,this.low=e}}),
e.WordArray=r.extend({init:function(t,e){t=this.words=t||[],this.sigBytes=null!=e?e:8*t.length},toX32:function(){for(var t=this.words,e=t.length,n=[],r=0;r<e;r++){var s=t[r];n.push(s.high),
n.push(s.low)}return i.create(n,this.sigBytes)},clone:function(){for(var t=r.clone.call(this),e=t.words=this.words.slice(0),n=e.length,i=0;i<n;i++)e[i]=e[i].clone();return t}})}(),
y.lib.Cipher||function(t){var e=(d=y).lib,n=e.Base,r=e.WordArray,i=e.BufferedBlockAlgorithm,s=d.enc.Base64,o=d.algo.EvpKDF,a=e.Cipher=i.extend({cfg:n.extend(),createEncryptor:function(t,e){
return this.create(this._ENC_XFORM_MODE,t,e)},createDecryptor:function(t,e){return this.create(this._DEC_XFORM_MODE,t,e)},init:function(t,e,n){this.cfg=this.cfg.extend(n),this._xformMode=t,
this._key=e,this.reset()},reset:function(){i.reset.call(this),this._doReset()},process:function(t){return this._append(t),this._process()},finalize:function(t){return t&&this._append(t),
this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(t){return{encrypt:function(e,n,r){return("string"==typeof n?p:f).encrypt(t,e,n,r)},
decrypt:function(e,n,r){return("string"==typeof n?p:f).decrypt(t,e,n,r)}}}});e.StreamCipher=a.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var u=d.mode={},c=function(t,e,n){
var r=this._iv;r?this._iv=void 0:r=this._prevBlock;for(var i=0;i<n;i++)t[e+i]^=r[i]},h=(e.BlockCipherMode=n.extend({createEncryptor:function(t,e){return this.Encryptor.create(t,e)},
createDecryptor:function(t,e){return this.Decryptor.create(t,e)},init:function(t,e){this._cipher=t,this._iv=e}})).extend();h.Encryptor=h.extend({processBlock:function(t,e){
var n=this._cipher,r=n.blockSize;c.call(this,t,e,r),n.encryptBlock(t,e),this._prevBlock=t.slice(e,e+r)}}),h.Decryptor=h.extend({processBlock:function(t,e){
var n=this._cipher,r=n.blockSize,i=t.slice(e,e+r);n.decryptBlock(t,e),c.call(this,t,e,r),this._prevBlock=i}}),u=u.CBC=h,h=(d.pad={}).Pkcs7={pad:function(t,e){
for(var n,i=(n=(n=4*e)-t.sigBytes%n)<<24|n<<16|n<<8|n,s=[],o=0;o<n;o+=4)s.push(i);n=r.create(s,n),t.concat(n)},unpad:function(t){t.sigBytes-=255&t.words[t.sigBytes-1>>>2]}},e.BlockCipher=a.extend({
cfg:a.cfg.extend({mode:u,padding:h}),reset:function(){a.reset.call(this);var t=(e=this.cfg).iv,e=e.mode;if(this._xformMode==this._ENC_XFORM_MODE)var n=e.createEncryptor;else n=e.createDecryptor,
this._minBufferSize=1;this._mode=n.call(e,this,t&&t.words)},_doProcessBlock:function(t,e){this._mode.processBlock(t,e)},_doFinalize:function(){var t=this.cfg.padding
;if(this._xformMode==this._ENC_XFORM_MODE){t.pad(this._data,this.blockSize);var e=this._process(!0)}else e=this._process(!0),t.unpad(e);return e},blockSize:4});var l=e.CipherParams=n.extend({
init:function(t){this.mixIn(t)},toString:function(t){return(t||this.formatter).stringify(this)}}),f=(u=(d.format={}).OpenSSL={stringify:function(t){var e=t.ciphertext
;return((t=t.salt)?r.create([1398893684,1701076831]).concat(t).concat(e):e).toString(s)},parse:function(t){var e=(t=s.parse(t)).words;if(1398893684==e[0]&&1701076831==e[1]){
var n=r.create(e.slice(2,4));e.splice(0,4),t.sigBytes-=16}return l.create({ciphertext:t,salt:n})}},e.SerializableCipher=n.extend({cfg:n.extend({format:u}),encrypt:function(t,e,n,r){
r=this.cfg.extend(r);var i=t.createEncryptor(n,r);return e=i.finalize(e),i=i.cfg,l.create({ciphertext:e,key:n,iv:i.iv,algorithm:t,mode:i.mode,padding:i.padding,blockSize:t.blockSize,formatter:r.format
})},decrypt:function(t,e,n,r){return r=this.cfg.extend(r),e=this._parse(e,r.format),t.createDecryptor(n,r).finalize(e.ciphertext)},_parse:function(t,e){return"string"==typeof t?e.parse(t,this):t}
})),d=(d.kdf={}).OpenSSL={execute:function(t,e,n,i){return i||(i=r.random(8)),t=o.create({keySize:e+n}).compute(t,i),n=r.create(t.words.slice(e),4*n),t.sigBytes=4*e,l.create({key:t,iv:n,salt:i})}
},p=e.PasswordBasedCipher=f.extend({cfg:f.cfg.extend({kdf:d}),encrypt:function(t,e,n,r){return n=(r=this.cfg.extend(r)).kdf.execute(n,t.keySize,t.ivSize),r.iv=n.iv,
(t=f.encrypt.call(this,t,e,n.key,r)).mixIn(n),t},decrypt:function(t,e,n,r){return r=this.cfg.extend(r),e=this._parse(e,r.format),n=r.kdf.execute(n,t.keySize,t.ivSize,e.salt),r.iv=n.iv,
f.decrypt.call(this,t,e,n.key,r)}})}(),function(){for(var t=y,e=t.lib.BlockCipher,n=t.algo,r=[],i=[],s=[],o=[],a=[],u=[],c=[],h=[],l=[],f=[],d=[],p=0;256>p;p++)d[p]=128>p?p<<1:p<<1^283;var g=0,v=0
;for(p=0;256>p;p++){var m=(m=v^v<<1^v<<2^v<<3^v<<4)>>>8^255&m^99;r[g]=m,i[m]=g;var S=d[g],b=d[S],x=d[b],w=257*d[m]^16843008*m;s[g]=w<<24|w>>>8,o[g]=w<<16|w>>>16,a[g]=w<<8|w>>>24,u[g]=w,
w=16843009*x^65537*b^257*S^16843008*g,c[m]=w<<24|w>>>8,h[m]=w<<16|w>>>16,l[m]=w<<8|w>>>24,f[m]=w,g?(g=S^d[d[d[x^S]]],v^=d[d[v]]):g=v=1}var _=[0,1,2,4,8,16,32,64,128,27,54];n=n.AES=e.extend({
_doReset:function(){for(var t=(n=this._key).words,e=n.sigBytes/4,n=4*((this._nRounds=e+6)+1),i=this._keySchedule=[],s=0;s<n;s++)if(s<e)i[s]=t[s];else{var o=i[s-1]
;s%e?6<e&&4==s%e&&(o=r[o>>>24]<<24|r[o>>>16&255]<<16|r[o>>>8&255]<<8|r[255&o]):(o=r[(o=o<<8|o>>>24)>>>24]<<24|r[o>>>16&255]<<16|r[o>>>8&255]<<8|r[255&o],o^=_[s/e|0]<<24),i[s]=i[s-e]^o}
for(t=this._invKeySchedule=[],e=0;e<n;e++)s=n-e,o=e%4?i[s]:i[s-4],t[e]=4>e||4>=s?o:c[r[o>>>24]]^h[r[o>>>16&255]]^l[r[o>>>8&255]]^f[r[255&o]]},encryptBlock:function(t,e){
this._doCryptBlock(t,e,this._keySchedule,s,o,a,u,r)},decryptBlock:function(t,e){var n=t[e+1];t[e+1]=t[e+3],t[e+3]=n,this._doCryptBlock(t,e,this._invKeySchedule,c,h,l,f,i),n=t[e+1],t[e+1]=t[e+3],
t[e+3]=n},_doCryptBlock:function(t,e,n,r,i,s,o,a){for(var u=this._nRounds,c=t[e]^n[0],h=t[e+1]^n[1],l=t[e+2]^n[2],f=t[e+3]^n[3],d=4,p=1;p<u;p++){
var g=r[c>>>24]^i[h>>>16&255]^s[l>>>8&255]^o[255&f]^n[d++],v=r[h>>>24]^i[l>>>16&255]^s[f>>>8&255]^o[255&c]^n[d++],y=r[l>>>24]^i[f>>>16&255]^s[c>>>8&255]^o[255&h]^n[d++]
;f=r[f>>>24]^i[c>>>16&255]^s[h>>>8&255]^o[255&l]^n[d++],c=g,h=v,l=y}g=(a[c>>>24]<<24|a[h>>>16&255]<<16|a[l>>>8&255]<<8|a[255&f])^n[d++],
v=(a[h>>>24]<<24|a[l>>>16&255]<<16|a[f>>>8&255]<<8|a[255&c])^n[d++],y=(a[l>>>24]<<24|a[f>>>16&255]<<16|a[c>>>8&255]<<8|a[255&h])^n[d++],
f=(a[f>>>24]<<24|a[c>>>16&255]<<16|a[h>>>8&255]<<8|a[255&l])^n[d++],t[e]=g,t[e+1]=v,t[e+2]=y,t[e+3]=f},keySize:8});t.AES=e._createHelper(n)}(),function(){function t(t,e){
var n=(this._lBlock>>>t^this._rBlock)&e;this._rBlock^=n,this._lBlock^=n<<t}function e(t,e){var n=(this._rBlock>>>t^this._lBlock)&e;this._lBlock^=n,this._rBlock^=n<<t}
var n=y,r=(i=n.lib).WordArray,i=i.BlockCipher,s=n.algo,o=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],a=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],u=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],c=[{
0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,
3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,
2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,
1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,
4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,
3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,
100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,
25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,
209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,
369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,
276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,
444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,
6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,
2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,
16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,
28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,
24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,
196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,
32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,
884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,
1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,
1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,
4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,
57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,
47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,
98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,
88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,
768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,
896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,
4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,
4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,
16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,
56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,
320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,
360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,
8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,
2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,
16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,
2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,
2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],h=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],l=s.DES=i.extend({_doReset:function(){
for(var t=this._key.words,e=[],n=0;56>n;n++){var r=o[n]-1;e[n]=t[r>>>5]>>>31-r%32&1}for(t=this._subKeys=[],r=0;16>r;r++){var i=t[r]=[],s=u[r];for(n=0;24>n;n++)i[n/6|0]|=e[(a[n]-1+s)%28]<<31-n%6,
i[4+(n/6|0)]|=e[28+(a[n+24]-1+s)%28]<<31-n%6;for(i[0]=i[0]<<1|i[0]>>>31,n=1;7>n;n++)i[n]>>>=4*(n-1)+3;i[7]=i[7]<<5|i[7]>>>27}for(e=this._invSubKeys=[],n=0;16>n;n++)e[n]=t[15-n]},
encryptBlock:function(t,e){this._doCryptBlock(t,e,this._subKeys)},decryptBlock:function(t,e){this._doCryptBlock(t,e,this._invSubKeys)},_doCryptBlock:function(n,r,i){this._lBlock=n[r],
this._rBlock=n[r+1],t.call(this,4,252645135),t.call(this,16,65535),e.call(this,2,858993459),e.call(this,8,16711935),t.call(this,1,1431655765);for(var s=0;16>s;s++){
for(var o=i[s],a=this._lBlock,u=this._rBlock,l=0,f=0;8>f;f++)l|=c[f][((u^o[f])&h[f])>>>0];this._lBlock=u,this._rBlock=a^l}i=this._lBlock,this._lBlock=this._rBlock,this._rBlock=i,
t.call(this,1,1431655765),e.call(this,8,16711935),e.call(this,2,858993459),t.call(this,16,65535),t.call(this,4,252645135),n[r]=this._lBlock,n[r+1]=this._rBlock},keySize:2,ivSize:2,blockSize:2})
;n.DES=i._createHelper(l),s=s.TripleDES=i.extend({_doReset:function(){var t=this._key.words;this._des1=l.createEncryptor(r.create(t.slice(0,2))),this._des2=l.createEncryptor(r.create(t.slice(2,4))),
this._des3=l.createEncryptor(r.create(t.slice(4,6)))},encryptBlock:function(t,e){this._des1.encryptBlock(t,e),this._des2.decryptBlock(t,e),this._des3.encryptBlock(t,e)},decryptBlock:function(t,e){
this._des3.decryptBlock(t,e),this._des2.encryptBlock(t,e),this._des1.decryptBlock(t,e)},keySize:6,ivSize:2,blockSize:2}),n.TripleDES=i._createHelper(s)}(),function(){var t=y,e=t.lib.WordArray
;t.enc.Base64={stringify:function(t){var e=t.words,n=t.sigBytes,r=this._map;t.clamp(),t=[]
;for(var i=0;i<n;i+=3)for(var s=(e[i>>>2]>>>24-i%4*8&255)<<16|(e[i+1>>>2]>>>24-(i+1)%4*8&255)<<8|e[i+2>>>2]>>>24-(i+2)%4*8&255,o=0;4>o&&i+.75*o<n;o++)t.push(r.charAt(s>>>6*(3-o)&63))
;if(e=r.charAt(64))for(;t.length%4;)t.push(e);return t.join("")},parse:function(t){var n=t.length,r=this._map;(i=r.charAt(64))&&(-1!=(i=t.indexOf(i))&&(n=i));for(var i=[],s=0,o=0;o<n;o++)if(o%4){
var a=r.indexOf(t.charAt(o-1))<<o%4*2,u=r.indexOf(t.charAt(o))>>>6-o%4*2;i[s>>>2]|=(a|u)<<24-s%4*8,s++}return e.create(i,s)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}
}(),function(t){function e(t,e,n,r,i,s,o){return((t=t+(e&n|~e&r)+i+o)<<s|t>>>32-s)+e}function n(t,e,n,r,i,s,o){return((t=t+(e&r|n&~r)+i+o)<<s|t>>>32-s)+e}function r(t,e,n,r,i,s,o){
return((t=t+(e^n^r)+i+o)<<s|t>>>32-s)+e}function i(t,e,n,r,i,s,o){return((t=t+(n^(e|~r))+i+o)<<s|t>>>32-s)+e}
for(var s=y,o=(u=s.lib).WordArray,a=u.Hasher,u=s.algo,c=[],h=0;64>h;h++)c[h]=4294967296*t.abs(t.sin(h+1))|0;u=u.MD5=a.extend({_doReset:function(){
this._hash=new o.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(t,s){for(var o=0;16>o;o++){var a=t[u=s+o];t[u]=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8)}
o=this._hash.words
;var u=t[s+0],h=(a=t[s+1],t[s+2]),l=t[s+3],f=t[s+4],d=t[s+5],p=t[s+6],g=t[s+7],v=t[s+8],y=t[s+9],m=t[s+10],S=t[s+11],b=t[s+12],x=t[s+13],w=t[s+14],_=t[s+15],E=e(E=o[0],C=o[1],F=o[2],A=o[3],u,7,c[0]),A=e(A,E,C,F,a,12,c[1]),F=e(F,A,E,C,h,17,c[2]),C=e(C,F,A,E,l,22,c[3])
;E=e(E,C,F,A,f,7,c[4]),A=e(A,E,C,F,d,12,c[5]),F=e(F,A,E,C,p,17,c[6]),C=e(C,F,A,E,g,22,c[7]),E=e(E,C,F,A,v,7,c[8]),A=e(A,E,C,F,y,12,c[9]),F=e(F,A,E,C,m,17,c[10]),C=e(C,F,A,E,S,22,c[11]),
E=e(E,C,F,A,b,7,c[12]),A=e(A,E,C,F,x,12,c[13]),F=e(F,A,E,C,w,17,c[14]),E=n(E,C=e(C,F,A,E,_,22,c[15]),F,A,a,5,c[16]),A=n(A,E,C,F,p,9,c[17]),F=n(F,A,E,C,S,14,c[18]),C=n(C,F,A,E,u,20,c[19]),
E=n(E,C,F,A,d,5,c[20]),A=n(A,E,C,F,m,9,c[21]),F=n(F,A,E,C,_,14,c[22]),C=n(C,F,A,E,f,20,c[23]),E=n(E,C,F,A,y,5,c[24]),A=n(A,E,C,F,w,9,c[25]),F=n(F,A,E,C,l,14,c[26]),C=n(C,F,A,E,v,20,c[27]),
E=n(E,C,F,A,x,5,c[28]),A=n(A,E,C,F,h,9,c[29]),F=n(F,A,E,C,g,14,c[30]),E=r(E,C=n(C,F,A,E,b,20,c[31]),F,A,d,4,c[32]),A=r(A,E,C,F,v,11,c[33]),F=r(F,A,E,C,S,16,c[34]),C=r(C,F,A,E,w,23,c[35]),
E=r(E,C,F,A,a,4,c[36]),A=r(A,E,C,F,f,11,c[37]),F=r(F,A,E,C,g,16,c[38]),C=r(C,F,A,E,m,23,c[39]),E=r(E,C,F,A,x,4,c[40]),A=r(A,E,C,F,u,11,c[41]),F=r(F,A,E,C,l,16,c[42]),C=r(C,F,A,E,p,23,c[43]),
E=r(E,C,F,A,y,4,c[44]),A=r(A,E,C,F,b,11,c[45]),F=r(F,A,E,C,_,16,c[46]),E=i(E,C=r(C,F,A,E,h,23,c[47]),F,A,u,6,c[48]),A=i(A,E,C,F,g,10,c[49]),F=i(F,A,E,C,w,15,c[50]),C=i(C,F,A,E,d,21,c[51]),
E=i(E,C,F,A,b,6,c[52]),A=i(A,E,C,F,l,10,c[53]),F=i(F,A,E,C,m,15,c[54]),C=i(C,F,A,E,a,21,c[55]),E=i(E,C,F,A,v,6,c[56]),A=i(A,E,C,F,_,10,c[57]),F=i(F,A,E,C,p,15,c[58]),C=i(C,F,A,E,x,21,c[59]),
E=i(E,C,F,A,f,6,c[60]),A=i(A,E,C,F,S,10,c[61]),F=i(F,A,E,C,h,15,c[62]),C=i(C,F,A,E,y,21,c[63]);o[0]=o[0]+E|0,o[1]=o[1]+C|0,o[2]=o[2]+F|0,o[3]=o[3]+A|0},_doFinalize:function(){
var e=this._data,n=e.words,r=8*this._nDataBytes,i=8*e.sigBytes;n[i>>>5]|=128<<24-i%32;var s=t.floor(r/4294967296);for(n[15+(i+64>>>9<<4)]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),
n[14+(i+64>>>9<<4)]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8),e.sigBytes=4*(n.length+1),this._process(),n=(e=this._hash).words,r=0;4>r;r++)i=n[r],
n[r]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8);return e},clone:function(){var t=a.clone.call(this);return t._hash=this._hash.clone(),t}}),s.MD5=a._createHelper(u),
s.HmacMD5=a._createHmacHelper(u)}(Math),function(){var t=y,e=(i=t.lib).WordArray,n=i.Hasher,r=[],i=t.algo.SHA1=n.extend({_doReset:function(){
this._hash=new e.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(t,e){for(var n=this._hash.words,i=n[0],s=n[1],o=n[2],a=n[3],u=n[4],c=0;80>c;c++){
if(16>c)r[c]=0|t[e+c];else{var h=r[c-3]^r[c-8]^r[c-14]^r[c-16];r[c]=h<<1|h>>>31}h=(i<<5|i>>>27)+u+r[c],
h=20>c?h+(1518500249+(s&o|~s&a)):40>c?h+(1859775393+(s^o^a)):60>c?h+((s&o|s&a|o&a)-1894007588):h+((s^o^a)-899497514),u=a,a=o,o=s<<30|s>>>2,s=i,i=h}n[0]=n[0]+i|0,n[1]=n[1]+s|0,n[2]=n[2]+o|0,
n[3]=n[3]+a|0,n[4]=n[4]+u|0},_doFinalize:function(){var t=this._data,e=t.words,n=8*this._nDataBytes,r=8*t.sigBytes;return e[r>>>5]|=128<<24-r%32,e[14+(r+64>>>9<<4)]=Math.floor(n/4294967296),
e[15+(r+64>>>9<<4)]=n,t.sigBytes=4*e.length,this._process(),this._hash},clone:function(){var t=n.clone.call(this);return t._hash=this._hash.clone(),t}});t.SHA1=n._createHelper(i),
t.HmacSHA1=n._createHmacHelper(i)}(),function(t){for(var e=y,n=(i=e.lib).WordArray,r=i.Hasher,i=e.algo,s=[],o=[],a=function(t){return 4294967296*(t-(0|t))|0},u=2,c=0;64>c;){var h;t:{h=u
;for(var l=t.sqrt(h),f=2;f<=l;f++)if(!(h%f)){h=!1;break t}h=!0}h&&(8>c&&(s[c]=a(t.pow(u,.5))),o[c]=a(t.pow(u,1/3)),c++),u++}var d=[];i=i.SHA256=r.extend({_doReset:function(){
this._hash=new n.init(s.slice(0))},_doProcessBlock:function(t,e){for(var n=this._hash.words,r=n[0],i=n[1],s=n[2],a=n[3],u=n[4],c=n[5],h=n[6],l=n[7],f=0;64>f;f++){if(16>f)d[f]=0|t[e+f];else{
var p=d[f-15],g=d[f-2];d[f]=((p<<25|p>>>7)^(p<<14|p>>>18)^p>>>3)+d[f-7]+((g<<15|g>>>17)^(g<<13|g>>>19)^g>>>10)+d[f-16]}p=l+((u<<26|u>>>6)^(u<<21|u>>>11)^(u<<7|u>>>25))+(u&c^~u&h)+o[f]+d[f],
g=((r<<30|r>>>2)^(r<<19|r>>>13)^(r<<10|r>>>22))+(r&i^r&s^i&s),l=h,h=c,c=u,u=a+p|0,a=s,s=i,i=r,r=p+g|0}n[0]=n[0]+r|0,n[1]=n[1]+i|0,n[2]=n[2]+s|0,n[3]=n[3]+a|0,n[4]=n[4]+u|0,n[5]=n[5]+c|0,n[6]=n[6]+h|0,
n[7]=n[7]+l|0},_doFinalize:function(){var e=this._data,n=e.words,r=8*this._nDataBytes,i=8*e.sigBytes;return n[i>>>5]|=128<<24-i%32,n[14+(i+64>>>9<<4)]=t.floor(r/4294967296),n[15+(i+64>>>9<<4)]=r,
e.sigBytes=4*n.length,this._process(),this._hash},clone:function(){var t=r.clone.call(this);return t._hash=this._hash.clone(),t}});e.SHA256=r._createHelper(i),e.HmacSHA256=r._createHmacHelper(i)
}(Math),function(){var t=y,e=t.lib.WordArray,n=(r=t.algo).SHA256,r=r.SHA224=n.extend({_doReset:function(){
this._hash=new e.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var t=n._doFinalize.call(this);return t.sigBytes-=4,t}})
;t.SHA224=n._createHelper(r),t.HmacSHA224=n._createHmacHelper(r)}(),function(){function t(){return r.create.apply(r,arguments)}
for(var e=y,n=e.lib.Hasher,r=(s=e.x64).Word,i=s.WordArray,s=e.algo,o=[t(1116352408,3609767458),t(1899447441,602891725),t(3049323471,3964484399),t(3921009573,2173295548),t(961987163,4081628472),t(1508970993,3053834265),t(2453635748,2937671579),t(2870763221,3664609560),t(3624381080,2734883394),t(310598401,1164996542),t(607225278,1323610764),t(1426881987,3590304994),t(1925078388,4068182383),t(2162078206,991336113),t(2614888103,633803317),t(3248222580,3479774868),t(3835390401,2666613458),t(4022224774,944711139),t(264347078,2341262773),t(604807628,2007800933),t(770255983,1495990901),t(1249150122,1856431235),t(1555081692,3175218132),t(1996064986,2198950837),t(2554220882,3999719339),t(2821834349,766784016),t(2952996808,2566594879),t(3210313671,3203337956),t(3336571891,1034457026),t(3584528711,2466948901),t(113926993,3758326383),t(338241895,168717936),t(666307205,1188179964),t(773529912,1546045734),t(1294757372,1522805485),t(1396182291,2643833823),t(1695183700,2343527390),t(1986661051,1014477480),t(2177026350,1206759142),t(2456956037,344077627),t(2730485921,1290863460),t(2820302411,3158454273),t(3259730800,3505952657),t(3345764771,106217008),t(3516065817,3606008344),t(3600352804,1432725776),t(4094571909,1467031594),t(275423344,851169720),t(430227734,3100823752),t(506948616,1363258195),t(659060556,3750685593),t(883997877,3785050280),t(958139571,3318307427),t(1322822218,3812723403),t(1537002063,2003034995),t(1747873779,3602036899),t(1955562222,1575990012),t(2024104815,1125592928),t(2227730452,2716904306),t(2361852424,442776044),t(2428436474,593698344),t(2756734187,3733110249),t(3204031479,2999351573),t(3329325298,3815920427),t(3391569614,3928383900),t(3515267271,566280711),t(3940187606,3454069534),t(4118630271,4000239992),t(116418474,1914138554),t(174292421,2731055270),t(289380356,3203993006),t(460393269,320620315),t(685471733,587496836),t(852142971,1086792851),t(1017036298,365543100),t(1126000580,2618297676),t(1288033470,3409855158),t(1501505948,4234509866),t(1607167915,987167468),t(1816402316,1246189591)],a=[],u=0;80>u;u++)a[u]=t()
;s=s.SHA512=n.extend({_doReset:function(){
this._hash=new i.init([new r.init(1779033703,4089235720),new r.init(3144134277,2227873595),new r.init(1013904242,4271175723),new r.init(2773480762,1595750129),new r.init(1359893119,2917565137),new r.init(2600822924,725511199),new r.init(528734635,4215389547),new r.init(1541459225,327033209)])
},_doProcessBlock:function(t,e){
for(var n=(l=this._hash.words)[0],r=l[1],i=l[2],s=l[3],u=l[4],c=l[5],h=l[6],l=l[7],f=n.high,d=n.low,p=r.high,g=r.low,v=i.high,y=i.low,m=s.high,S=s.low,b=u.high,x=u.low,w=c.high,_=c.low,E=h.high,A=h.low,F=l.high,C=l.low,k=f,T=d,P=p,R=g,I=v,D=y,B=m,N=S,O=b,H=x,j=w,L=_,V=E,U=A,K=F,M=C,q=0;80>q;q++){
var z=a[q];if(16>q)var W=z.high=0|t[e+2*q],J=z.low=0|t[e+2*q+1];else{W=((J=(W=a[q-15]).high)>>>1|(G=W.low)<<31)^(J>>>8|G<<24)^J>>>7
;var G=(G>>>1|J<<31)^(G>>>8|J<<24)^(G>>>7|J<<25),Y=((J=(Y=a[q-2]).high)>>>19|($=Y.low)<<13)^(J<<3|$>>>29)^J>>>6,$=($>>>19|J<<13)^($<<3|J>>>29)^($>>>6|J<<26),X=(J=a[q-7]).high,Z=(Q=a[q-16]).high,Q=Q.low
;W=(W=(W=W+X+((J=G+J.low)>>>0<G>>>0?1:0))+Y+((J=J+$)>>>0<$>>>0?1:0))+Z+((J=J+Q)>>>0<Q>>>0?1:0);z.high=W,z.low=J}X=O&j^~O&V,Q=H&L^~H&U,z=k&P^k&I^P&I
;var tt=T&R^T&D^R&D,et=(G=(k>>>28|T<<4)^(k<<30|T>>>2)^(k<<25|T>>>7),Y=(T>>>28|k<<4)^(T<<30|k>>>2)^(T<<25|k>>>7),($=o[q]).high),nt=$.low
;Z=K+((O>>>14|H<<18)^(O>>>18|H<<14)^(O<<23|H>>>9))+(($=M+((H>>>14|O<<18)^(H>>>18|O<<14)^(H<<23|O>>>9)))>>>0<M>>>0?1:0),K=V,M=U,V=j,U=L,j=O,L=H,
O=B+(Z=(Z=(Z=Z+X+(($=$+Q)>>>0<Q>>>0?1:0))+et+(($=$+nt)>>>0<nt>>>0?1:0))+W+(($=$+J)>>>0<J>>>0?1:0))+((H=N+$|0)>>>0<N>>>0?1:0)|0,B=I,N=D,I=P,D=R,P=k,R=T,
k=Z+(z=G+z+((J=Y+tt)>>>0<Y>>>0?1:0))+((T=$+J|0)>>>0<$>>>0?1:0)|0}d=n.low=d+T,n.high=f+k+(d>>>0<T>>>0?1:0),g=r.low=g+R,r.high=p+P+(g>>>0<R>>>0?1:0),y=i.low=y+D,i.high=v+I+(y>>>0<D>>>0?1:0),S=s.low=S+N,
s.high=m+B+(S>>>0<N>>>0?1:0),x=u.low=x+H,u.high=b+O+(x>>>0<H>>>0?1:0),_=c.low=_+L,c.high=w+j+(_>>>0<L>>>0?1:0),A=h.low=A+U,h.high=E+V+(A>>>0<U>>>0?1:0),C=l.low=C+M,l.high=F+K+(C>>>0<M>>>0?1:0)},
_doFinalize:function(){var t=this._data,e=t.words,n=8*this._nDataBytes,r=8*t.sigBytes;return e[r>>>5]|=128<<24-r%32,e[30+(r+128>>>10<<5)]=Math.floor(n/4294967296),e[31+(r+128>>>10<<5)]=n,
t.sigBytes=4*e.length,this._process(),this._hash.toX32()},clone:function(){var t=n.clone.call(this);return t._hash=this._hash.clone(),t},blockSize:32}),e.SHA512=n._createHelper(s),
e.HmacSHA512=n._createHmacHelper(s)}(),function(){var t=y,e=(i=t.x64).Word,n=i.WordArray,r=(i=t.algo).SHA512,i=i.SHA384=r.extend({_doReset:function(){
this._hash=new n.init([new e.init(3418070365,3238371032),new e.init(1654270250,914150663),new e.init(2438529370,812702999),new e.init(355462360,4144912697),new e.init(1731405415,4290775857),new e.init(2394180231,1750603025),new e.init(3675008525,1694076839),new e.init(1203062813,3204075428)])
},_doFinalize:function(){var t=r._doFinalize.call(this);return t.sigBytes-=16,t}});t.SHA384=r._createHelper(i),t.HmacSHA384=r._createHmacHelper(i)}(),function(){
var t=y,e=(r=t.lib).WordArray,n=r.Hasher,r=t.algo,i=e.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),s=e.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),o=e.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),a=e.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),u=e.create([0,1518500249,1859775393,2400959708,2840853838]),c=e.create([1352829926,1548603684,1836072691,2053994217,0])
;r=r.RIPEMD160=n.extend({_doReset:function(){this._hash=e.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(t,e){for(var n=0;16>n;n++){var r=t[b=e+n]
;t[b]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8)}var h,l,f,d,p,g,v,y,m,S,b=this._hash.words,x=(r=u.words,c.words),w=i.words,_=s.words,E=o.words,A=a.words;g=h=b[0],v=l=b[1],y=f=b[2],m=d=b[3],
S=p=b[4];var F;for(n=0;80>n;n+=1)F=h+t[e+w[n]]|0,F=16>n?F+((l^f^d)+r[0]):32>n?F+((l&f|~l&d)+r[1]):48>n?F+(((l|~f)^d)+r[2]):64>n?F+((l&d|f&~d)+r[3]):F+((l^(f|~d))+r[4]),
F=(F=(F|=0)<<E[n]|F>>>32-E[n])+p|0,h=p,p=d,d=f<<10|f>>>22,f=l,l=F,F=g+t[e+_[n]]|0,
F=16>n?F+((v^(y|~m))+x[0]):32>n?F+((v&m|y&~m)+x[1]):48>n?F+(((v|~y)^m)+x[2]):64>n?F+((v&y|~v&m)+x[3]):F+((v^y^m)+x[4]),F=(F=(F|=0)<<A[n]|F>>>32-A[n])+S|0,g=S,S=m,m=y<<10|y>>>22,y=v,v=F;F=b[1]+f+m|0,
b[1]=b[2]+d+S|0,b[2]=b[3]+p+g|0,b[3]=b[4]+h+v|0,b[4]=b[0]+l+y|0,b[0]=F},_doFinalize:function(){var t=this._data,e=t.words,n=8*this._nDataBytes,r=8*t.sigBytes;for(e[r>>>5]|=128<<24-r%32,
e[14+(r+64>>>9<<4)]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8),t.sigBytes=4*(e.length+1),this._process(),e=(t=this._hash).words,n=0;5>n;n++)r=e[n],
e[n]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8);return t},clone:function(){var t=n.clone.call(this);return t._hash=this._hash.clone(),t}});t.RIPEMD160=n._createHelper(r),
t.HmacRIPEMD160=n._createHmacHelper(r)}(Math),function(){var t=y,e=t.enc.Utf8;t.algo.HMAC=t.lib.Base.extend({init:function(t,n){t=this._hasher=new t.init,"string"==typeof n&&(n=e.parse(n))
;var r=t.blockSize,i=4*r;n.sigBytes>i&&(n=t.finalize(n)),n.clamp();for(var s=this._oKey=n.clone(),o=this._iKey=n.clone(),a=s.words,u=o.words,c=0;c<r;c++)a[c]^=1549556828,u[c]^=909522486
;s.sigBytes=o.sigBytes=i,this.reset()},reset:function(){var t=this._hasher;t.reset(),t.update(this._iKey)},update:function(t){return this._hasher.update(t),this},finalize:function(t){
var e=this._hasher;return t=e.finalize(t),e.reset(),e.finalize(this._oKey.clone().concat(t))}})}(),function(){var t,e=y,n=(t=e.lib).Base,r=t.WordArray,i=(t=e.algo).HMAC,s=t.PBKDF2=n.extend({
cfg:n.extend({keySize:4,hasher:t.SHA1,iterations:1}),init:function(t){this.cfg=this.cfg.extend(t)},compute:function(t,e){
var n=this.cfg,s=i.create(n.hasher,t),o=r.create(),a=r.create([1]),u=o.words,c=a.words,h=n.keySize;for(n=n.iterations;u.length<h;){var l=s.update(e).finalize(a);s.reset()
;for(var f=l.words,d=f.length,p=l,g=1;g<n;g++){p=s.finalize(p),s.reset();for(var v=p.words,y=0;y<d;y++)f[y]^=v[y]}o.concat(l),c[0]++}return o.sigBytes=4*h,o}});e.PBKDF2=function(t,e,n){
return s.create(n).compute(t,e)}}();var m,S="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function b(t){var e,n,r="";for(e=0;e+3<=t.length;e+=3)n=parseInt(t.substring(e,e+3),16),
r+=S.charAt(n>>6)+S.charAt(63&n);for(e+1==t.length?(n=parseInt(t.substring(e,e+1),16),r+=S.charAt(n<<2)):e+2==t.length&&(n=parseInt(t.substring(e,e+2),16),r+=S.charAt(n>>2)+S.charAt((3&n)<<4)),
"=";(3&r.length)>0;)r+="=";return r}function x(t){var e,n,r,i="",s=0;for(e=0;e<t.length&&"="!=t.charAt(e);++e)(r=S.indexOf(t.charAt(e)))<0||(0==s?(i+=k(r>>2),n=3&r,s=1):1==s?(i+=k(n<<2|r>>4),n=15&r,
s=2):2==s?(i+=k(n),i+=k(r>>2),n=3&r,s=3):(i+=k(n<<2|r>>4),i+=k(15&r),s=0));return 1==s&&(i+=k(n<<2)),i}function w(t){var e,n=x(t),r=new Array
;for(e=0;2*e<n.length;++e)r[e]=parseInt(n.substring(2*e,2*e+2),16);return r}function _(t,e,n){
null!=t&&("number"==typeof t?this.fromNumber(t,e,n):null==e&&"string"!=typeof t?this.fromString(t,256):this.fromString(t,e))}function E(){return new _(null)}
"Microsoft Internet Explorer"==r.appName?(_.prototype.am=function(t,e,n,r,i,s){for(var o=32767&e,a=e>>15;--s>=0;){var u=32767&this[t],c=this[t++]>>15,h=a*u+c*o
;i=((u=o*u+((32767&h)<<15)+n[r]+(1073741823&i))>>>30)+(h>>>15)+a*c+(i>>>30),n[r++]=1073741823&u}return i},m=30):"Netscape"!=r.appName?(_.prototype.am=function(t,e,n,r,i,s){for(;--s>=0;){
var o=e*this[t++]+n[r]+i;i=Math.floor(o/67108864),n[r++]=67108863&o}return i},m=26):(_.prototype.am=function(t,e,n,r,i,s){for(var o=16383&e,a=e>>14;--s>=0;){
var u=16383&this[t],c=this[t++]>>14,h=a*u+c*o;i=((u=o*u+((16383&h)<<14)+n[r]+i)>>28)+(h>>14)+a*c,n[r++]=268435455&u}return i},m=28),_.prototype.DB=m,_.prototype.DM=(1<<m)-1,_.prototype.DV=1<<m
;_.prototype.FV=Math.pow(2,52),_.prototype.F1=52-m,_.prototype.F2=2*m-52;var A,F,C=new Array;for(A="0".charCodeAt(0),F=0;F<=9;++F)C[A++]=F;for(A="a".charCodeAt(0),F=10;F<36;++F)C[A++]=F
;for(A="A".charCodeAt(0),F=10;F<36;++F)C[A++]=F;function k(t){return"0123456789abcdefghijklmnopqrstuvwxyz".charAt(t)}function T(t,e){var n=C[t.charCodeAt(e)];return null==n?-1:n}function P(t){
var e=E();return e.fromInt(t),e}function R(t){var e,n=1;return 0!=(e=t>>>16)&&(t=e,n+=16),0!=(e=t>>8)&&(t=e,n+=8),0!=(e=t>>4)&&(t=e,n+=4),0!=(e=t>>2)&&(t=e,n+=2),0!=(e=t>>1)&&(t=e,n+=1),n}
function I(t){this.m=t}function D(t){this.m=t,this.mp=t.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function B(t,e){return t&e}function N(t,e){
return t|e}function O(t,e){return t^e}function H(t,e){return t&~e}function j(t){if(0==t)return-1;var e=0;return 0==(65535&t)&&(t>>=16,e+=16),0==(255&t)&&(t>>=8,e+=8),0==(15&t)&&(t>>=4,e+=4),
0==(3&t)&&(t>>=2,e+=2),0==(1&t)&&++e,e}function L(t){for(var e=0;0!=t;)t&=t-1,++e;return e}function V(){}function U(t){return t}function K(t){this.r2=E(),this.q3=E(),_.ONE.dlShiftTo(2*t.t,this.r2),
this.mu=this.r2.divide(t),this.m=t}I.prototype.convert=function(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t},I.prototype.revert=function(t){return t},I.prototype.reduce=function(t){
t.divRemTo(this.m,null,t)},I.prototype.mulTo=function(t,e,n){t.multiplyTo(e,n),this.reduce(n)},I.prototype.sqrTo=function(t,e){t.squareTo(e),this.reduce(e)},D.prototype.convert=function(t){var e=E()
;return t.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),t.s<0&&e.compareTo(_.ZERO)>0&&this.m.subTo(e,e),e},D.prototype.revert=function(t){var e=E();return t.copyTo(e),this.reduce(e),e},
D.prototype.reduce=function(t){for(;t.t<=this.mt2;)t[t.t++]=0;for(var e=0;e<this.m.t;++e){var n=32767&t[e],r=n*this.mpl+((n*this.mph+(t[e]>>15)*this.mpl&this.um)<<15)&t.DM
;for(t[n=e+this.m.t]+=this.m.am(0,r,t,e,0,this.m.t);t[n]>=t.DV;)t[n]-=t.DV,t[++n]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)},D.prototype.mulTo=function(t,e,n){
t.multiplyTo(e,n),this.reduce(n)},D.prototype.sqrTo=function(t,e){t.squareTo(e),this.reduce(e)},_.prototype.copyTo=function(t){for(var e=this.t-1;e>=0;--e)t[e]=this[e];t.t=this.t,t.s=this.s},
_.prototype.fromInt=function(t){this.t=1,this.s=t<0?-1:0,t>0?this[0]=t:t<-1?this[0]=t+this.DV:this.t=0},_.prototype.fromString=function(t,e){var n
;if(16==e)n=4;else if(8==e)n=3;else if(256==e)n=8;else if(2==e)n=1;else if(32==e)n=5;else{if(4!=e)return void this.fromRadix(t,e);n=2}this.t=0,this.s=0;for(var r=t.length,i=!1,s=0;--r>=0;){
var o=8==n?255&t[r]:T(t,r);o<0?"-"==t.charAt(r)&&(i=!0):(i=!1,0==s?this[this.t++]=o:s+n>this.DB?(this[this.t-1]|=(o&(1<<this.DB-s)-1)<<s,this[this.t++]=o>>this.DB-s):this[this.t-1]|=o<<s,
(s+=n)>=this.DB&&(s-=this.DB))}8==n&&0!=(128&t[0])&&(this.s=-1,s>0&&(this[this.t-1]|=(1<<this.DB-s)-1<<s)),this.clamp(),i&&_.ZERO.subTo(this,this)},_.prototype.clamp=function(){
for(var t=this.s&this.DM;this.t>0&&this[this.t-1]==t;)--this.t},_.prototype.dlShiftTo=function(t,e){var n;for(n=this.t-1;n>=0;--n)e[n+t]=this[n];for(n=t-1;n>=0;--n)e[n]=0;e.t=this.t+t,e.s=this.s},
_.prototype.drShiftTo=function(t,e){for(var n=t;n<this.t;++n)e[n-t]=this[n];e.t=Math.max(this.t-t,0),e.s=this.s},_.prototype.lShiftTo=function(t,e){
var n,r=t%this.DB,i=this.DB-r,s=(1<<i)-1,o=Math.floor(t/this.DB),a=this.s<<r&this.DM;for(n=this.t-1;n>=0;--n)e[n+o+1]=this[n]>>i|a,a=(this[n]&s)<<r;for(n=o-1;n>=0;--n)e[n]=0;e[o]=a,e.t=this.t+o+1,
e.s=this.s,e.clamp()},_.prototype.rShiftTo=function(t,e){e.s=this.s;var n=Math.floor(t/this.DB);if(n>=this.t)e.t=0;else{var r=t%this.DB,i=this.DB-r,s=(1<<r)-1;e[0]=this[n]>>r
;for(var o=n+1;o<this.t;++o)e[o-n-1]|=(this[o]&s)<<i,e[o-n]=this[o]>>r;r>0&&(e[this.t-n-1]|=(this.s&s)<<i),e.t=this.t-n,e.clamp()}},_.prototype.subTo=function(t,e){
for(var n=0,r=0,i=Math.min(t.t,this.t);n<i;)r+=this[n]-t[n],e[n++]=r&this.DM,r>>=this.DB;if(t.t<this.t){for(r-=t.s;n<this.t;)r+=this[n],e[n++]=r&this.DM,r>>=this.DB;r+=this.s}else{
for(r+=this.s;n<t.t;)r-=t[n],e[n++]=r&this.DM,r>>=this.DB;r-=t.s}e.s=r<0?-1:0,r<-1?e[n++]=this.DV+r:r>0&&(e[n++]=r),e.t=n,e.clamp()},_.prototype.multiplyTo=function(t,e){
var n=this.abs(),r=t.abs(),i=n.t;for(e.t=i+r.t;--i>=0;)e[i]=0;for(i=0;i<r.t;++i)e[i+n.t]=n.am(0,r[i],e,i,0,n.t);e.s=0,e.clamp(),this.s!=t.s&&_.ZERO.subTo(e,e)},_.prototype.squareTo=function(t){
for(var e=this.abs(),n=t.t=2*e.t;--n>=0;)t[n]=0;for(n=0;n<e.t-1;++n){var r=e.am(n,e[n],t,2*n,0,1);(t[n+e.t]+=e.am(n+1,2*e[n],t,2*n+1,r,e.t-n-1))>=e.DV&&(t[n+e.t]-=e.DV,t[n+e.t+1]=1)}
t.t>0&&(t[t.t-1]+=e.am(n,e[n],t,2*n,0,1)),t.s=0,t.clamp()},_.prototype.divRemTo=function(t,e,n){var r=t.abs();if(!(r.t<=0)){var i=this.abs();if(i.t<r.t)return null!=e&&e.fromInt(0),
void(null!=n&&this.copyTo(n));null==n&&(n=E());var s=E(),o=this.s,a=t.s,u=this.DB-R(r[r.t-1]);u>0?(r.lShiftTo(u,s),i.lShiftTo(u,n)):(r.copyTo(s),i.copyTo(n));var c=s.t,h=s[c-1];if(0!=h){
var l=h*(1<<this.F1)+(c>1?s[c-2]>>this.F2:0),f=this.FV/l,d=(1<<this.F1)/l,p=1<<this.F2,g=n.t,v=g-c,y=null==e?E():e;for(s.dlShiftTo(v,y),n.compareTo(y)>=0&&(n[n.t++]=1,n.subTo(y,n)),
_.ONE.dlShiftTo(c,y),y.subTo(s,s);s.t<c;)s[s.t++]=0;for(;--v>=0;){var m=n[--g]==h?this.DM:Math.floor(n[g]*f+(n[g-1]+p)*d);if((n[g]+=s.am(0,m,n,v,0,c))<m)for(s.dlShiftTo(v,y),
n.subTo(y,n);n[g]<--m;)n.subTo(y,n)}null!=e&&(n.drShiftTo(c,e),o!=a&&_.ZERO.subTo(e,e)),n.t=c,n.clamp(),u>0&&n.rShiftTo(u,n),o<0&&_.ZERO.subTo(n,n)}}},_.prototype.invDigit=function(){
if(this.t<1)return 0;var t=this[0];if(0==(1&t))return 0;var e=3&t;return(e=(e=(e=(e=e*(2-(15&t)*e)&15)*(2-(255&t)*e)&255)*(2-((65535&t)*e&65535))&65535)*(2-t*e%this.DV)%this.DV)>0?this.DV-e:-e},
_.prototype.isEven=function(){return 0==(this.t>0?1&this[0]:this.s)},_.prototype.exp=function(t,e){if(t>4294967295||t<1)return _.ONE;var n=E(),r=E(),i=e.convert(this),s=R(t)-1
;for(i.copyTo(n);--s>=0;)if(e.sqrTo(n,r),(t&1<<s)>0)e.mulTo(r,i,n);else{var o=n;n=r,r=o}return e.revert(n)},_.prototype.toString=function(t){if(this.s<0)return"-"+this.negate().toString(t);var e
;if(16==t)e=4;else if(8==t)e=3;else if(2==t)e=1;else if(32==t)e=5;else{if(4!=t)return this.toRadix(t);e=2}var n,r=(1<<e)-1,i=!1,s="",o=this.t,a=this.DB-o*this.DB%e
;if(o-- >0)for(a<this.DB&&(n=this[o]>>a)>0&&(i=!0,s=k(n));o>=0;)a<e?(n=(this[o]&(1<<a)-1)<<e-a,n|=this[--o]>>(a+=this.DB-e)):(n=this[o]>>(a-=e)&r,a<=0&&(a+=this.DB,--o)),n>0&&(i=!0),i&&(s+=k(n))
;return i?s:"0"},_.prototype.negate=function(){var t=E();return _.ZERO.subTo(this,t),t},_.prototype.abs=function(){return this.s<0?this.negate():this},_.prototype.compareTo=function(t){
var e=this.s-t.s;if(0!=e)return e;var n=this.t;if(0!=(e=n-t.t))return this.s<0?-e:e;for(;--n>=0;)if(0!=(e=this[n]-t[n]))return e;return 0},_.prototype.bitLength=function(){
return this.t<=0?0:this.DB*(this.t-1)+R(this[this.t-1]^this.s&this.DM)},_.prototype.mod=function(t){var e=E();return this.abs().divRemTo(t,null,e),this.s<0&&e.compareTo(_.ZERO)>0&&t.subTo(e,e),e},
_.prototype.modPowInt=function(t,e){var n;return n=t<256||e.isEven()?new I(e):new D(e),this.exp(t,n)},_.ZERO=P(0),_.ONE=P(1),V.prototype.convert=U,V.prototype.revert=U,
V.prototype.mulTo=function(t,e,n){t.multiplyTo(e,n)},V.prototype.sqrTo=function(t,e){t.squareTo(e)},K.prototype.convert=function(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m)
;if(t.compareTo(this.m)<0)return t;var e=E();return t.copyTo(e),this.reduce(e),e},K.prototype.revert=function(t){return t},K.prototype.reduce=function(t){for(t.drShiftTo(this.m.t-1,this.r2),
t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1)
;for(t.subTo(this.r2,t);t.compareTo(this.m)>=0;)t.subTo(this.m,t)},K.prototype.mulTo=function(t,e,n){t.multiplyTo(e,n),this.reduce(n)},K.prototype.sqrTo=function(t,e){t.squareTo(e),this.reduce(e)}
;var M=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],q=(1<<26)/M[M.length-1]
;function z(){this.i=0,this.j=0,this.S=new Array}_.prototype.chunkSize=function(t){return Math.floor(Math.LN2*this.DB/Math.log(t))},_.prototype.toRadix=function(t){if(null==t&&(t=10),
0==this.signum()||t<2||t>36)return"0";var e=this.chunkSize(t),n=Math.pow(t,e),r=P(n),i=E(),s=E(),o="";for(this.divRemTo(r,i,s);i.signum()>0;)o=(n+s.intValue()).toString(t).substr(1)+o,
i.divRemTo(r,i,s);return s.intValue().toString(t)+o},_.prototype.fromRadix=function(t,e){this.fromInt(0),null==e&&(e=10);for(var n=this.chunkSize(e),r=Math.pow(e,n),i=!1,s=0,o=0,a=0;a<t.length;++a){
var u=T(t,a);u<0?"-"==t.charAt(a)&&0==this.signum()&&(i=!0):(o=e*o+u,++s>=n&&(this.dMultiply(r),this.dAddOffset(o,0),s=0,o=0))}s>0&&(this.dMultiply(Math.pow(e,s)),this.dAddOffset(o,0)),
i&&_.ZERO.subTo(this,this)},_.prototype.fromNumber=function(t,e,n){if("number"==typeof e)if(t<2)this.fromInt(1);else for(this.fromNumber(t,n),
this.testBit(t-1)||this.bitwiseTo(_.ONE.shiftLeft(t-1),N,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,0),
this.bitLength()>t&&this.subTo(_.ONE.shiftLeft(t-1),this);else{var r=new Array,i=7&t;r.length=1+(t>>3),e.nextBytes(r),i>0?r[0]&=(1<<i)-1:r[0]=0,this.fromString(r,256)}},
_.prototype.bitwiseTo=function(t,e,n){var r,i,s=Math.min(t.t,this.t);for(r=0;r<s;++r)n[r]=e(this[r],t[r]);if(t.t<this.t){for(i=t.s&this.DM,r=s;r<this.t;++r)n[r]=e(this[r],i);n.t=this.t}else{
for(i=this.s&this.DM,r=s;r<t.t;++r)n[r]=e(i,t[r]);n.t=t.t}n.s=e(this.s,t.s),n.clamp()},_.prototype.changeBit=function(t,e){var n=_.ONE.shiftLeft(t);return this.bitwiseTo(n,e,n),n},
_.prototype.addTo=function(t,e){for(var n=0,r=0,i=Math.min(t.t,this.t);n<i;)r+=this[n]+t[n],e[n++]=r&this.DM,r>>=this.DB;if(t.t<this.t){for(r+=t.s;n<this.t;)r+=this[n],e[n++]=r&this.DM,r>>=this.DB
;r+=this.s}else{for(r+=this.s;n<t.t;)r+=t[n],e[n++]=r&this.DM,r>>=this.DB;r+=t.s}e.s=r<0?-1:0,r>0?e[n++]=r:r<-1&&(e[n++]=this.DV+r),e.t=n,e.clamp()},_.prototype.dMultiply=function(t){
this[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()},_.prototype.dAddOffset=function(t,e){if(0!=t){for(;this.t<=e;)this[this.t++]=0;for(this[e]+=t;this[e]>=this.DV;)this[e]-=this.DV,
++e>=this.t&&(this[this.t++]=0),++this[e]}},_.prototype.multiplyLowerTo=function(t,e,n){var r,i=Math.min(this.t+t.t,e);for(n.s=0,n.t=i;i>0;)n[--i]=0
;for(r=n.t-this.t;i<r;++i)n[i+this.t]=this.am(0,t[i],n,i,0,this.t);for(r=Math.min(t.t,e);i<r;++i)this.am(0,t[i],n,i,0,e-i);n.clamp()},_.prototype.multiplyUpperTo=function(t,e,n){--e
;var r=n.t=this.t+t.t-e;for(n.s=0;--r>=0;)n[r]=0;for(r=Math.max(e-this.t,0);r<t.t;++r)n[this.t+r-e]=this.am(e-r,t[r],n,0,0,this.t+r-e);n.clamp(),n.drShiftTo(1,n)},_.prototype.modInt=function(t){
if(t<=0)return 0;var e=this.DV%t,n=this.s<0?t-1:0;if(this.t>0)if(0==e)n=this[0]%t;else for(var r=this.t-1;r>=0;--r)n=(e*n+this[r])%t;return n},_.prototype.millerRabin=function(t){
var e=this.subtract(_.ONE),n=e.getLowestSetBit();if(n<=0)return!1;var r=e.shiftRight(n);(t=t+1>>1)>M.length&&(t=M.length);for(var i=E(),s=0;s<t;++s){i.fromInt(M[Math.floor(Math.random()*M.length)])
;var o=i.modPow(r,this);if(0!=o.compareTo(_.ONE)&&0!=o.compareTo(e)){for(var a=1;a++<n&&0!=o.compareTo(e);)if(0==(o=o.modPowInt(2,this)).compareTo(_.ONE))return!1;if(0!=o.compareTo(e))return!1}}
return!0},_.prototype.clone=function(){var t=E();return this.copyTo(t),t},_.prototype.intValue=function(){if(this.s<0){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{
if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]},_.prototype.byteValue=function(){return 0==this.t?this.s:this[0]<<24>>24},
_.prototype.shortValue=function(){return 0==this.t?this.s:this[0]<<16>>16},_.prototype.signum=function(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1},_.prototype.toByteArray=function(){
var t=this.t,e=new Array;e[0]=this.s;var n,r=this.DB-t*this.DB%8,i=0;if(t-- >0)for(r<this.DB&&(n=this[t]>>r)!=(this.s&this.DM)>>r&&(e[i++]=n|this.s<<this.DB-r);t>=0;)r<8?(n=(this[t]&(1<<r)-1)<<8-r,
n|=this[--t]>>(r+=this.DB-8)):(n=this[t]>>(r-=8)&255,r<=0&&(r+=this.DB,--t)),0!=(128&n)&&(n|=-256),0==i&&(128&this.s)!=(128&n)&&++i,(i>0||n!=this.s)&&(e[i++]=n);return e},
_.prototype.equals=function(t){return 0==this.compareTo(t)},_.prototype.min=function(t){return this.compareTo(t)<0?this:t},_.prototype.max=function(t){return this.compareTo(t)>0?this:t},
_.prototype.and=function(t){var e=E();return this.bitwiseTo(t,B,e),e},_.prototype.or=function(t){var e=E();return this.bitwiseTo(t,N,e),e},_.prototype.xor=function(t){var e=E()
;return this.bitwiseTo(t,O,e),e},_.prototype.andNot=function(t){var e=E();return this.bitwiseTo(t,H,e),e},_.prototype.not=function(){for(var t=E(),e=0;e<this.t;++e)t[e]=this.DM&~this[e]
;return t.t=this.t,t.s=~this.s,t},_.prototype.shiftLeft=function(t){var e=E();return t<0?this.rShiftTo(-t,e):this.lShiftTo(t,e),e},_.prototype.shiftRight=function(t){var e=E()
;return t<0?this.lShiftTo(-t,e):this.rShiftTo(t,e),e},_.prototype.getLowestSetBit=function(){for(var t=0;t<this.t;++t)if(0!=this[t])return t*this.DB+j(this[t]);return this.s<0?this.t*this.DB:-1},
_.prototype.bitCount=function(){for(var t=0,e=this.s&this.DM,n=0;n<this.t;++n)t+=L(this[n]^e);return t},_.prototype.testBit=function(t){var e=Math.floor(t/this.DB)
;return e>=this.t?0!=this.s:0!=(this[e]&1<<t%this.DB)},_.prototype.setBit=function(t){return this.changeBit(t,N)},_.prototype.clearBit=function(t){return this.changeBit(t,H)},
_.prototype.flipBit=function(t){return this.changeBit(t,O)},_.prototype.add=function(t){var e=E();return this.addTo(t,e),e},_.prototype.subtract=function(t){var e=E();return this.subTo(t,e),e},
_.prototype.multiply=function(t){var e=E();return this.multiplyTo(t,e),e},_.prototype.divide=function(t){var e=E();return this.divRemTo(t,e,null),e},_.prototype.remainder=function(t){var e=E()
;return this.divRemTo(t,null,e),e},_.prototype.divideAndRemainder=function(t){var e=E(),n=E();return this.divRemTo(t,e,n),new Array(e,n)},_.prototype.modPow=function(t,e){
var n,r,i=t.bitLength(),s=P(1);if(i<=0)return s;n=i<18?1:i<48?3:i<144?4:i<768?5:6,r=i<8?new I(e):e.isEven()?new K(e):new D(e);var o=new Array,a=3,u=n-1,c=(1<<n)-1;if(o[1]=r.convert(this),n>1){
var h=E();for(r.sqrTo(o[1],h);a<=c;)o[a]=E(),r.mulTo(h,o[a-2],o[a]),a+=2}var l,f,d=t.t-1,p=!0,g=E();for(i=R(t[d])-1;d>=0;){for(i>=u?l=t[d]>>i-u&c:(l=(t[d]&(1<<i+1)-1)<<u-i,
d>0&&(l|=t[d-1]>>this.DB+i-u)),a=n;0==(1&l);)l>>=1,--a;if((i-=a)<0&&(i+=this.DB,--d),p)o[l].copyTo(s),p=!1;else{for(;a>1;)r.sqrTo(s,g),r.sqrTo(g,s),a-=2;a>0?r.sqrTo(s,g):(f=s,s=g,g=f),
r.mulTo(g,o[l],s)}for(;d>=0&&0==(t[d]&1<<i);)r.sqrTo(s,g),f=s,s=g,g=f,--i<0&&(i=this.DB-1,--d)}return r.revert(s)},_.prototype.modInverse=function(t){var e=t.isEven()
;if(this.isEven()&&e||0==t.signum())return _.ZERO;for(var n=t.clone(),r=this.clone(),i=P(1),s=P(0),o=P(0),a=P(1);0!=n.signum();){for(;n.isEven();)n.rShiftTo(1,n),
e?(i.isEven()&&s.isEven()||(i.addTo(this,i),s.subTo(t,s)),i.rShiftTo(1,i)):s.isEven()||s.subTo(t,s),s.rShiftTo(1,s);for(;r.isEven();)r.rShiftTo(1,r),e?(o.isEven()&&a.isEven()||(o.addTo(this,o),
a.subTo(t,a)),o.rShiftTo(1,o)):a.isEven()||a.subTo(t,a),a.rShiftTo(1,a);n.compareTo(r)>=0?(n.subTo(r,n),e&&i.subTo(o,i),s.subTo(a,s)):(r.subTo(n,r),e&&o.subTo(i,o),a.subTo(s,a))}
return 0!=r.compareTo(_.ONE)?_.ZERO:a.compareTo(t)>=0?a.subtract(t):a.signum()<0?(a.addTo(t,a),a.signum()<0?a.add(t):a):a},_.prototype.pow=function(t){return this.exp(t,new V)},
_.prototype.gcd=function(t){var e=this.s<0?this.negate():this.clone(),n=t.s<0?t.negate():t.clone();if(e.compareTo(n)<0){var r=e;e=n,n=r}var i=e.getLowestSetBit(),s=n.getLowestSetBit();if(s<0)return e
;for(i<s&&(s=i),s>0&&(e.rShiftTo(s,e),n.rShiftTo(s,n));e.signum()>0;)(i=e.getLowestSetBit())>0&&e.rShiftTo(i,e),(i=n.getLowestSetBit())>0&&n.rShiftTo(i,n),e.compareTo(n)>=0?(e.subTo(n,e),
e.rShiftTo(1,e)):(n.subTo(e,n),n.rShiftTo(1,n));return s>0&&n.lShiftTo(s,n),n},_.prototype.isProbablePrime=function(t){var e,n=this.abs();if(1==n.t&&n[0]<=M[M.length-1]){
for(e=0;e<M.length;++e)if(n[0]==M[e])return!0;return!1}if(n.isEven())return!1;for(e=1;e<M.length;){for(var r=M[e],i=e+1;i<M.length&&r<q;)r*=M[i++];for(r=n.modInt(r);e<i;)if(r%M[e++]==0)return!1}
return n.millerRabin(t)},_.prototype.square=function(){var t=E();return this.squareTo(t),t},z.prototype.init=function(t){var e,n,r;for(e=0;e<256;++e)this.S[e]=e;for(n=0,
e=0;e<256;++e)n=n+this.S[e]+t[e%t.length]&255,r=this.S[e],this.S[e]=this.S[n],this.S[n]=r;this.i=0,this.j=0},z.prototype.next=function(){var t;return this.i=this.i+1&255,
this.j=this.j+this.S[this.i]&255,t=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=t,this.S[t+this.S[this.i]&255]};var W,J,G;function Y(){!function(t){J[G++]^=255&t,J[G++]^=t>>8&255,
J[G++]^=t>>16&255,J[G++]^=t>>24&255,G>=256&&(G-=256)}((new Date).getTime())}if(null==J){var $;if(J=new Array,G=0,void 0!==i&&(void 0!==i.crypto||void 0!==i.msCrypto)){var X=i.crypto||i.msCrypto
;if(X.getRandomValues){var Z=new Uint8Array(32);for(X.getRandomValues(Z),$=0;$<32;++$)J[G++]=Z[$]}else if("Netscape"==r.appName&&r.appVersion<"5"){var Q=i.crypto.random(32)
;for($=0;$<Q.length;++$)J[G++]=255&Q.charCodeAt($)}}for(;G<256;)$=Math.floor(65536*Math.random()),J[G++]=$>>>8,J[G++]=255&$;G=0,Y()}function tt(){if(null==W){for(Y(),(W=new z).init(J),
G=0;G<J.length;++G)J[G]=0;G=0}return W.next()}function et(){}function nt(t,e){return new _(t,e)}function rt(t,e,n){
for(var r="",i=0;r.length<e;)r+=n(String.fromCharCode.apply(String,t.concat([(4278190080&i)>>24,(16711680&i)>>16,(65280&i)>>8,255&i]))),i+=1;return r}function it(){this.n=null,this.e=0,this.d=null,
this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null}function st(t,e,n){
for(var r="",i=0;r.length<e;)r+=n(t+String.fromCharCode.apply(String,[(4278190080&i)>>24,(16711680&i)>>16,(65280&i)>>8,255&i])),i+=1;return r}function ot(t,e){this.x=e,this.q=t}function at(t,e,n,r){
this.curve=t,this.x=e,this.y=n,this.z=null==r?_.ONE:r,this.zinv=null}function ut(t,e,n){this.q=t,this.a=this.fromBigInteger(e),this.b=this.fromBigInteger(n),this.infinity=new at(this,null,null)}
et.prototype.nextBytes=function(t){var e;for(e=0;e<t.length;++e)t[e]=tt()},it.prototype.doPublic=function(t){return t.modPowInt(this.e,this.n)},it.prototype.setPublic=function(t,e){
if(this.isPublic=!0,this.isPrivate=!1,"string"!=typeof t)this.n=t,this.e=e;else{if(!(null!=t&&null!=e&&t.length>0&&e.length>0))throw"Invalid RSA public key";this.n=nt(t,16),this.e=parseInt(e,16)}},
it.prototype.encrypt=function(t){var e=function(t,e){if(e<t.length+11)throw"Message too long for RSA";for(var n=new Array,r=t.length-1;r>=0&&e>0;){var i=t.charCodeAt(r--)
;i<128?n[--e]=i:i>127&&i<2048?(n[--e]=63&i|128,n[--e]=i>>6|192):(n[--e]=63&i|128,n[--e]=i>>6&63|128,n[--e]=i>>12|224)}n[--e]=0;for(var s=new et,o=new Array;e>2;){for(o[0]=0;0==o[0];)s.nextBytes(o)
;n[--e]=o[0]}return n[--e]=2,n[--e]=0,new _(n)}(t,this.n.bitLength()+7>>3);if(null==e)return null;var n=this.doPublic(e);if(null==n)return null;var r=n.toString(16);return 0==(1&r.length)?r:"0"+r},
it.prototype.encryptOAEP=function(t,e,n){var r=function(t,e,n,r){var i=ht.crypto.MessageDigest,s=ht.crypto.Util,o=null;if(n||(n="sha1"),"string"==typeof n&&(o=i.getCanonicalAlgName(n),
r=i.getHashLength(o),n=function(t){return Et(s.hashHex(At(t),o))}),t.length+2*r+2>e)throw"Message too long for RSA";var a,u="";for(a=0;a<e-t.length-2*r-2;a+=1)u+="\0"
;var c=n("")+u+""+t,h=new Array(r);(new et).nextBytes(h);var l=rt(h,c.length,n),f=[];for(a=0;a<c.length;a+=1)f[a]=c.charCodeAt(a)^l.charCodeAt(a);var d=rt(f,h.length,n),p=[0]
;for(a=0;a<h.length;a+=1)p[a+1]=h[a]^d.charCodeAt(a);return new _(p.concat(f))}(t,this.n.bitLength()+7>>3,e,n);if(null==r)return null;var i=this.doPublic(r);if(null==i)return null;var s=i.toString(16)
;return 0==(1&s.length)?s:"0"+s},it.prototype.type="RSA",it.prototype.doPrivate=function(t){if(null==this.p||null==this.q)return t.modPow(this.d,this.n)
;for(var e=t.mod(this.p).modPow(this.dmp1,this.p),n=t.mod(this.q).modPow(this.dmq1,this.q);e.compareTo(n)<0;)e=e.add(this.p)
;return e.subtract(n).multiply(this.coeff).mod(this.p).multiply(this.q).add(n)},it.prototype.setPrivate=function(t,e,n){if(this.isPrivate=!0,"string"!=typeof t)this.n=t,this.e=e,this.d=n;else{
if(!(null!=t&&null!=e&&t.length>0&&e.length>0))throw"Invalid RSA private key";this.n=nt(t,16),this.e=parseInt(e,16),this.d=nt(n,16)}},it.prototype.setPrivateEx=function(t,e,n,r,i,s,o,a){
if(this.isPrivate=!0,this.isPublic=!1,null==t)throw"RSASetPrivateEx N == null";if(null==e)throw"RSASetPrivateEx E == null";if(0==t.length)throw"RSASetPrivateEx N.length == 0"
;if(0==e.length)throw"RSASetPrivateEx E.length == 0";if(!(null!=t&&null!=e&&t.length>0&&e.length>0))throw"Invalid RSA private key in RSASetPrivateEx";this.n=nt(t,16),this.e=parseInt(e,16),
this.d=nt(n,16),this.p=nt(r,16),this.q=nt(i,16),this.dmp1=nt(s,16),this.dmq1=nt(o,16),this.coeff=nt(a,16)},it.prototype.generate=function(t,e){var n=new et,r=t>>1;this.e=parseInt(e,16)
;for(var i=new _(e,16);;){for(;this.p=new _(t-r,1,n),0!=this.p.subtract(_.ONE).gcd(i).compareTo(_.ONE)||!this.p.isProbablePrime(10););for(;this.q=new _(r,1,n),
0!=this.q.subtract(_.ONE).gcd(i).compareTo(_.ONE)||!this.q.isProbablePrime(10););if(this.p.compareTo(this.q)<=0){var s=this.p;this.p=this.q,this.q=s}
var o=this.p.subtract(_.ONE),a=this.q.subtract(_.ONE),u=o.multiply(a);if(0==u.gcd(i).compareTo(_.ONE)&&(this.n=this.p.multiply(this.q),this.n.bitLength()==t)){this.d=i.modInverse(u),
this.dmp1=this.d.mod(o),this.dmq1=this.d.mod(a),this.coeff=this.q.modInverse(this.p);break}}this.isPrivate=!0},it.prototype.decrypt=function(t){
if(t.length!=Math.ceil(this.n.bitLength()/4))throw new Error("wrong ctext length");var e=nt(t,16),n=this.doPrivate(e);return null==n?null:function(t,e){
for(var n=t.toByteArray(),r=0;r<n.length&&0==n[r];)++r;if(n.length-r!=e-1||2!=n[r])return null;for(++r;0!=n[r];)if(++r>=n.length)return null;for(var i="";++r<n.length;){var s=255&n[r]
;s<128?i+=String.fromCharCode(s):s>191&&s<224?(i+=String.fromCharCode((31&s)<<6|63&n[r+1]),++r):(i+=String.fromCharCode((15&s)<<12|(63&n[r+1])<<6|63&n[r+2]),r+=2)}return i}(n,this.n.bitLength()+7>>3)
},it.prototype.decryptOAEP=function(t,e,n){if(t.length!=Math.ceil(this.n.bitLength()/4))throw new Error("wrong ctext length");var r=nt(t,16),i=this.doPrivate(r);return null==i?null:function(t,e,n,r){
var i=ht.crypto.MessageDigest,s=ht.crypto.Util,o=null;for(n||(n="sha1"),"string"==typeof n&&(o=i.getCanonicalAlgName(n),r=i.getHashLength(o),n=function(t){return Et(s.hashHex(At(t),o))}),
t=t.toByteArray(),a=0;a<t.length;a+=1)t[a]&=255;for(;t.length<e;)t.unshift(0);if((t=String.fromCharCode.apply(String,t)).length<2*r+2)throw"Cipher too short"
;var a,u=t.substr(1,r),c=t.substr(r+1),h=st(c,r,n),l=[];for(a=0;a<u.length;a+=1)l[a]=u.charCodeAt(a)^h.charCodeAt(a);var f=st(String.fromCharCode.apply(String,l),t.length-r,n),d=[]
;for(a=0;a<c.length;a+=1)d[a]=c.charCodeAt(a)^f.charCodeAt(a);if((d=String.fromCharCode.apply(String,d)).substr(0,r)!==n(""))throw"Hash mismatch";var p=(d=d.substr(r)).indexOf("")
;if((-1!=p?d.substr(0,p).lastIndexOf("\0"):-1)+1!=p)throw"Malformed data";return d.substr(p+1)}(i,this.n.bitLength()+7>>3,e,n)},ot.prototype.equals=function(t){
return t==this||this.q.equals(t.q)&&this.x.equals(t.x)},ot.prototype.toBigInteger=function(){return this.x},ot.prototype.negate=function(){return new ot(this.q,this.x.negate().mod(this.q))},
ot.prototype.add=function(t){return new ot(this.q,this.x.add(t.toBigInteger()).mod(this.q))},ot.prototype.subtract=function(t){return new ot(this.q,this.x.subtract(t.toBigInteger()).mod(this.q))},
ot.prototype.multiply=function(t){return new ot(this.q,this.x.multiply(t.toBigInteger()).mod(this.q))},ot.prototype.square=function(){return new ot(this.q,this.x.square().mod(this.q))},
ot.prototype.divide=function(t){return new ot(this.q,this.x.multiply(t.toBigInteger().modInverse(this.q)).mod(this.q))},at.prototype.getX=function(){
return null==this.zinv&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.x.toBigInteger().multiply(this.zinv).mod(this.curve.q))},at.prototype.getY=function(){
return null==this.zinv&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.y.toBigInteger().multiply(this.zinv).mod(this.curve.q))},at.prototype.equals=function(t){
return t==this||(this.isInfinity()?t.isInfinity():t.isInfinity()?this.isInfinity():!!t.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(t.z)).mod(this.curve.q).equals(_.ZERO)&&t.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(t.z)).mod(this.curve.q).equals(_.ZERO))
},at.prototype.isInfinity=function(){return null==this.x&&null==this.y||this.z.equals(_.ZERO)&&!this.y.toBigInteger().equals(_.ZERO)},at.prototype.negate=function(){
return new at(this.curve,this.x,this.y.negate(),this.z)},at.prototype.add=function(t){if(this.isInfinity())return t;if(t.isInfinity())return this
;var e=t.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(t.z)).mod(this.curve.q),n=t.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(t.z)).mod(this.curve.q)
;if(_.ZERO.equals(n))return _.ZERO.equals(e)?this.twice():this.curve.getInfinity();var r=new _("3"),i=this.x.toBigInteger(),s=this.y.toBigInteger(),o=(t.x.toBigInteger(),t.y.toBigInteger(),
n.square()),a=o.multiply(n),u=i.multiply(o),c=e.square().multiply(this.z),h=c.subtract(u.shiftLeft(1)).multiply(t.z).subtract(a).multiply(n).mod(this.curve.q),l=u.multiply(r).multiply(e).subtract(s.multiply(a)).subtract(c.multiply(e)).multiply(t.z).add(e.multiply(a)).mod(this.curve.q),f=a.multiply(this.z).multiply(t.z).mod(this.curve.q)
;return new at(this.curve,this.curve.fromBigInteger(h),this.curve.fromBigInteger(l),f)},at.prototype.twice=function(){if(this.isInfinity())return this
;if(0==this.y.toBigInteger().signum())return this.curve.getInfinity()
;var t=new _("3"),e=this.x.toBigInteger(),n=this.y.toBigInteger(),r=n.multiply(this.z),i=r.multiply(n).mod(this.curve.q),s=this.curve.a.toBigInteger(),o=e.square().multiply(t)
;_.ZERO.equals(s)||(o=o.add(this.z.square().multiply(s)))
;var a=(o=o.mod(this.curve.q)).square().subtract(e.shiftLeft(3).multiply(i)).shiftLeft(1).multiply(r).mod(this.curve.q),u=o.multiply(t).multiply(e).subtract(i.shiftLeft(1)).shiftLeft(2).multiply(i).subtract(o.square().multiply(o)).mod(this.curve.q),c=r.square().multiply(r).shiftLeft(3).mod(this.curve.q)
;return new at(this.curve,this.curve.fromBigInteger(a),this.curve.fromBigInteger(u),c)},at.prototype.multiply=function(t){if(this.isInfinity())return this
;if(0==t.signum())return this.curve.getInfinity()
;var e,n=t,r=n.multiply(new _("3")),i=this.negate(),s=this,o=this.curve.q.subtract(t),a=o.multiply(new _("3")),u=new at(this.curve,this.x,this.y),c=u.negate();for(e=r.bitLength()-2;e>0;--e){
s=s.twice();var h=r.testBit(e);h!=n.testBit(e)&&(s=s.add(h?this:i))}for(e=a.bitLength()-2;e>0;--e){u=u.twice();var l=a.testBit(e);l!=o.testBit(e)&&(u=u.add(l?u:c))}return s},
at.prototype.multiplyTwo=function(t,e,n){var r;r=t.bitLength()>n.bitLength()?t.bitLength()-1:n.bitLength()-1;for(var i=this.curve.getInfinity(),s=this.add(e);r>=0;)i=i.twice(),
t.testBit(r)?i=n.testBit(r)?i.add(s):i.add(this):n.testBit(r)&&(i=i.add(e)),--r;return i},ut.prototype.getQ=function(){return this.q},ut.prototype.getA=function(){return this.a},
ut.prototype.getB=function(){return this.b},ut.prototype.equals=function(t){return t==this||this.q.equals(t.q)&&this.a.equals(t.a)&&this.b.equals(t.b)},ut.prototype.getInfinity=function(){
return this.infinity},ut.prototype.fromBigInteger=function(t){return new ot(this.q,t)},ut.prototype.decodePointHex=function(t){switch(parseInt(t.substr(0,2),16)){case 0:return this.infinity;case 2:
case 3:return null;case 4:case 6:case 7:var e=(t.length-2)/2,n=t.substr(2,e),r=t.substr(e+2,e);return new at(this,this.fromBigInteger(new _(n,16)),this.fromBigInteger(new _(r,16)));default:return null
}},ot.prototype.getByteLength=function(){return Math.floor((this.toBigInteger().bitLength()+7)/8)},at.prototype.getEncoded=function(t){var e=function(t,e){var n=t.toByteArrayUnsigned()
;if(e<n.length)n=n.slice(n.length-e);else for(;e>n.length;)n.unshift(0);return n},n=this.getX().toBigInteger(),r=this.getY().toBigInteger(),i=e(n,32)
;return t?r.isEven()?i.unshift(2):i.unshift(3):(i.unshift(4),i=i.concat(e(r,32))),i},at.decodeFrom=function(t,e){e[0];var n=e.length-1,r=e.slice(1,1+n/2),i=e.slice(1+n/2,1+n);r.unshift(0),i.unshift(0)
;var s=new _(r),o=new _(i);return new at(t,t.fromBigInteger(s),t.fromBigInteger(o))},at.decodeFromHex=function(t,e){e.substr(0,2)
;var n=e.length-2,r=e.substr(2,n/2),i=e.substr(2+n/2,n/2),s=new _(r,16),o=new _(i,16);return new at(t,t.fromBigInteger(s),t.fromBigInteger(o))},at.prototype.add2D=function(t){
if(this.isInfinity())return t;if(t.isInfinity())return this;if(this.x.equals(t.x))return this.y.equals(t.y)?this.twice():this.curve.getInfinity()
;var e=t.x.subtract(this.x),n=t.y.subtract(this.y).divide(e),r=n.square().subtract(this.x).subtract(t.x),i=n.multiply(this.x.subtract(r)).subtract(this.y);return new at(this.curve,r,i)},
at.prototype.twice2D=function(){if(this.isInfinity())return this;if(0==this.y.toBigInteger().signum())return this.curve.getInfinity()
;var t=this.curve.fromBigInteger(_.valueOf(2)),e=this.curve.fromBigInteger(_.valueOf(3)),n=this.x.square().multiply(e).add(this.curve.a).divide(this.y.multiply(t)),r=n.square().subtract(this.x.multiply(t)),i=n.multiply(this.x.subtract(r)).subtract(this.y)
;return new at(this.curve,r,i)},at.prototype.multiply2D=function(t){if(this.isInfinity())return this;if(0==t.signum())return this.curve.getInfinity()
;var e,n=t,r=n.multiply(new _("3")),i=this.negate(),s=this;for(e=r.bitLength()-2;e>0;--e){s=s.twice();var o=r.testBit(e);o!=n.testBit(e)&&(s=s.add2D(o?this:i))}return s},
at.prototype.isOnCurve=function(){
var t=this.getX().toBigInteger(),e=this.getY().toBigInteger(),n=this.curve.getA().toBigInteger(),r=this.curve.getB().toBigInteger(),i=this.curve.getQ(),s=e.multiply(e).mod(i),o=t.multiply(t).multiply(t).add(n.multiply(t)).add(r).mod(i)
;return s.equals(o)},at.prototype.toString=function(){return"("+this.getX().toBigInteger().toString()+","+this.getY().toBigInteger().toString()+")"},at.prototype.validate=function(){
var t=this.curve.getQ();if(this.isInfinity())throw new Error("Point is at infinity.");var e=this.getX().toBigInteger(),n=this.getY().toBigInteger()
;if(e.compareTo(_.ONE)<0||e.compareTo(t.subtract(_.ONE))>0)throw new Error("x coordinate out of bounds")
;if(n.compareTo(_.ONE)<0||n.compareTo(t.subtract(_.ONE))>0)throw new Error("y coordinate out of bounds");if(!this.isOnCurve())throw new Error("Point is not on the curve.")
;if(this.multiply(t).isInfinity())throw new Error("Point is not a scalar multiple of G.");return!0};var ct=function(){
var t=new RegExp('(?:false|true|null|[\\{\\}\\[\\]]|(?:-?\\b(?:0|[1-9][0-9]*)(?:\\.[0-9]+)?(?:[eE][+-]?[0-9]+)?\\b)|(?:"(?:[^\\0-\\x08\\x0a-\\x1f"\\\\]|\\\\(?:["/\\\\bfnrt]|u[0-9A-Fa-f]{4}))*"))',"g"),e=new RegExp("\\\\(?:([^u])|u(.{4}))","g"),r={
'"':'"',"/":"/","\\":"\\",b:"\b",f:"\f",n:"\n",r:"\r",t:"\t"};function i(t,e,n){return e?r[e]:String.fromCharCode(parseInt(n,16))}var s=new String(""),o=Object.hasOwnProperty;return function(r,a){
var u,c,h=r.match(t),l=h[0],f=!1;"{"===l?u={}:"["===l?u=[]:(u=[],f=!0);for(var d=[u],p=1-f,g=h.length;p<g;++p){var v;switch((l=h[p]).charCodeAt(0)){default:(v=d[0])[c||v.length]=+l,c=void 0;break
;case 34:if(-1!==(l=l.substring(1,l.length-1)).indexOf("\\")&&(l=l.replace(e,i)),v=d[0],!c){if(!(v instanceof Array)){c=l||s;break}c=v.length}v[c]=l,c=void 0;break;case 91:v=d[0],
d.unshift(v[c||v.length]=[]),c=void 0;break;case 93:d.shift();break;case 102:(v=d[0])[c||v.length]=!1,c=void 0;break;case 110:(v=d[0])[c||v.length]=null,c=void 0;break;case 116:
(v=d[0])[c||v.length]=!0,c=void 0;break;case 123:v=d[0],d.unshift(v[c||v.length]={}),c=void 0;break;case 125:d.shift()}}if(f){if(1!==d.length)throw new Error;u=u[0]}else if(d.length)throw new Error
;if(a){u=function t(e,r){var i=e[r];if(i&&"object"===n(i)){var s=null;for(var u in i)if(o.call(i,u)&&i!==e){var c=t(i,u);void 0!==c?i[u]=c:(s||(s=[]),s.push(u))}
if(s)for(var h=s.length;--h>=0;)delete i[s[h]]}return a.call(e,r,i)}({"":u},"")}return u}}();void 0!==ht&&ht||(ht={}),void 0!==ht.asn1&&ht.asn1||(ht.asn1={}),ht.asn1.ASN1Util=new function(){
this.integerToByteHex=function(t){var e=t.toString(16);return e.length%2==1&&(e="0"+e),e},this.bigIntToMinTwosComplementsHex=function(t){var e=t.toString(16)
;if("-"!=e.substr(0,1))e.length%2==1?e="0"+e:e.match(/^[0-7]/)||(e="00"+e);else{var n=e.substr(1).length;n%2==1?n+=1:e.match(/^[0-7]/)||(n+=2);for(var r="",i=0;i<n;i++)r+="f"
;e=new _(r,16).xor(t).add(_.ONE).toString(16).replace(/^-/,"")}return e},this.getPEMStringFromHex=function(t,e){return Tt(t,e)},this.newObject=function(t){
var e=ht.asn1,n=e.DERBoolean,r=e.DERInteger,i=e.DERBitString,s=e.DEROctetString,o=e.DERNull,a=e.DERObjectIdentifier,u=e.DEREnumerated,c=e.DERUTF8String,h=e.DERNumericString,l=e.DERPrintableString,f=e.DERTeletexString,d=e.DERIA5String,p=e.DERUTCTime,g=e.DERGeneralizedTime,v=e.DERVisibleString,y=e.DERBMPString,m=e.DERSequence,S=e.DERSet,b=e.DERTaggedObject,x=e.ASN1Util.newObject,w=Object.keys(t)
;if(1!=w.length)throw"key of param shall be only one.";var _=w[0]
;if(-1==":bool:int:bitstr:octstr:null:oid:enum:utf8str:numstr:prnstr:telstr:ia5str:utctime:gentime:visstr:bmpstr:seq:set:tag:".indexOf(":"+_+":"))throw new Error("undefined key: "+_)
;if("bool"==_)return new n(t[_]);if("int"==_)return new r(t[_]);if("bitstr"==_)return new i(t[_]);if("octstr"==_)return new s(t[_]);if("null"==_)return new o(t[_]);if("oid"==_)return new a(t[_])
;if("enum"==_)return new u(t[_]);if("utf8str"==_)return new c(t[_]);if("numstr"==_)return new h(t[_]);if("prnstr"==_)return new l(t[_]);if("telstr"==_)return new f(t[_])
;if("ia5str"==_)return new d(t[_]);if("utctime"==_)return new p(t[_]);if("gentime"==_)return new g(t[_]);if("visstr"==_)return new v(t[_]);if("bmpstr"==_)return new y(t[_]);if("seq"==_){
for(var E=t[_],A=[],F=0;F<E.length;F++){var C=x(E[F]);A.push(C)}return new m({array:A})}if("set"==_){for(E=t[_],A=[],F=0;F<E.length;F++){C=x(E[F]);A.push(C)}return new S({array:A})}if("tag"==_){
var k=t[_];if("[object Array]"===Object.prototype.toString.call(k)&&3==k.length){var T=x(k[2]);return new b({tag:k[0],explicit:k[1],obj:T})}var P={};if(void 0!==k.explicit&&(P.explicit=k.explicit),
void 0!==k.tag&&(P.tag=k.tag),void 0===k.obj)throw"obj shall be specified for 'tag'.";return P.obj=x(k.obj),new b(P)}},this.jsonToASN1HEX=function(t){return this.newObject(t).getEncodedHex()}},
ht.asn1.ASN1Util.oidHexToInt=function(t){for(var e="",n=parseInt(t.substr(0,2),16),r=(e=Math.floor(n/40)+"."+n%40,""),i=2;i<t.length;i+=2){
var s=("00000000"+parseInt(t.substr(i,2),16).toString(2)).slice(-8);if(r+=s.substr(1,7),"0"==s.substr(0,1))e=e+"."+new _(r,2).toString(10),r=""}return e},ht.asn1.ASN1Util.oidIntToHex=function(t){
var e=function(t){var e=t.toString(16);return 1==e.length&&(e="0"+e),e},n=function(t){var n="",r=new _(t,10).toString(2),i=7-r.length%7;7==i&&(i=0);for(var s="",o=0;o<i;o++)s+="0";r=s+r
;for(o=0;o<r.length-1;o+=7){var a=r.substr(o,7);o!=r.length-7&&(a="1"+a),n+=e(parseInt(a,2))}return n};if(!t.match(/^[0-9.]+$/))throw"malformed oid string: "+t
;var r="",i=t.split("."),s=40*parseInt(i[0])+parseInt(i[1]);r+=e(s),i.splice(0,2);for(var o=0;o<i.length;o++)r+=n(i[o]);return r},ht.asn1.ASN1Object=function(){this.getLengthHexFromValue=function(){
if(void 0===this.hV||null==this.hV)throw"this.hV is null or undefined.";if(this.hV.length%2==1)throw"value hex must be even length: n="+"".length+",v="+this.hV;var t=this.hV.length/2,e=t.toString(16)
;if(e.length%2==1&&(e="0"+e),t<128)return e;var n=e.length/2;if(n>15)throw"ASN.1 length too long to represent by 8x: n = "+t.toString(16);return(128+n).toString(16)+e},this.getEncodedHex=function(){
return(null==this.hTLV||this.isModified)&&(this.hV=this.getFreshValueHex(),this.hL=this.getLengthHexFromValue(),this.hTLV=this.hT+this.hL+this.hV,this.isModified=!1),this.hTLV},
this.getValueHex=function(){return this.getEncodedHex(),this.hV},this.getFreshValueHex=function(){return""}},ht.asn1.DERAbstractString=function(t){
ht.asn1.DERAbstractString.superclass.constructor.call(this);this.getString=function(){return this.s},this.setString=function(t){this.hTLV=null,this.isModified=!0,this.s=t,
this.hV=wt(this.s).toLowerCase()},this.setStringHex=function(t){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=t},this.getFreshValueHex=function(){return this.hV},
void 0!==t&&("string"==typeof t?this.setString(t):void 0!==t.str?this.setString(t.str):void 0!==t.hex&&this.setStringHex(t.hex))},s.lang.extend(ht.asn1.DERAbstractString,ht.asn1.ASN1Object),
ht.asn1.DERAbstractTime=function(t){ht.asn1.DERAbstractTime.superclass.constructor.call(this);this.localDateToUTC=function(t){var e=t.getTime()+6e4*t.getTimezoneOffset();return new Date(e)},
this.formatDate=function(t,e,n){var r=this.zeroPadding,i=this.localDateToUTC(t),s=String(i.getFullYear());"utc"==e&&(s=s.substr(2,2))
;var o=s+r(String(i.getMonth()+1),2)+r(String(i.getDate()),2)+r(String(i.getHours()),2)+r(String(i.getMinutes()),2)+r(String(i.getSeconds()),2);if(!0===n){var a=i.getMilliseconds();if(0!=a){
var u=r(String(a),3);o=o+"."+(u=u.replace(/[0]+$/,""))}}return o+"Z"},this.zeroPadding=function(t,e){return t.length>=e?t:new Array(e-t.length+1).join("0")+t},this.getString=function(){return this.s},
this.setString=function(t){this.hTLV=null,this.isModified=!0,this.s=t,this.hV=yt(t)},this.setByDateValue=function(t,e,n,r,i,s){var o=new Date(Date.UTC(t,e-1,n,r,i,s,0));this.setByDate(o)},
this.getFreshValueHex=function(){return this.hV}},s.lang.extend(ht.asn1.DERAbstractTime,ht.asn1.ASN1Object),ht.asn1.DERAbstractStructured=function(t){
ht.asn1.DERAbstractString.superclass.constructor.call(this);this.setByASN1ObjectArray=function(t){this.hTLV=null,this.isModified=!0,this.asn1Array=t},this.appendASN1Object=function(t){this.hTLV=null,
this.isModified=!0,this.asn1Array.push(t)},this.asn1Array=new Array,void 0!==t&&void 0!==t.array&&(this.asn1Array=t.array)},s.lang.extend(ht.asn1.DERAbstractStructured,ht.asn1.ASN1Object),
ht.asn1.DERBoolean=function(){ht.asn1.DERBoolean.superclass.constructor.call(this),this.hT="01",this.hTLV="0101ff"},s.lang.extend(ht.asn1.DERBoolean,ht.asn1.ASN1Object),ht.asn1.DERInteger=function(t){
ht.asn1.DERInteger.superclass.constructor.call(this),this.hT="02",this.setByBigInteger=function(t){this.hTLV=null,this.isModified=!0,this.hV=ht.asn1.ASN1Util.bigIntToMinTwosComplementsHex(t)},
this.setByInteger=function(t){var e=new _(String(t),10);this.setByBigInteger(e)},this.setValueHex=function(t){this.hV=t},this.getFreshValueHex=function(){return this.hV},
void 0!==t&&(void 0!==t.bigint?this.setByBigInteger(t.bigint):void 0!==t.int?this.setByInteger(t.int):"number"==typeof t?this.setByInteger(t):void 0!==t.hex&&this.setValueHex(t.hex))},
s.lang.extend(ht.asn1.DERInteger,ht.asn1.ASN1Object),ht.asn1.DERBitString=function(t){if(void 0!==t&&void 0!==t.obj){var e=ht.asn1.ASN1Util.newObject(t.obj);t.hex="00"+e.getEncodedHex()}
ht.asn1.DERBitString.superclass.constructor.call(this),this.hT="03",this.setHexValueIncludingUnusedBits=function(t){this.hTLV=null,this.isModified=!0,this.hV=t},
this.setUnusedBitsAndHexValue=function(t,e){if(t<0||7<t)throw"unused bits shall be from 0 to 7: u = "+t;var n="0"+t;this.hTLV=null,this.isModified=!0,this.hV=n+e},this.setByBinaryString=function(t){
var e=8-(t=t.replace(/0+$/,"")).length%8;8==e&&(e=0);for(var n=0;n<=e;n++)t+="0";var r="";for(n=0;n<t.length-1;n+=8){var i=t.substr(n,8),s=parseInt(i,2).toString(16);1==s.length&&(s="0"+s),r+=s}
this.hTLV=null,this.isModified=!0,this.hV="0"+e+r},this.setByBooleanArray=function(t){for(var e="",n=0;n<t.length;n++)1==t[n]?e+="1":e+="0";this.setByBinaryString(e)},this.newFalseArray=function(t){
for(var e=new Array(t),n=0;n<t;n++)e[n]=!1;return e},this.getFreshValueHex=function(){return this.hV},
void 0!==t&&("string"==typeof t&&t.toLowerCase().match(/^[0-9a-f]+$/)?this.setHexValueIncludingUnusedBits(t):void 0!==t.hex?this.setHexValueIncludingUnusedBits(t.hex):void 0!==t.bin?this.setByBinaryString(t.bin):void 0!==t.array&&this.setByBooleanArray(t.array))
},s.lang.extend(ht.asn1.DERBitString,ht.asn1.ASN1Object),ht.asn1.DEROctetString=function(t){if(void 0!==t&&void 0!==t.obj){var e=ht.asn1.ASN1Util.newObject(t.obj);t.hex=e.getEncodedHex()}
ht.asn1.DEROctetString.superclass.constructor.call(this,t),this.hT="04"},s.lang.extend(ht.asn1.DEROctetString,ht.asn1.DERAbstractString),ht.asn1.DERNull=function(){
ht.asn1.DERNull.superclass.constructor.call(this),this.hT="05",this.hTLV="0500"},s.lang.extend(ht.asn1.DERNull,ht.asn1.ASN1Object),ht.asn1.DERObjectIdentifier=function(t){var e=function(t){
var e=t.toString(16);return 1==e.length&&(e="0"+e),e},n=function(t){var n="",r=new _(t,10).toString(2),i=7-r.length%7;7==i&&(i=0);for(var s="",o=0;o<i;o++)s+="0";r=s+r;for(o=0;o<r.length-1;o+=7){
var a=r.substr(o,7);o!=r.length-7&&(a="1"+a),n+=e(parseInt(a,2))}return n};ht.asn1.DERObjectIdentifier.superclass.constructor.call(this),this.hT="06",this.setValueHex=function(t){this.hTLV=null,
this.isModified=!0,this.s=null,this.hV=t},this.setValueOidString=function(t){if(!t.match(/^[0-9.]+$/))throw"malformed oid string: "+t;var r="",i=t.split("."),s=40*parseInt(i[0])+parseInt(i[1])
;r+=e(s),i.splice(0,2);for(var o=0;o<i.length;o++)r+=n(i[o]);this.hTLV=null,this.isModified=!0,this.s=null,this.hV=r},this.setValueName=function(t){var e=ht.asn1.x509.OID.name2oid(t)
;if(""===e)throw"DERObjectIdentifier oidName undefined: "+t;this.setValueOidString(e)},this.getFreshValueHex=function(){return this.hV},
void 0!==t&&("string"==typeof t?t.match(/^[0-2].[0-9.]+$/)?this.setValueOidString(t):this.setValueName(t):void 0!==t.oid?this.setValueOidString(t.oid):void 0!==t.hex?this.setValueHex(t.hex):void 0!==t.name&&this.setValueName(t.name))
},s.lang.extend(ht.asn1.DERObjectIdentifier,ht.asn1.ASN1Object),ht.asn1.DEREnumerated=function(t){ht.asn1.DEREnumerated.superclass.constructor.call(this),this.hT="0a",this.setByBigInteger=function(t){
this.hTLV=null,this.isModified=!0,this.hV=ht.asn1.ASN1Util.bigIntToMinTwosComplementsHex(t)},this.setByInteger=function(t){var e=new _(String(t),10);this.setByBigInteger(e)},
this.setValueHex=function(t){this.hV=t},this.getFreshValueHex=function(){return this.hV},
void 0!==t&&(void 0!==t.int?this.setByInteger(t.int):"number"==typeof t?this.setByInteger(t):void 0!==t.hex&&this.setValueHex(t.hex))},s.lang.extend(ht.asn1.DEREnumerated,ht.asn1.ASN1Object),
ht.asn1.DERUTF8String=function(t){ht.asn1.DERUTF8String.superclass.constructor.call(this,t),this.hT="0c"},s.lang.extend(ht.asn1.DERUTF8String,ht.asn1.DERAbstractString),
ht.asn1.DERNumericString=function(t){ht.asn1.DERNumericString.superclass.constructor.call(this,t),this.hT="12"},s.lang.extend(ht.asn1.DERNumericString,ht.asn1.DERAbstractString),
ht.asn1.DERPrintableString=function(t){ht.asn1.DERPrintableString.superclass.constructor.call(this,t),this.hT="13"},s.lang.extend(ht.asn1.DERPrintableString,ht.asn1.DERAbstractString),
ht.asn1.DERTeletexString=function(t){ht.asn1.DERTeletexString.superclass.constructor.call(this,t),this.hT="14"},s.lang.extend(ht.asn1.DERTeletexString,ht.asn1.DERAbstractString),
ht.asn1.DERIA5String=function(t){ht.asn1.DERIA5String.superclass.constructor.call(this,t),this.hT="16"},s.lang.extend(ht.asn1.DERIA5String,ht.asn1.DERAbstractString),
ht.asn1.DERVisibleString=function(t){ht.asn1.DERIA5String.superclass.constructor.call(this,t),this.hT="1a"},s.lang.extend(ht.asn1.DERVisibleString,ht.asn1.DERAbstractString),
ht.asn1.DERBMPString=function(t){ht.asn1.DERBMPString.superclass.constructor.call(this,t),this.hT="1e"},s.lang.extend(ht.asn1.DERBMPString,ht.asn1.DERAbstractString),ht.asn1.DERUTCTime=function(t){
ht.asn1.DERUTCTime.superclass.constructor.call(this,t),this.hT="17",this.setByDate=function(t){this.hTLV=null,this.isModified=!0,this.date=t,this.s=this.formatDate(this.date,"utc"),this.hV=yt(this.s)
},this.getFreshValueHex=function(){return void 0===this.date&&void 0===this.s&&(this.date=new Date,this.s=this.formatDate(this.date,"utc"),this.hV=yt(this.s)),this.hV},
void 0!==t&&(void 0!==t.str?this.setString(t.str):"string"==typeof t&&t.match(/^[0-9]{12}Z$/)?this.setString(t):void 0!==t.hex?this.setStringHex(t.hex):void 0!==t.date&&this.setByDate(t.date))},
s.lang.extend(ht.asn1.DERUTCTime,ht.asn1.DERAbstractTime),ht.asn1.DERGeneralizedTime=function(t){ht.asn1.DERGeneralizedTime.superclass.constructor.call(this,t),this.hT="18",this.withMillis=!1,
this.setByDate=function(t){this.hTLV=null,this.isModified=!0,this.date=t,this.s=this.formatDate(this.date,"gen",this.withMillis),this.hV=yt(this.s)},this.getFreshValueHex=function(){
return void 0===this.date&&void 0===this.s&&(this.date=new Date,this.s=this.formatDate(this.date,"gen",this.withMillis),this.hV=yt(this.s)),this.hV},
void 0!==t&&(void 0!==t.str?this.setString(t.str):"string"==typeof t&&t.match(/^[0-9]{14}Z$/)?this.setString(t):void 0!==t.hex?this.setStringHex(t.hex):void 0!==t.date&&this.setByDate(t.date),
!0===t.millis&&(this.withMillis=!0))},s.lang.extend(ht.asn1.DERGeneralizedTime,ht.asn1.DERAbstractTime),ht.asn1.DERSequence=function(t){ht.asn1.DERSequence.superclass.constructor.call(this,t),
this.hT="30",this.getFreshValueHex=function(){for(var t="",e=0;e<this.asn1Array.length;e++){t+=this.asn1Array[e].getEncodedHex()}return this.hV=t,this.hV}},
s.lang.extend(ht.asn1.DERSequence,ht.asn1.DERAbstractStructured),ht.asn1.DERSet=function(t){ht.asn1.DERSet.superclass.constructor.call(this,t),this.hT="31",this.sortFlag=!0,
this.getFreshValueHex=function(){for(var t=new Array,e=0;e<this.asn1Array.length;e++){var n=this.asn1Array[e];t.push(n.getEncodedHex())}return 1==this.sortFlag&&t.sort(),this.hV=t.join(""),this.hV},
void 0!==t&&void 0!==t.sortflag&&0==t.sortflag&&(this.sortFlag=!1)},s.lang.extend(ht.asn1.DERSet,ht.asn1.DERAbstractStructured),ht.asn1.DERTaggedObject=function(t){
ht.asn1.DERTaggedObject.superclass.constructor.call(this),this.hT="a0",this.hV="",this.isExplicit=!0,this.asn1Object=null,this.setASN1Object=function(t,e,n){this.hT=e,this.isExplicit=t,
this.asn1Object=n,this.isExplicit?(this.hV=this.asn1Object.getEncodedHex(),this.hTLV=null,this.isModified=!0):(this.hV=null,this.hTLV=n.getEncodedHex(),this.hTLV=this.hTLV.replace(/^../,e),
this.isModified=!1)},this.getFreshValueHex=function(){return this.hV},void 0!==t&&(void 0!==t.tag&&(this.hT=t.tag),void 0!==t.explicit&&(this.isExplicit=t.explicit),
void 0!==t.obj&&(this.asn1Object=t.obj,this.setASN1Object(this.isExplicit,this.hT,this.asn1Object)))},s.lang.extend(ht.asn1.DERTaggedObject,ht.asn1.ASN1Object);var ht,lt,ft,dt=new function(){}
;function pt(t){for(var e=new Array,n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}function gt(t){for(var e="",n=0;n<t.length;n++)e+=String.fromCharCode(t[n]);return e}function vt(t){
for(var e="",n=0;n<t.length;n++){var r=t[n].toString(16);1==r.length&&(r="0"+r),e+=r}return e}function yt(t){return vt(pt(t))}function mt(t){
return t=(t=(t=t.replace(/\=/g,"")).replace(/\+/g,"-")).replace(/\//g,"_")}function St(t){return t.length%4==2?t+="==":t.length%4==3&&(t+="="),t=(t=t.replace(/-/g,"+")).replace(/_/g,"/")}
function bt(t){return t.length%2==1&&(t="0"+t),mt(b(t))}function xt(t){return x(St(t))}function wt(t){return Dt(jt(t))}function _t(t){return decodeURIComponent(Bt(t))}function Et(t){
for(var e="",n=0;n<t.length-1;n+=2)e+=String.fromCharCode(parseInt(t.substr(n,2),16));return e}function At(t){for(var e="",n=0;n<t.length;n++)e+=("0"+t.charCodeAt(n).toString(16)).slice(-2);return e}
function Ft(t){return b(t)}function Ct(t){var e=Ft(t).replace(/(.{64})/g,"$1\r\n");return e=e.replace(/\r\n$/,"")}function kt(t){return x(t.replace(/[^0-9A-Za-z\/+=]*/g,""))}function Tt(t,e){
return"-----BEGIN "+e+"-----\r\n"+Ct(t)+"\r\n-----END "+e+"-----\r\n"}function Pt(t,e){if(-1==t.indexOf("-----BEGIN "))throw"can't find PEM header: "+e
;return kt(t=void 0!==e?(t=t.replace(new RegExp("^[^]*-----BEGIN "+e+"-----"),"")).replace(new RegExp("-----END "+e+"-----[^]*$"),""):(t=t.replace(/^[^]*-----BEGIN [^-]+-----/,"")).replace(/-----END [^-]+-----[^]*$/,""))
}function Rt(t){var e,n,r,i,s,o,a,u,c,h,l;if(l=t.match(/^(\d{2}|\d{4})(\d\d)(\d\d)(\d\d)(\d\d)(\d\d)(|\.\d+)Z$/))return u=l[1],e=parseInt(u),
2===u.length&&(50<=e&&e<100?e=1900+e:0<=e&&e<50&&(e=2e3+e)),n=parseInt(l[2])-1,r=parseInt(l[3]),i=parseInt(l[4]),s=parseInt(l[5]),o=parseInt(l[6]),a=0,""!==(c=l[7])&&(h=(c.substr(1)+"00").substr(0,3),
a=parseInt(h)),Date.UTC(e,n,r,i,s,o,a);throw"unsupported zulu format: "+t}function It(t){return~~(Rt(t)/1e3)}function Dt(t){return t.replace(/%/g,"")}function Bt(t){return t.replace(/(..)/g,"%$1")}
function Nt(t){var e="malformed IPv6 address";if(!t.match(/^[0-9A-Fa-f:]+$/))throw e;var n=(t=t.toLowerCase()).split(":").length-1;if(n<2)throw e
;var r=":".repeat(7-n+2),i=(t=t.replace("::",r)).split(":");if(8!=i.length)throw e;for(var s=0;s<8;s++)i[s]=("0000"+i[s]).slice(-4);return i.join("")}function Ot(t){
if(!t.match(/^[0-9A-Fa-f]{32}$/))throw"malformed IPv6 address octet";for(var e=(t=t.toLowerCase()).match(/.{1,4}/g),n=0;n<8;n++)e[n]=e[n].replace(/^0+/,""),""==e[n]&&(e[n]="0")
;var r=(t=":"+e.join(":")+":").match(/:(0:){2,}/g);if(null===r)return t.slice(1,-1);var i="";for(n=0;n<r.length;n++)r[n].length>i.length&&(i=r[n]);return(t=t.replace(i,"::")).slice(1,-1)}
function Ht(t){var e="malformed hex value";if(!t.match(/^([0-9A-Fa-f][0-9A-Fa-f]){1,}$/))throw e;if(8!=t.length)return 32==t.length?Ot(t):t;try{
return parseInt(t.substr(0,2),16)+"."+parseInt(t.substr(2,2),16)+"."+parseInt(t.substr(4,2),16)+"."+parseInt(t.substr(6,2),16)}catch(t){throw e}}function jt(t){
for(var e=encodeURIComponent(t),n="",r=0;r<e.length;r++)"%"==e[r]?(n+=e.substr(r,3),r+=2):n=n+"%"+yt(e[r]);return n}function Lt(t){return t.length%2==1?"0"+t:t.substr(0,1)>"7"?"00"+t:t}function Vt(t){
t=(t=(t=t.replace(/^\s*\[\s*/,"")).replace(/\s*\]\s*$/,"")).replace(/\s*/g,"");try{return t.split(/,/).map((function(t,e,n){var r=parseInt(t);if(r<0||255<r)throw"integer not in range 0-255"
;return("00"+r.toString(16)).slice(-2)})).join("")}catch(t){throw"malformed integer array string: "+t}}dt.getLblen=function(t,e){if("8"!=t.substr(e+2,1))return 1;var n=parseInt(t.substr(e+3,1))
;return 0==n?-1:0<n&&n<10?n+1:-2},dt.getL=function(t,e){var n=dt.getLblen(t,e);return n<1?"":t.substr(e+2,2*n)},dt.getVblen=function(t,e){var n
;return""==(n=dt.getL(t,e))?-1:("8"===n.substr(0,1)?new _(n.substr(2),16):new _(n,16)).intValue()},dt.getVidx=function(t,e){var n=dt.getLblen(t,e);return n<0?n:e+2*(n+1)},dt.getV=function(t,e){
var n=dt.getVidx(t,e),r=dt.getVblen(t,e);return t.substr(n,2*r)},dt.getTLV=function(t,e){return t.substr(e,2)+dt.getL(t,e)+dt.getV(t,e)},dt.getNextSiblingIdx=function(t,e){
return dt.getVidx(t,e)+2*dt.getVblen(t,e)},dt.getChildIdx=function(t,e){var n=dt,r=new Array,i=n.getVidx(t,e);"03"==t.substr(e,2)?r.push(i+2):r.push(i);for(var s=n.getVblen(t,e),o=i,a=0;;){
var u=n.getNextSiblingIdx(t,o);if(null==u||u-i>=2*s)break;if(a>=200)break;r.push(u),o=u,a++}return r},dt.getNthChildIdx=function(t,e,n){return dt.getChildIdx(t,e)[n]},
dt.getIdxbyList=function(t,e,n,r){var i,s,o=dt;if(0==n.length){if(void 0!==r&&t.substr(e,2)!==r)throw Error("checking tag doesn't match: "+t.substr(e,2)+"!="+r);return e}return i=n.shift(),
s=o.getChildIdx(t,e),o.getIdxbyList(t,s[i],n,r)},dt.getIdxbyListEx=function(t,e,n,r){var i,s,o=dt;if(0==n.length)return void 0!==r&&t.substr(e,2)!==r?-1:e;i=n.shift(),s=o.getChildIdx(t,e)
;for(var a=0,u=0;u<s.length;u++){var c=t.substr(s[u],2);if("number"==typeof i&&!o.isContextTag(c)&&a==i||"string"==typeof i&&o.isContextTag(c,i))return o.getIdxbyListEx(t,s[u],n,r)
;o.isContextTag(c)||a++}return-1},dt.getTLVbyList=function(t,e,n,r){var i=dt,s=i.getIdxbyList(t,e,n);if(void 0===s)throw new Error("can't find nthList object")
;if(void 0!==r&&t.substr(s,2)!=r)throw new Error("checking tag doesn't match: "+t.substr(s,2)+"!="+r);return i.getTLV(t,s)},dt.getTLVbyListEx=function(t,e,n,r){var i=dt,s=i.getIdxbyListEx(t,e,n,r)
;return-1==s?null:i.getTLV(t,s)},dt.getVbyList=function(t,e,n,r,i){var s,o,a=dt;if(void 0===(s=a.getIdxbyList(t,e,n,r)))throw"can't find nthList object";return o=a.getV(t,s),!0===i&&(o=o.substr(2)),o
},dt.getVbyListEx=function(t,e,n,r,i){var s,o,a=dt;return-1==(s=a.getIdxbyListEx(t,e,n,r))?null:(o=a.getV(t,s),"03"==t.substr(s,2)&&!1!==i&&(o=o.substr(2)),o)},dt.hextooidstr=function(t){
var e=function(t,e){return t.length>=e?t:new Array(e-t.length+1).join("0")+t},n=[],r=t.substr(0,2),i=parseInt(r,16);n[0]=new String(Math.floor(i/40)),n[1]=new String(i%40)
;for(var s=t.substr(2),o=[],a=0;a<s.length/2;a++)o.push(parseInt(s.substr(2*a,2),16));var u=[],c="";for(a=0;a<o.length;a++)128&o[a]?c+=e((127&o[a]).toString(2),7):(c+=e((127&o[a]).toString(2),7),
u.push(new String(parseInt(c,2))),c="");var h=n.join(".");return u.length>0&&(h=h+"."+u.join(".")),h},dt.dump=function(t,e,n,r){var i=dt,s=i.getV,o=i.dump,a=i.getChildIdx,u=t
;t instanceof ht.asn1.ASN1Object&&(u=t.getEncodedHex());var c=function(t,e){return t.length<=2*e?t:t.substr(0,e)+"..(total "+t.length/2+"bytes).."+t.substr(t.length-e,e)};void 0===e&&(e={
ommit_long_octet:32}),void 0===n&&(n=0),void 0===r&&(r="");var h,l=e.ommit_long_octet;if("01"==(h=u.substr(n,2)))return"00"==(f=s(u,n))?r+"BOOLEAN FALSE\n":r+"BOOLEAN TRUE\n"
;if("02"==h)return r+"INTEGER "+c(f=s(u,n),l)+"\n";if("03"==h){var f=s(u,n);if(i.isASN1HEX(f.substr(2))){var d=r+"BITSTRING, encapsulates\n";return d+=o(f.substr(2),e,0,r+"  ")}
return r+"BITSTRING "+c(f,l)+"\n"}if("04"==h){f=s(u,n);if(i.isASN1HEX(f)){d=r+"OCTETSTRING, encapsulates\n";return d+=o(f,e,0,r+"  ")}return r+"OCTETSTRING "+c(f,l)+"\n"}if("05"==h)return r+"NULL\n"
;if("06"==h){var p=s(u,n),g=ht.asn1.ASN1Util.oidHexToInt(p),v=ht.asn1.x509.OID.oid2name(g),y=g.replace(/\./g," ");return""!=v?r+"ObjectIdentifier "+v+" ("+y+")\n":r+"ObjectIdentifier ("+y+")\n"}
if("0c"==h)return r+"UTF8String '"+_t(s(u,n))+"'\n";if("13"==h)return r+"PrintableString '"+_t(s(u,n))+"'\n";if("14"==h)return r+"TeletexString '"+_t(s(u,n))+"'\n"
;if("16"==h)return r+"IA5String '"+_t(s(u,n))+"'\n";if("17"==h)return r+"UTCTime "+_t(s(u,n))+"\n";if("18"==h)return r+"GeneralizedTime "+_t(s(u,n))+"\n"
;if("1a"==h)return r+"VisualString '"+_t(s(u,n))+"'\n";if("1e"==h)return r+"BMPString '"+_t(s(u,n))+"'\n";if("30"==h){if("3000"==u.substr(n,4))return r+"SEQUENCE {}\n";d=r+"SEQUENCE\n";var m=e
;if((2==(x=a(u,n)).length||3==x.length)&&"06"==u.substr(x[0],2)&&"04"==u.substr(x[x.length-1],2)){v=i.oidname(s(u,x[0]));var S=JSON.parse(JSON.stringify(e));S.x509ExtName=v,m=S}
for(var b=0;b<x.length;b++)d+=o(u,m,x[b],r+"  ");return d}if("31"==h){d=r+"SET\n";var x=a(u,n);for(b=0;b<x.length;b++)d+=o(u,e,x[b],r+"  ");return d}if(0!=(128&(h=parseInt(h,16)))){var w=31&h
;if(0!=(32&h)){var d=r+"["+w+"]\n";for(x=a(u,n),b=0;b<x.length;b++)d+=o(u,e,x[b],r+"  ");return d}return"68747470"==(f=s(u,n)).substr(0,8)&&(f=_t(f)),"subjectAltName"===e.x509ExtName&&2==w&&(f=_t(f)),
d=r+"["+w+"] "+f+"\n"}return r+"UNKNOWN("+h+") "+s(u,n)+"\n"},dt.isContextTag=function(t,e){var n,r;t=t.toLowerCase();try{n=parseInt(t,16)}catch(t){return-1}if(void 0===e)return 128==(192&n);try{
return null!=e.match(/^\[[0-9]+\]$/)&&(!((r=parseInt(e.substr(1,e.length-1),10))>31)&&(128==(192&n)&&(31&n)==r))}catch(t){return!1}},dt.isASN1HEX=function(t){var e=dt;if(t.length%2==1)return!1
;var n=e.getVblen(t,0),r=t.substr(0,2),i=e.getL(t,0);return t.length-r.length-i.length==2*n},dt.checkStrictDER=function(t,e,n,r,i){var s=dt;if(void 0===n){
if("string"!=typeof t)throw new Error("not hex string");if(t=t.toLowerCase(),!ht.lang.String.isHex(t))throw new Error("not hex string");n=t.length,i=(r=t.length/2)<128?1:Math.ceil(r.toString(16))+1}
if(s.getL(t,e).length>2*i)throw new Error("L of TLV too long: idx="+e);var o=s.getVblen(t,e);if(o>r)throw new Error("value of L too long than hex: idx="+e)
;var a=s.getTLV(t,e),u=a.length-2-s.getL(t,e).length;if(u!==2*o)throw new Error("V string length and L's value not the same:"+u+"/"+2*o)
;if(0===e&&t.length!=a.length)throw new Error("total length and TLV length unmatch:"+t.length+"!="+a.length);var c=t.substr(e,2);if("02"===c){var h=s.getVidx(t,e)
;if("00"==t.substr(h,2)&&t.charCodeAt(h+2)<56)throw new Error("not least zeros for DER INTEGER")}if(32&parseInt(c,16)){for(var l=s.getVblen(t,e),f=0,d=s.getChildIdx(t,e),p=0;p<d.length;p++){
f+=s.getTLV(t,d[p]).length,s.checkStrictDER(t,d[p],n,r,i)}if(2*l!=f)throw new Error("sum of children's TLV length and L unmatch: "+2*l+"!="+f)}},dt.oidname=function(t){var e=ht.asn1
;ht.lang.String.isHex(t)&&(t=e.ASN1Util.oidHexToInt(t));var n=e.x509.OID.oid2name(t);return""===n&&(n=t),n},void 0!==ht&&ht||(ht={}),void 0!==ht.asn1&&ht.asn1||(ht.asn1={}),
void 0!==ht.asn1.x509&&ht.asn1.x509||(ht.asn1.x509={}),ht.asn1.x509.Certificate=function(t){ht.asn1.x509.Certificate.superclass.constructor.call(this);var e=ht,n=(e.crypto,
e.asn1),r=n.DERSequence,i=n.DERBitString;this.sign=function(){this.asn1SignatureAlg=this.asn1TBSCert.asn1SignatureAlg;var t=new ht.crypto.Signature({alg:this.asn1SignatureAlg.nameAlg})
;t.init(this.prvKey),t.updateHex(this.asn1TBSCert.getEncodedHex()),this.hexSig=t.sign(),this.asn1Sig=new i({hex:"00"+this.hexSig});var e=new r({
array:[this.asn1TBSCert,this.asn1SignatureAlg,this.asn1Sig]});this.hTLV=e.getEncodedHex(),this.isModified=!1},this.setSignatureHex=function(t){this.asn1SignatureAlg=this.asn1TBSCert.asn1SignatureAlg,
this.hexSig=t,this.asn1Sig=new i({hex:"00"+this.hexSig});var e=new r({array:[this.asn1TBSCert,this.asn1SignatureAlg,this.asn1Sig]});this.hTLV=e.getEncodedHex(),this.isModified=!1},
this.getEncodedHex=function(){if(0==this.isModified&&null!=this.hTLV)return this.hTLV;throw"not signed yet"},this.getPEMString=function(){
return"-----BEGIN CERTIFICATE-----\r\n"+Ct(this.getEncodedHex())+"\r\n-----END CERTIFICATE-----\r\n"},void 0!==t&&(void 0!==t.tbscertobj&&(this.asn1TBSCert=t.tbscertobj),
void 0!==t.prvkeyobj&&(this.prvKey=t.prvkeyobj))},s.lang.extend(ht.asn1.x509.Certificate,ht.asn1.ASN1Object),ht.asn1.x509.TBSCertificate=function(t){
ht.asn1.x509.TBSCertificate.superclass.constructor.call(this);var e=ht.asn1,n=e.DERSequence,r=e.DERInteger,i=e.DERTaggedObject,s=e.x509,o=s.Time,a=s.X500Name,u=s.SubjectPublicKeyInfo
;this._initialize=function(){this.asn1Array=new Array,this.asn1Version=new i({obj:new r({int:2})}),this.asn1SerialNumber=null,this.asn1SignatureAlg=null,this.asn1Issuer=null,this.asn1NotBefore=null,
this.asn1NotAfter=null,this.asn1Subject=null,this.asn1SubjPKey=null,this.extensionsArray=new Array},this.setSerialNumberByParam=function(t){this.asn1SerialNumber=new r(t)},
this.setSignatureAlgByParam=function(t){this.asn1SignatureAlg=new s.AlgorithmIdentifier(t)},this.setIssuerByParam=function(t){this.asn1Issuer=new a(t)},this.setNotBeforeByParam=function(t){
this.asn1NotBefore=new o(t)},this.setNotAfterByParam=function(t){this.asn1NotAfter=new o(t)},this.setSubjectByParam=function(t){this.asn1Subject=new a(t)},this.setSubjectPublicKey=function(t){
this.asn1SubjPKey=new u(t)},this.setSubjectPublicKeyByGetKey=function(t){var e=Ut.getKey(t);this.asn1SubjPKey=new u(e)},this.appendExtension=function(t){this.extensionsArray.push(t)},
this.appendExtensionByName=function(t,e){ht.asn1.x509.Extension.appendByNameToArray(t,e,this.extensionsArray)},this.getEncodedHex=function(){
if(null==this.asn1NotBefore||null==this.asn1NotAfter)throw"notBefore and/or notAfter not set";var t=new n({array:[this.asn1NotBefore,this.asn1NotAfter]});if(this.asn1Array=new Array,
this.asn1Array.push(this.asn1Version),this.asn1Array.push(this.asn1SerialNumber),this.asn1Array.push(this.asn1SignatureAlg),this.asn1Array.push(this.asn1Issuer),this.asn1Array.push(t),
this.asn1Array.push(this.asn1Subject),this.asn1Array.push(this.asn1SubjPKey),this.extensionsArray.length>0){var e=new n({array:this.extensionsArray}),r=new i({explicit:!0,tag:"a3",obj:e})
;this.asn1Array.push(r)}var s=new n({array:this.asn1Array});return this.hTLV=s.getEncodedHex(),this.isModified=!1,this.hTLV},this._initialize()},
s.lang.extend(ht.asn1.x509.TBSCertificate,ht.asn1.ASN1Object),ht.asn1.x509.Extension=function(t){ht.asn1.x509.Extension.superclass.constructor.call(this)
;var e=ht.asn1,n=e.DERObjectIdentifier,r=e.DEROctetString,i=(e.DERBitString,e.DERBoolean),s=e.DERSequence;this.getEncodedHex=function(){var t=new n({oid:this.oid}),e=new r({hex:this.getExtnValueHex()
}),o=new Array;return o.push(t),this.critical&&o.push(new i),o.push(e),new s({array:o}).getEncodedHex()},this.critical=!1,void 0!==t&&void 0!==t.critical&&(this.critical=t.critical)},
s.lang.extend(ht.asn1.x509.Extension,ht.asn1.ASN1Object),ht.asn1.x509.Extension.appendByNameToArray=function(t,e,n){var r=t.toLowerCase(),i=ht.asn1.x509;if("basicconstraints"==r){
var s=new i.BasicConstraints(e);n.push(s)}else if("keyusage"==r){s=new i.KeyUsage(e);n.push(s)}else if("crldistributionpoints"==r){s=new i.CRLDistributionPoints(e);n.push(s)}else if("extkeyusage"==r){
s=new i.ExtKeyUsage(e);n.push(s)}else if("authoritykeyidentifier"==r){s=new i.AuthorityKeyIdentifier(e);n.push(s)}else if("subjectkeyidentifier"==r){s=new i.SubjectKeyIdentifier(e);n.push(s)
}else if("authorityinfoaccess"==r){s=new i.AuthorityInfoAccess(e);n.push(s)}else if("subjectaltname"==r){s=new i.SubjectAltName(e);n.push(s)}else if("issueraltname"==r){s=new i.IssuerAltName(e)
;n.push(s)}else{if("certificatepolicies"!=r)throw new Error("unsupported extension name: "+t);s=new i.CertificatePolicies(e);n.push(s)}},ht.asn1.x509.KeyUsage=function(t){
ht.asn1.x509.KeyUsage.superclass.constructor.call(this,t);var e=Wt.KEYUSAGE_NAME;if(this.getExtnValueHex=function(){return this.asn1ExtnValue.getEncodedHex()},this.oid="2.5.29.15",
void 0!==t&&(void 0!==t.bin&&(this.asn1ExtnValue=new ht.asn1.DERBitString(t)),void 0!==t.names&&void 0!==t.names.length)){
for(var n=t.names,r="000000000",i=0;i<n.length;i++)for(var s=0;s<e.length;s++)n[i]===e[s]&&(r=r.substring(0,s)+"1"+r.substring(s+1,r.length));this.asn1ExtnValue=new ht.asn1.DERBitString({bin:r})}},
s.lang.extend(ht.asn1.x509.KeyUsage,ht.asn1.x509.Extension),ht.asn1.x509.BasicConstraints=function(t){ht.asn1.x509.BasicConstraints.superclass.constructor.call(this,t);this.getExtnValueHex=function(){
var t=new Array;this.cA&&t.push(new ht.asn1.DERBoolean),this.pathLen>-1&&t.push(new ht.asn1.DERInteger({int:this.pathLen}));var e=new ht.asn1.DERSequence({array:t});return this.asn1ExtnValue=e,
this.asn1ExtnValue.getEncodedHex()},this.oid="2.5.29.19",this.cA=!1,this.pathLen=-1,void 0!==t&&(void 0!==t.cA&&(this.cA=t.cA),void 0!==t.pathLen&&(this.pathLen=t.pathLen))},
s.lang.extend(ht.asn1.x509.BasicConstraints,ht.asn1.x509.Extension),ht.asn1.x509.CRLDistributionPoints=function(t){ht.asn1.x509.CRLDistributionPoints.superclass.constructor.call(this,t)
;var e=ht.asn1,n=e.x509;this.getExtnValueHex=function(){return this.asn1ExtnValue.getEncodedHex()},this.setByDPArray=function(t){this.asn1ExtnValue=new e.DERSequence({array:t})},
this.setByOneURI=function(t){var e=new n.GeneralNames([{uri:t}]),r=new n.DistributionPointName(e),i=new n.DistributionPoint({dpobj:r});this.setByDPArray([i])},this.oid="2.5.29.31",
void 0!==t&&(void 0!==t.array?this.setByDPArray(t.array):void 0!==t.uri&&this.setByOneURI(t.uri))},s.lang.extend(ht.asn1.x509.CRLDistributionPoints,ht.asn1.x509.Extension),
ht.asn1.x509.CertificatePolicies=function(t){ht.asn1.x509.CertificatePolicies.superclass.constructor.call(this,t);var e=ht.asn1,n=e.x509,r=e.DERSequence,i=n.PolicyInformation;this.params=null,
this.getExtnValueHex=function(){for(var t=[],e=0;e<this.params.array.length;e++)t.push(new i(this.params.array[e]));var n=new r({array:t});return this.asn1ExtnValue=n,
this.asn1ExtnValue.getEncodedHex()},this.oid="2.5.29.32",void 0!==t&&(this.params=t)},s.lang.extend(ht.asn1.x509.CertificatePolicies,ht.asn1.x509.Extension),ht.asn1.x509.PolicyInformation=function(t){
ht.asn1.x509.PolicyInformation.superclass.constructor.call(this,t);var e=ht.asn1,n=e.DERSequence,r=e.DERObjectIdentifier,i=e.x509.PolicyQualifierInfo;this.params=null,this.getEncodedHex=function(){
if(void 0===this.params.policyoid&&void 0===this.params.array)throw new Error("parameter oid and array missing");var t=[new r({oid:this.params.policyoid})];if(void 0!==this.params.array){
for(var e=[],s=0;s<this.params.array.length;s++)e.push(new i(this.params.array[s]));e.length>0&&t.push(new n({array:e}))}return new n({array:t}).getEncodedHex()},void 0!==t&&(this.params=t)},
s.lang.extend(ht.asn1.x509.PolicyInformation,ht.asn1.ASN1Object),ht.asn1.x509.PolicyQualifierInfo=function(t){ht.asn1.x509.PolicyQualifierInfo.superclass.constructor.call(this,t)
;var e=ht.asn1,n=e.DERSequence,r=e.DERIA5String,i=e.DERObjectIdentifier,s=e.x509.UserNotice;this.params=null,this.getEncodedHex=function(){return void 0!==this.params.cps?new n({array:[new i({
oid:"1.3.6.1.5.5.7.2.1"}),new r({str:this.params.cps})]}).getEncodedHex():null!=this.params.unotice?new n({array:[new i({oid:"1.3.6.1.5.5.7.2.2"}),new s(this.params.unotice)]}).getEncodedHex():void 0
},void 0!==t&&(this.params=t)},s.lang.extend(ht.asn1.x509.PolicyQualifierInfo,ht.asn1.ASN1Object),ht.asn1.x509.UserNotice=function(t){ht.asn1.x509.UserNotice.superclass.constructor.call(this,t)
;var e=ht.asn1.DERSequence,n=(ht.asn1.DERInteger,ht.asn1.x509.DisplayText),r=ht.asn1.x509.NoticeReference;this.params=null,this.getEncodedHex=function(){var t=[]
;return void 0!==this.params.noticeref&&t.push(new r(this.params.noticeref)),void 0!==this.params.exptext&&t.push(new n(this.params.exptext)),new e({array:t}).getEncodedHex()},
void 0!==t&&(this.params=t)},s.lang.extend(ht.asn1.x509.UserNotice,ht.asn1.ASN1Object),ht.asn1.x509.NoticeReference=function(t){ht.asn1.x509.NoticeReference.superclass.constructor.call(this,t)
;var e=ht.asn1.DERSequence,n=ht.asn1.DERInteger,r=ht.asn1.x509.DisplayText;this.params=null,this.getEncodedHex=function(){var t=[];if(void 0!==this.params.org&&t.push(new r(this.params.org)),
void 0!==this.params.noticenum){for(var i=[],s=this.params.noticenum,o=0;o<s.length;o++)i.push(new n(s[o]));t.push(new e({array:i}))}if(0==t.length)throw new Error("parameter is empty");return new e({
array:t}).getEncodedHex()},void 0!==t&&(this.params=t)},s.lang.extend(ht.asn1.x509.NoticeReference,ht.asn1.ASN1Object),ht.asn1.x509.DisplayText=function(t){
ht.asn1.x509.DisplayText.superclass.constructor.call(this,t),this.hT="0c",void 0!==t&&("ia5"===t.type?this.hT="16":"vis"===t.type?this.hT="1a":"bmp"===t.type&&(this.hT="1e"))},
s.lang.extend(ht.asn1.x509.DisplayText,ht.asn1.DERAbstractString),ht.asn1.x509.ExtKeyUsage=function(t){ht.asn1.x509.ExtKeyUsage.superclass.constructor.call(this,t);var e=ht.asn1
;this.setPurposeArray=function(t){this.asn1ExtnValue=new e.DERSequence;for(var n=0;n<t.length;n++){var r=new e.DERObjectIdentifier(t[n]);this.asn1ExtnValue.appendASN1Object(r)}},
this.getExtnValueHex=function(){return this.asn1ExtnValue.getEncodedHex()},this.oid="2.5.29.37",void 0!==t&&void 0!==t.array&&this.setPurposeArray(t.array)},
s.lang.extend(ht.asn1.x509.ExtKeyUsage,ht.asn1.x509.Extension),ht.asn1.x509.AuthorityKeyIdentifier=function(t){ht.asn1.x509.AuthorityKeyIdentifier.superclass.constructor.call(this,t)
;var e=ht,r=e.asn1,i=r.DERTaggedObject,s=r.x509.GeneralNames;e.crypto.Util.isKey;this.asn1KID=null,this.asn1CertIssuer=null,this.asn1CertSN=null,this.getExtnValueHex=function(){var t=new Array
;this.asn1KID&&t.push(new i({explicit:!1,tag:"80",obj:this.asn1KID})),this.asn1CertIssuer&&t.push(new i({explicit:!1,tag:"a1",obj:new s([{dn:this.asn1CertIssuer}])})),this.asn1CertSN&&t.push(new i({
explicit:!1,tag:"82",obj:this.asn1CertSN}));var e=new r.DERSequence({array:t});return this.asn1ExtnValue=e,this.asn1ExtnValue.getEncodedHex()},this.setKIDByParam=function(t){
if(void 0!==t.str||void 0!==t.hex)this.asn1KID=new ht.asn1.DEROctetString(t);else if("object"===n(t)&&ht.crypto.Util.isKey(t)||"string"==typeof t&&-1!=t.indexOf("BEGIN ")){var e=t
;"string"==typeof t&&(e=Ut.getKey(t));var r=Ut.getKeyID(e);this.asn1KID=new ht.asn1.DEROctetString({hex:r})}},this.setCertIssuerByParam=function(t){
void 0!==t.str||void 0!==t.ldapstr||void 0!==t.hex||void 0!==t.certsubject||void 0!==t.certissuer?this.asn1CertIssuer=new ht.asn1.x509.X500Name(t):"string"==typeof t&&-1!=t.indexOf("BEGIN ")&&-1!=t.indexOf("CERTIFICATE")&&(this.asn1CertIssuer=new ht.asn1.x509.X500Name({
certissuer:t}))},this.setCertSNByParam=function(t){
if(void 0!==t.str||void 0!==t.bigint||void 0!==t.hex)this.asn1CertSN=new ht.asn1.DERInteger(t);else if("string"==typeof t&&-1!=t.indexOf("BEGIN ")&&t.indexOf("CERTIFICATE")){var e=new Wt
;e.readCertPEM(t);var n=e.getSerialNumberHex();this.asn1CertSN=new ht.asn1.DERInteger({hex:n})}},this.oid="2.5.29.35",void 0!==t&&(void 0!==t.kid&&this.setKIDByParam(t.kid),
void 0!==t.issuer&&this.setCertIssuerByParam(t.issuer),void 0!==t.sn&&this.setCertSNByParam(t.sn),
void 0!==t.issuersn&&"string"==typeof t.issuersn&&-1!=t.issuersn.indexOf("BEGIN ")&&t.issuersn.indexOf("CERTIFICATE")&&(this.setCertSNByParam(t.issuersn),this.setCertIssuerByParam(t.issuersn)))},
s.lang.extend(ht.asn1.x509.AuthorityKeyIdentifier,ht.asn1.x509.Extension),ht.asn1.x509.SubjectKeyIdentifier=function(t){ht.asn1.x509.SubjectKeyIdentifier.superclass.constructor.call(this,t)
;var e=ht.asn1.DEROctetString;this.asn1KID=null,this.getExtnValueHex=function(){return this.asn1ExtnValue=this.asn1KID,this.asn1ExtnValue.getEncodedHex()},this.setKIDByParam=function(t){
if(void 0!==t.str||void 0!==t.hex)this.asn1KID=new e(t);else if("object"===n(t)&&ht.crypto.Util.isKey(t)||"string"==typeof t&&-1!=t.indexOf("BEGIN")){var r=t;"string"==typeof t&&(r=Ut.getKey(t))
;var i=Ut.getKeyID(r);this.asn1KID=new ht.asn1.DEROctetString({hex:i})}},this.oid="2.5.29.14",void 0!==t&&void 0!==t.kid&&this.setKIDByParam(t.kid)},
s.lang.extend(ht.asn1.x509.SubjectKeyIdentifier,ht.asn1.x509.Extension),ht.asn1.x509.AuthorityInfoAccess=function(t){ht.asn1.x509.AuthorityInfoAccess.superclass.constructor.call(this,t),
this.setAccessDescriptionArray=function(t){for(var e=new Array,n=ht.asn1,r=n.DERSequence,i=0;i<t.length;i++){var s=new r({
array:[new n.DERObjectIdentifier(t[i].accessMethod),new n.x509.GeneralName(t[i].accessLocation)]});e.push(s)}this.asn1ExtnValue=new r({array:e})},this.getExtnValueHex=function(){
return this.asn1ExtnValue.getEncodedHex()},this.oid="1.3.6.1.5.5.7.1.1",void 0!==t&&void 0!==t.array&&this.setAccessDescriptionArray(t.array)},
s.lang.extend(ht.asn1.x509.AuthorityInfoAccess,ht.asn1.x509.Extension),ht.asn1.x509.SubjectAltName=function(t){ht.asn1.x509.SubjectAltName.superclass.constructor.call(this,t),
this.setNameArray=function(t){this.asn1ExtnValue=new ht.asn1.x509.GeneralNames(t)},this.getExtnValueHex=function(){return this.asn1ExtnValue.getEncodedHex()},this.oid="2.5.29.17",
void 0!==t&&void 0!==t.array&&this.setNameArray(t.array)},s.lang.extend(ht.asn1.x509.SubjectAltName,ht.asn1.x509.Extension),ht.asn1.x509.IssuerAltName=function(t){
ht.asn1.x509.IssuerAltName.superclass.constructor.call(this,t),this.setNameArray=function(t){this.asn1ExtnValue=new ht.asn1.x509.GeneralNames(t)},this.getExtnValueHex=function(){
return this.asn1ExtnValue.getEncodedHex()},this.oid="2.5.29.18",void 0!==t&&void 0!==t.array&&this.setNameArray(t.array)},s.lang.extend(ht.asn1.x509.IssuerAltName,ht.asn1.x509.Extension),
ht.asn1.x509.CRL=function(t){ht.asn1.x509.CRL.superclass.constructor.call(this);this.sign=function(){this.asn1SignatureAlg=this.asn1TBSCertList.asn1SignatureAlg,sig=new ht.crypto.Signature({
alg:this.asn1SignatureAlg.nameAlg,prov:"cryptojs/jsrsa"}),sig.init(this.prvKey),sig.updateHex(this.asn1TBSCertList.getEncodedHex()),this.hexSig=sig.sign(),this.asn1Sig=new ht.asn1.DERBitString({
hex:"00"+this.hexSig});var t=new ht.asn1.DERSequence({array:[this.asn1TBSCertList,this.asn1SignatureAlg,this.asn1Sig]});this.hTLV=t.getEncodedHex(),this.isModified=!1},this.getEncodedHex=function(){
if(0==this.isModified&&null!=this.hTLV)return this.hTLV;throw"not signed yet"},this.getPEMString=function(){
return"-----BEGIN X509 CRL-----\r\n"+Ct(this.getEncodedHex())+"\r\n-----END X509 CRL-----\r\n"},void 0!==t&&(void 0!==t.tbsobj&&(this.asn1TBSCertList=t.tbsobj),
void 0!==t.prvkeyobj&&(this.prvKey=t.prvkeyobj))},s.lang.extend(ht.asn1.x509.CRL,ht.asn1.ASN1Object),ht.asn1.x509.TBSCertList=function(t){ht.asn1.x509.TBSCertList.superclass.constructor.call(this)
;var e=ht.asn1,n=e.DERSequence,r=e.x509,i=r.Time;this.setSignatureAlgByParam=function(t){this.asn1SignatureAlg=new r.AlgorithmIdentifier(t)},this.setIssuerByParam=function(t){
this.asn1Issuer=new r.X500Name(t)},this.setThisUpdateByParam=function(t){this.asn1ThisUpdate=new i(t)},this.setNextUpdateByParam=function(t){this.asn1NextUpdate=new i(t)},
this.addRevokedCert=function(t,e){var n={};null!=t&&null!=t&&(n.sn=t),null!=e&&null!=e&&(n.time=e);var i=new r.CRLEntry(n);this.aRevokedCert.push(i)},this.getEncodedHex=function(){
if(this.asn1Array=new Array,null!=this.asn1Version&&this.asn1Array.push(this.asn1Version),this.asn1Array.push(this.asn1SignatureAlg),this.asn1Array.push(this.asn1Issuer),
this.asn1Array.push(this.asn1ThisUpdate),null!=this.asn1NextUpdate&&this.asn1Array.push(this.asn1NextUpdate),this.aRevokedCert.length>0){var t=new n({array:this.aRevokedCert});this.asn1Array.push(t)}
var e=new n({array:this.asn1Array});return this.hTLV=e.getEncodedHex(),this.isModified=!1,this.hTLV},this._initialize=function(){this.asn1Version=null,this.asn1SignatureAlg=null,this.asn1Issuer=null,
this.asn1ThisUpdate=null,this.asn1NextUpdate=null,this.aRevokedCert=new Array},this._initialize()},s.lang.extend(ht.asn1.x509.TBSCertList,ht.asn1.ASN1Object),ht.asn1.x509.CRLEntry=function(t){
ht.asn1.x509.CRLEntry.superclass.constructor.call(this);var e=ht.asn1;this.setCertSerial=function(t){this.sn=new e.DERInteger(t)},this.setRevocationDate=function(t){this.time=new e.x509.Time(t)},
this.getEncodedHex=function(){var t=new e.DERSequence({array:[this.sn,this.time]});return this.TLV=t.getEncodedHex(),this.TLV},void 0!==t&&(void 0!==t.time&&this.setRevocationDate(t.time),
void 0!==t.sn&&this.setCertSerial(t.sn))},s.lang.extend(ht.asn1.x509.CRLEntry,ht.asn1.ASN1Object),ht.asn1.x509.X500Name=function(t){ht.asn1.x509.X500Name.superclass.constructor.call(this),
this.asn1Array=new Array;var e,r=ht.asn1,i=r.x509;(this.setByString=function(t){var e=t.split("/");e.shift();for(var n=[],r=0;r<e.length;r++)if(e[r].match(/^[^=]+=.+$/))n.push(e[r]);else{
var s=n.length-1;n[s]=n[s]+"/"+e[r]}for(r=0;r<n.length;r++)this.asn1Array.push(new i.RDN({str:n[r]}))},this.setByLdapString=function(t){var e=i.X500Name.ldapToCompat(t);this.setByString(e)},
this.setByObject=function(t){for(var e in t)if(t.hasOwnProperty(e)){var n=new ht.asn1.x509.RDN({str:e+"="+t[e]});this.asn1Array?this.asn1Array.push(n):this.asn1Array=[n]}},
this.getEncodedHex=function(){if("string"==typeof this.hTLV)return this.hTLV;var t=new r.DERSequence({array:this.asn1Array});return this.hTLV=t.getEncodedHex(),this.hTLV},
void 0!==t)&&(void 0!==t.str?this.setByString(t.str):void 0!==t.ldapstr?this.setByLdapString(t.ldapstr):void 0!==t.hex?this.hTLV=t.hex:void 0!==t.certissuer?((e=new Wt).readCertPEM(t.certissuer),
this.hTLV=e.getIssuerHex()):void 0!==t.certsubject?((e=new Wt).readCertPEM(t.certsubject),
this.hTLV=e.getSubjectHex()):"object"===n(t)&&void 0===t.certsubject&&void 0===t.certissuer&&this.setByObject(t))},s.lang.extend(ht.asn1.x509.X500Name,ht.asn1.ASN1Object),
ht.asn1.x509.X500Name.compatToLDAP=function(t){if("/"!==t.substr(0,1))throw"malformed input";var e=(t=t.substr(1)).split("/");return e.reverse(),(e=e.map((function(t){return t.replace(/,/,"\\,")
}))).join(",")},ht.asn1.x509.X500Name.onelineToLDAP=function(t){return ht.asn1.x509.X500Name.compatToLDAP(t)},ht.asn1.x509.X500Name.ldapToCompat=function(t){
for(var e=t.split(","),n=!1,r=[],i=0;e.length>0;i++){var s=e.shift();if(!0===n){var o=(r.pop()+","+s).replace(/\\,/g,",");r.push(o),n=!1}else r.push(s);"\\"===s.substr(-1,1)&&(n=!0)}
return(r=r.map((function(t){return t.replace("/","\\/")}))).reverse(),"/"+r.join("/")},ht.asn1.x509.X500Name.ldapToOneline=function(t){return ht.asn1.x509.X500Name.ldapToCompat(t)},
ht.asn1.x509.RDN=function(t){ht.asn1.x509.RDN.superclass.constructor.call(this),this.asn1Array=new Array,this.addByString=function(t){this.asn1Array.push(new ht.asn1.x509.AttributeTypeAndValue({str:t
}))},this.addByMultiValuedString=function(t){for(var e=ht.asn1.x509.RDN.parseString(t),n=0;n<e.length;n++)this.addByString(e[n])},this.getEncodedHex=function(){var t=new ht.asn1.DERSet({
array:this.asn1Array});return this.TLV=t.getEncodedHex(),this.TLV},void 0!==t&&void 0!==t.str&&this.addByMultiValuedString(t.str)},s.lang.extend(ht.asn1.x509.RDN,ht.asn1.ASN1Object),
ht.asn1.x509.RDN.parseString=function(t){for(var e=t.split(/\+/),n=!1,r=[],i=0;e.length>0;i++){var s=e.shift();if(!0===n){var o=(r.pop()+"+"+s).replace(/\\\+/g,"+");r.push(o),n=!1}else r.push(s)
;"\\"===s.substr(-1,1)&&(n=!0)}var a=!1,u=[];for(i=0;r.length>0;i++){s=r.shift();if(!0===a){var c=u.pop();if(s.match(/"$/)){o=(c+"+"+s).replace(/^([^=]+)="(.*)"$/,"$1=$2");u.push(o),a=!1
}else u.push(c+"+"+s)}else u.push(s);s.match(/^[^=]+="/)&&(a=!0)}return u},ht.asn1.x509.AttributeTypeAndValue=function(t){ht.asn1.x509.AttributeTypeAndValue.superclass.constructor.call(this)
;var e=ht.asn1;this.setByString=function(t){var e=t.match(/^([^=]+)=(.+)$/);if(!e)throw"malformed attrTypeAndValueStr: "+t;this.setByAttrTypeAndValueStr(e[1],e[2])},
this.setByAttrTypeAndValueStr=function(t,e){this.typeObj=ht.asn1.x509.OID.atype2obj(t);var n="utf8";"C"==t&&(n="prn"),this.valueObj=this.getValueObj(n,e)},this.getValueObj=function(t,n){
if("utf8"==t)return new e.DERUTF8String({str:n});if("prn"==t)return new e.DERPrintableString({str:n});if("tel"==t)return new e.DERTeletexString({str:n});if("ia5"==t)return new e.DERIA5String({str:n})
;throw"unsupported directory string type: type="+t+" value="+n},this.getEncodedHex=function(){var t=new e.DERSequence({array:[this.typeObj,this.valueObj]});return this.TLV=t.getEncodedHex(),this.TLV},
void 0!==t&&void 0!==t.str&&this.setByString(t.str)},s.lang.extend(ht.asn1.x509.AttributeTypeAndValue,ht.asn1.ASN1Object),ht.asn1.x509.SubjectPublicKeyInfo=function(t){
ht.asn1.x509.SubjectPublicKeyInfo.superclass.constructor.call(this)
;var e=ht,n=e.asn1,r=n.DERInteger,i=n.DERBitString,s=n.DERObjectIdentifier,o=n.DERSequence,a=n.ASN1Util.newObject,u=n.x509.AlgorithmIdentifier,c=e.crypto;c.ECDSA,c.DSA;this.getASN1Object=function(){
if(null==this.asn1AlgId||null==this.asn1SubjPKey)throw"algId and/or subjPubKey not set";return new o({array:[this.asn1AlgId,this.asn1SubjPKey]})},this.getEncodedHex=function(){
var t=this.getASN1Object();return this.hTLV=t.getEncodedHex(),this.hTLV},this.setPubKey=function(t){try{if(t instanceof it){var e=a({seq:[{int:{bigint:t.n}},{int:{int:t.e}}]}).getEncodedHex()
;this.asn1AlgId=new u({name:"rsaEncryption"}),this.asn1SubjPKey=new i({hex:"00"+e})}}catch(t){}try{if(t instanceof ht.crypto.ECDSA){var n=new s({name:t.curveName});this.asn1AlgId=new u({
name:"ecPublicKey",asn1params:n}),this.asn1SubjPKey=new i({hex:"00"+t.pubKeyHex})}}catch(t){}try{if(t instanceof ht.crypto.DSA){n=new a({seq:[{int:{bigint:t.p}},{int:{bigint:t.q}},{int:{bigint:t.g}}]
});this.asn1AlgId=new u({name:"dsa",asn1params:n});var o=new r({bigint:t.y});this.asn1SubjPKey=new i({hex:"00"+o.getEncodedHex()})}}catch(t){}},void 0!==t&&this.setPubKey(t)},
s.lang.extend(ht.asn1.x509.SubjectPublicKeyInfo,ht.asn1.ASN1Object),ht.asn1.x509.Time=function(t){ht.asn1.x509.Time.superclass.constructor.call(this)
;var e=ht.asn1,n=e.DERUTCTime,r=e.DERGeneralizedTime;this.setTimeParams=function(t){this.timeParams=t},this.getEncodedHex=function(){var t=null
;return t=null!=this.timeParams?"utc"==this.type?new n(this.timeParams):new r(this.timeParams):"utc"==this.type?new n:new r,this.TLV=t.getEncodedHex(),this.TLV},this.type="utc",
void 0!==t&&(void 0!==t.type?this.type=t.type:void 0!==t.str&&(t.str.match(/^[0-9]{12}Z$/)&&(this.type="utc"),t.str.match(/^[0-9]{14}Z$/)&&(this.type="gen")),this.timeParams=t)},
s.lang.extend(ht.asn1.x509.Time,ht.asn1.ASN1Object),ht.asn1.x509.AlgorithmIdentifier=function(t){ht.asn1.x509.AlgorithmIdentifier.superclass.constructor.call(this),this.nameAlg=null,this.asn1Alg=null,
this.asn1Params=null,this.paramEmpty=!1;var e=ht.asn1,n=e.x509.AlgorithmIdentifier.PSSNAME2ASN1TLV;if(this.getEncodedHex=function(){
if(null===this.nameAlg&&null===this.asn1Alg)throw new Error("algorithm not specified");if(null!==this.nameAlg){var t=null;for(var r in n)r===this.nameAlg&&(t=n[r]);if(null!==t)return this.hTLV=t,
this.hTLV}null!==this.nameAlg&&null===this.asn1Alg&&(this.asn1Alg=e.x509.OID.name2obj(this.nameAlg));var i=[this.asn1Alg];null!==this.asn1Params&&i.push(this.asn1Params);var s=new e.DERSequence({
array:i});return this.hTLV=s.getEncodedHex(),this.hTLV},void 0!==t&&(void 0!==t.name&&(this.nameAlg=t.name),void 0!==t.asn1params&&(this.asn1Params=t.asn1params),
void 0!==t.paramempty&&(this.paramEmpty=t.paramempty)),null===this.asn1Params&&!1===this.paramEmpty&&null!==this.nameAlg){var r=this.nameAlg.toLowerCase()
;"withdsa"!==r.substr(-7,7)&&"withecdsa"!==r.substr(-9,9)&&(this.asn1Params=new e.DERNull)}},s.lang.extend(ht.asn1.x509.AlgorithmIdentifier,ht.asn1.ASN1Object),
ht.asn1.x509.AlgorithmIdentifier.PSSNAME2ASN1TLV={SHAwithRSAandMGF1:"300d06092a864886f70d01010a3000",
SHA256withRSAandMGF1:"303d06092a864886f70d01010a3030a00d300b0609608648016503040201a11a301806092a864886f70d010108300b0609608648016503040201a203020120",
SHA384withRSAandMGF1:"303d06092a864886f70d01010a3030a00d300b0609608648016503040202a11a301806092a864886f70d010108300b0609608648016503040202a203020130",
SHA512withRSAandMGF1:"303d06092a864886f70d01010a3030a00d300b0609608648016503040203a11a301806092a864886f70d010108300b0609608648016503040203a203020140"},ht.asn1.x509.GeneralName=function(t){
ht.asn1.x509.GeneralName.superclass.constructor.call(this);var e={rfc822:"81",dns:"82",dn:"a4",uri:"86",ip:"87"},n=ht.asn1,r=(n.DERSequence,
n.DEROctetString),i=n.DERIA5String,s=n.DERTaggedObject,o=n.ASN1Object,a=n.x509.X500Name,u=Pt;this.explicit=!1,this.setByParam=function(t){var n=null;if(void 0!==t){
if(void 0!==t.rfc822&&(this.type="rfc822",n=new i({str:t[this.type]})),void 0!==t.dns&&(this.type="dns",n=new i({str:t[this.type]})),void 0!==t.uri&&(this.type="uri",n=new i({str:t[this.type]})),
void 0!==t.dn&&(this.type="dn",this.explicit=!0,n="string"==typeof t.dn?new a({str:t.dn}):t.dn instanceof ht.asn1.x509.X500Name?t.dn:new a(t.dn)),void 0!==t.ldapdn&&(this.type="dn",this.explicit=!0,
n=new a({ldapstr:t.ldapdn})),void 0!==t.certissuer){this.type="dn",this.explicit=!0;var c=null;if((l=t.certissuer).match(/^[0-9A-Fa-f]+$/),-1!=l.indexOf("-----BEGIN ")&&(c=u(l)),
null==c)throw"certissuer param not cert";(f=new Wt).hex=c;var h=f.getIssuerHex();(n=new o).hTLV=h}if(void 0!==t.certsubj){this.type="dn",this.explicit=!0;var l,f;c=null
;if((l=t.certsubj).match(/^[0-9A-Fa-f]+$/),-1!=l.indexOf("-----BEGIN ")&&(c=u(l)),null==c)throw"certsubj param not cert";(f=new Wt).hex=c;h=f.getSubjectHex();(n=new o).hTLV=h}if(void 0!==t.ip){
this.type="ip",this.explicit=!1;var d,p=t.ip,g="malformed IP address";if(p.match(/^[0-9.]+[.][0-9.]+$/)){if(8!==(d=Vt("["+p.split(".").join(",")+"]")).length)throw g
}else if(p.match(/^[0-9A-Fa-f:]+:[0-9A-Fa-f:]+$/))d=Nt(p);else{if(!p.match(/^([0-9A-Fa-f][0-9A-Fa-f]){1,}$/))throw g;d=p}n=new r({hex:d})}if(null==this.type)throw"unsupported type in params="+t
;this.asn1Obj=new s({explicit:this.explicit,tag:e[this.type],obj:n})}},this.getEncodedHex=function(){return this.asn1Obj.getEncodedHex()},void 0!==t&&this.setByParam(t)},
s.lang.extend(ht.asn1.x509.GeneralName,ht.asn1.ASN1Object),ht.asn1.x509.GeneralNames=function(t){ht.asn1.x509.GeneralNames.superclass.constructor.call(this);var e=ht.asn1
;this.setByParamArray=function(t){for(var n=0;n<t.length;n++){var r=new e.x509.GeneralName(t[n]);this.asn1Array.push(r)}},this.getEncodedHex=function(){return new e.DERSequence({array:this.asn1Array
}).getEncodedHex()},this.asn1Array=new Array,void 0!==t&&this.setByParamArray(t)},s.lang.extend(ht.asn1.x509.GeneralNames,ht.asn1.ASN1Object),ht.asn1.x509.DistributionPointName=function(t){
ht.asn1.x509.DistributionPointName.superclass.constructor.call(this);var e=ht.asn1,n=e.DERTaggedObject;if(this.getEncodedHex=function(){
if("full"!=this.type)throw"currently type shall be 'full': "+this.type;return this.asn1Obj=new n({explicit:!1,tag:this.tag,obj:this.asn1V}),this.hTLV=this.asn1Obj.getEncodedHex(),this.hTLV},
void 0!==t){if(!e.x509.GeneralNames.prototype.isPrototypeOf(t))throw"This class supports GeneralNames only as argument";this.type="full",this.tag="a0",this.asn1V=t}},
s.lang.extend(ht.asn1.x509.DistributionPointName,ht.asn1.ASN1Object),ht.asn1.x509.DistributionPoint=function(t){ht.asn1.x509.DistributionPoint.superclass.constructor.call(this);var e=ht.asn1
;this.getEncodedHex=function(){var t=new e.DERSequence;if(null!=this.asn1DP){var n=new e.DERTaggedObject({explicit:!0,tag:"a0",obj:this.asn1DP});t.appendASN1Object(n)}
return this.hTLV=t.getEncodedHex(),this.hTLV},void 0!==t&&void 0!==t.dpobj&&(this.asn1DP=t.dpobj)},s.lang.extend(ht.asn1.x509.DistributionPoint,ht.asn1.ASN1Object),ht.asn1.x509.OID=new function(t){
this.atype2oidList={CN:"2.5.4.3",L:"2.5.4.7",ST:"2.5.4.8",O:"2.5.4.10",OU:"2.5.4.11",C:"2.5.4.6",STREET:"2.5.4.9",DC:"0.9.2342.19200300.100.1.25",UID:"0.9.2342.19200300.100.1.1",SN:"2.5.4.4",
T:"2.5.4.12",DN:"2.5.4.49",E:"1.2.840.113549.1.9.1",description:"2.5.4.13",businessCategory:"2.5.4.15",postalCode:"2.5.4.17",serialNumber:"2.5.4.5",uniqueIdentifier:"2.5.4.45",
organizationIdentifier:"2.5.4.97",jurisdictionOfIncorporationL:"1.3.6.1.4.1.311.60.2.1.1",jurisdictionOfIncorporationSP:"1.3.6.1.4.1.311.60.2.1.2",
jurisdictionOfIncorporationC:"1.3.6.1.4.1.311.60.2.1.3"},this.name2oidList={sha1:"1.3.14.3.2.26",sha256:"2.16.840.1.101.3.4.2.1",sha384:"2.16.840.1.101.3.4.2.2",sha512:"2.16.840.1.101.3.4.2.3",
sha224:"2.16.840.1.101.3.4.2.4",md5:"1.2.840.113549.2.5",md2:"1.3.14.7.2.2.1",ripemd160:"1.3.36.3.2.1",MD2withRSA:"1.2.840.113549.1.1.2",MD4withRSA:"1.2.840.113549.1.1.3",
MD5withRSA:"1.2.840.113549.1.1.4",SHA1withRSA:"1.2.840.113549.1.1.5",SHA224withRSA:"1.2.840.113549.1.1.14",SHA256withRSA:"1.2.840.113549.1.1.11",SHA384withRSA:"1.2.840.113549.1.1.12",
SHA512withRSA:"1.2.840.113549.1.1.13",SHA1withECDSA:"1.2.840.10045.4.1",SHA224withECDSA:"1.2.840.10045.4.3.1",SHA256withECDSA:"1.2.840.10045.4.3.2",SHA384withECDSA:"1.2.840.10045.4.3.3",
SHA512withECDSA:"1.2.840.10045.4.3.4",dsa:"1.2.840.10040.4.1",SHA1withDSA:"1.2.840.10040.4.3",SHA224withDSA:"2.16.840.1.101.3.4.3.1",SHA256withDSA:"2.16.840.1.101.3.4.3.2",
rsaEncryption:"1.2.840.113549.1.1.1",commonName:"2.5.4.3",countryName:"2.5.4.6",localityName:"2.5.4.7",stateOrProvinceName:"2.5.4.8",streetAddress:"2.5.4.9",organizationName:"2.5.4.10",
organizationalUnitName:"2.5.4.11",domainComponent:"0.9.2342.19200300.100.1.25",userId:"0.9.2342.19200300.100.1.1",surname:"2.5.4.4",title:"2.5.4.12",distinguishedName:"2.5.4.49",
emailAddress:"1.2.840.113549.1.9.1",description:"2.5.4.13",businessCategory:"2.5.4.15",postalCode:"2.5.4.17",uniqueIdentifier:"2.5.4.45",organizationIdentifier:"2.5.4.97",
jurisdictionOfIncorporationL:"1.3.6.1.4.1.311.60.2.1.1",jurisdictionOfIncorporationSP:"1.3.6.1.4.1.311.60.2.1.2",jurisdictionOfIncorporationC:"1.3.6.1.4.1.311.60.2.1.3",
subjectKeyIdentifier:"2.5.29.14",keyUsage:"2.5.29.15",subjectAltName:"2.5.29.17",issuerAltName:"2.5.29.18",basicConstraints:"2.5.29.19",nameConstraints:"2.5.29.30",cRLDistributionPoints:"2.5.29.31",
certificatePolicies:"2.5.29.32",authorityKeyIdentifier:"2.5.29.35",policyConstraints:"2.5.29.36",extKeyUsage:"2.5.29.37",authorityInfoAccess:"1.3.6.1.5.5.7.1.1",ocsp:"1.3.6.1.5.5.7.48.1",
caIssuers:"1.3.6.1.5.5.7.48.2",anyExtendedKeyUsage:"2.5.29.37.0",serverAuth:"1.3.6.1.5.5.7.3.1",clientAuth:"1.3.6.1.5.5.7.3.2",codeSigning:"1.3.6.1.5.5.7.3.3",emailProtection:"1.3.6.1.5.5.7.3.4",
timeStamping:"1.3.6.1.5.5.7.3.8",ocspSigning:"1.3.6.1.5.5.7.3.9",ecPublicKey:"1.2.840.10045.2.1",secp256r1:"1.2.840.10045.3.1.7",secp256k1:"1.3.132.0.10",secp384r1:"1.3.132.0.34",
pkcs5PBES2:"1.2.840.113549.1.5.13",pkcs5PBKDF2:"1.2.840.113549.1.5.12","des-EDE3-CBC":"1.2.840.113549.3.7",data:"1.2.840.113549.1.7.1","signed-data":"1.2.840.113549.1.7.2",
"enveloped-data":"1.2.840.113549.1.7.3","digested-data":"1.2.840.113549.1.7.5","encrypted-data":"1.2.840.113549.1.7.6","authenticated-data":"1.2.840.113549.1.9.16.1.2",
tstinfo:"1.2.840.113549.1.9.16.1.4",extensionRequest:"1.2.840.113549.1.9.14"},this.objCache={},this.name2obj=function(t){if(void 0!==this.objCache[t])return this.objCache[t]
;if(void 0===this.name2oidList[t])throw"Name of ObjectIdentifier not defined: "+t;var e=this.name2oidList[t],n=new ht.asn1.DERObjectIdentifier({oid:e});return this.objCache[t]=n,n},
this.atype2obj=function(t){if(void 0!==this.objCache[t])return this.objCache[t];if(void 0===this.atype2oidList[t])throw"AttributeType name undefined: "+t
;var e=this.atype2oidList[t],n=new ht.asn1.DERObjectIdentifier({oid:e});return this.objCache[t]=n,n}},ht.asn1.x509.OID.oid2name=function(t){var e=ht.asn1.x509.OID.name2oidList
;for(var n in e)if(e[n]==t)return n;return""},ht.asn1.x509.OID.oid2atype=function(t){var e=ht.asn1.x509.OID.atype2oidList;for(var n in e)if(e[n]==t)return n;return t},
ht.asn1.x509.OID.name2oid=function(t){var e=ht.asn1.x509.OID.name2oidList;return void 0===e[t]?"":e[t]},ht.asn1.x509.X509Util={},ht.asn1.x509.X509Util.newCertPEM=function(t){
var e=ht.asn1.x509,n=e.TBSCertificate,r=e.Certificate,i=new n;if(void 0===t.serial)throw"serial number undefined.";if(i.setSerialNumberByParam(t.serial),
"string"!=typeof t.sigalg.name)throw"unproper signature algorithm name";if(i.setSignatureAlgByParam(t.sigalg),void 0===t.issuer)throw"issuer name undefined.";if(i.setIssuerByParam(t.issuer),
void 0===t.notbefore)throw"notbefore undefined.";if(i.setNotBeforeByParam(t.notbefore),void 0===t.notafter)throw"notafter undefined.";if(i.setNotAfterByParam(t.notafter),
void 0===t.subject)throw"subject name undefined.";if(i.setSubjectByParam(t.subject),void 0===t.sbjpubkey)throw"subject public key undefined.";if(i.setSubjectPublicKeyByGetKey(t.sbjpubkey),
void 0!==t.ext&&void 0!==t.ext.length)for(var s=0;s<t.ext.length;s++)for(key in t.ext[s])i.appendExtensionByName(key,t.ext[s][key])
;if(void 0===t.cakey&&void 0===t.sighex)throw"param cakey and sighex undefined.";var o=null;return t.cakey&&(o=new r({tbscertobj:i,
prvkeyobj:!0===t.cakey.isPrivate?t.cakey:Ut.getKey.apply(null,t.cakey)})).sign(),t.sighex&&(o=new r({tbscertobj:i})).setSignatureHex(t.sighex),o.getPEMString()},void 0!==ht&&ht||(ht={}),
void 0!==ht.asn1&&ht.asn1||(ht.asn1={}),void 0!==ht.asn1.cms&&ht.asn1.cms||(ht.asn1.cms={}),ht.asn1.cms.Attribute=function(t){var e=ht.asn1;e.cms.Attribute.superclass.constructor.call(this),
this.getEncodedHex=function(){var t,n,r;t=new e.DERObjectIdentifier({oid:this.attrTypeOid}),n=new e.DERSet({array:this.valueList});try{n.getEncodedHex()}catch(t){
throw"fail valueSet.getEncodedHex in Attribute(1)/"+t}r=new e.DERSequence({array:[t,n]});try{this.hTLV=r.getEncodedHex()}catch(t){throw"failed seq.getEncodedHex in Attribute(2)/"+t}return this.hTLV}},
s.lang.extend(ht.asn1.cms.Attribute,ht.asn1.ASN1Object),ht.asn1.cms.ContentType=function(t){var e=ht.asn1;e.cms.ContentType.superclass.constructor.call(this),this.attrTypeOid="1.2.840.113549.1.9.3"
;var n=null;if(void 0!==t){n=new e.DERObjectIdentifier(t);this.valueList=[n]}},s.lang.extend(ht.asn1.cms.ContentType,ht.asn1.cms.Attribute),ht.asn1.cms.MessageDigest=function(t){
var e=ht,n=e.asn1,r=n.DEROctetString,i=n.cms;if(i.MessageDigest.superclass.constructor.call(this),this.attrTypeOid="1.2.840.113549.1.9.4",
void 0!==t)if(t.eciObj instanceof i.EncapsulatedContentInfo&&"string"==typeof t.hashAlg){var s=t.eciObj.eContentValueHex,o=t.hashAlg;(a=new r({hex:e.crypto.Util.hashHex(s,o)})).getEncodedHex(),
this.valueList=[a]}else{var a;(a=new r(t)).getEncodedHex(),this.valueList=[a]}},s.lang.extend(ht.asn1.cms.MessageDigest,ht.asn1.cms.Attribute),ht.asn1.cms.SigningTime=function(t){var e=ht.asn1
;if(e.cms.SigningTime.superclass.constructor.call(this),this.attrTypeOid="1.2.840.113549.1.9.5",void 0!==t){var n=new e.x509.Time(t);try{n.getEncodedHex()}catch(t){
throw"SigningTime.getEncodedHex() failed/"+t}this.valueList=[n]}},s.lang.extend(ht.asn1.cms.SigningTime,ht.asn1.cms.Attribute),ht.asn1.cms.SigningCertificate=function(t){
var e=ht,r=e.asn1,i=r.DERSequence,s=r.cms;e.crypto;s.SigningCertificate.superclass.constructor.call(this),this.attrTypeOid="1.2.840.113549.1.9.16.2.12",this.setCerts=function(t){
for(var n=[],o=0;o<t.length;o++){var a=Pt(t[o]),u=e.crypto.Util.hashHex(a,"sha1"),c=new r.DEROctetString({hex:u});c.getEncodedHex();var h=new s.IssuerSerial({cert:t[o]});h.getEncodedHex()
;var l=new i({array:[c,h]});l.getEncodedHex(),n.push(l)}var f=new i({array:n});f.getEncodedHex(),this.valueList=[f]},void 0!==t&&"object"==n(t.array)&&this.setCerts(t.array)},
s.lang.extend(ht.asn1.cms.SigningCertificate,ht.asn1.cms.Attribute),ht.asn1.cms.SigningCertificateV2=function(t){var e=ht,r=e.asn1,i=r.DERSequence,s=r.x509,o=r.cms,a=e.crypto
;if(o.SigningCertificateV2.superclass.constructor.call(this),this.attrTypeOid="1.2.840.113549.1.9.16.2.47",this.setCerts=function(t,e){for(var n=[],u=0;u<t.length;u++){var c=Pt(t[u]),h=[]
;"sha256"!==e&&h.push(new s.AlgorithmIdentifier({name:e}));var l=a.Util.hashHex(c,e),f=new r.DEROctetString({hex:l});f.getEncodedHex(),h.push(f);var d=new o.IssuerSerial({cert:t[u]})
;d.getEncodedHex(),h.push(d);var p=new i({array:h});p.getEncodedHex(),n.push(p)}var g=new i({array:n});g.getEncodedHex(),this.valueList=[g]},void 0!==t&&"object"==n(t.array)){var u="sha256"
;"string"==typeof t.hashAlg&&(u=t.hashAlg),this.setCerts(t.array,u)}},s.lang.extend(ht.asn1.cms.SigningCertificateV2,ht.asn1.cms.Attribute),ht.asn1.cms.IssuerSerial=function(t){
var e=ht.asn1,n=e.DERInteger,r=e.cms,i=e.x509,s=i.X500Name,o=i.GeneralNames,a=Wt;r.IssuerSerial.superclass.constructor.call(this);this.setByCertPEM=function(t){var e=Pt(t),r=new a;r.hex=e
;var i=r.getIssuerHex();this.dIssuer=new s,this.dIssuer.hTLV=i;var o=r.getSerialNumberHex();this.dSerial=new n({hex:o})},this.getEncodedHex=function(){var t=new o([{dn:this.dIssuer
}]),n=new e.DERSequence({array:[t,this.dSerial]});return this.hTLV=n.getEncodedHex(),this.hTLV},void 0!==t&&("string"==typeof t&&-1!=t.indexOf("-----BEGIN ")&&this.setByCertPEM(t),
t.issuer&&t.serial&&(t.issuer instanceof s?this.dIssuer=t.issuer:this.dIssuer=new s(t.issuer),t.serial instanceof n?this.dSerial=t.serial:this.dSerial=new n(t.serial)),
"string"==typeof t.cert&&this.setByCertPEM(t.cert))},s.lang.extend(ht.asn1.cms.IssuerSerial,ht.asn1.ASN1Object),ht.asn1.cms.IssuerAndSerialNumber=function(t){
var e=ht.asn1,n=e.DERInteger,r=e.cms,i=e.x509.X500Name,s=Wt;r.IssuerAndSerialNumber.superclass.constructor.call(this);this.setByCertPEM=function(t){var e=Pt(t),r=new s;r.hex=e;var o=r.getIssuerHex()
;this.dIssuer=new i,this.dIssuer.hTLV=o;var a=r.getSerialNumberHex();this.dSerial=new n({hex:a})},this.getEncodedHex=function(){var t=new e.DERSequence({array:[this.dIssuer,this.dSerial]})
;return this.hTLV=t.getEncodedHex(),this.hTLV},void 0!==t&&("string"==typeof t&&-1!=t.indexOf("-----BEGIN ")&&this.setByCertPEM(t),
t.issuer&&t.serial&&(t.issuer instanceof i?this.dIssuer=t.issuer:this.dIssuer=new i(t.issuer),t.serial instanceof n?this.dSerial=t.serial:this.dSerial=new n(t.serial)),
"string"==typeof t.cert&&this.setByCertPEM(t.cert))},s.lang.extend(ht.asn1.cms.IssuerAndSerialNumber,ht.asn1.ASN1Object),ht.asn1.cms.AttributeList=function(t){var e=ht.asn1,n=e.cms
;n.AttributeList.superclass.constructor.call(this),this.list=new Array,this.sortFlag=!0,this.add=function(t){t instanceof n.Attribute&&this.list.push(t)},this.length=function(){return this.list.length
},this.clear=function(){this.list=new Array,this.hTLV=null,this.hV=null},this.getEncodedHex=function(){if("string"==typeof this.hTLV)return this.hTLV;var t=new e.DERSet({array:this.list,
sortflag:this.sortFlag});return this.hTLV=t.getEncodedHex(),this.hTLV},void 0!==t&&void 0!==t.sortflag&&0==t.sortflag&&(this.sortFlag=!1)},s.lang.extend(ht.asn1.cms.AttributeList,ht.asn1.ASN1Object),
ht.asn1.cms.SignerInfo=function(t){
var e=ht,n=e.asn1,r=n.DERTaggedObject,i=n.cms,s=i.AttributeList,o=i.ContentType,a=i.EncapsulatedContentInfo,u=i.MessageDigest,c=i.SignedData,h=n.x509.AlgorithmIdentifier,l=e.crypto,f=Ut
;i.SignerInfo.superclass.constructor.call(this),this.dCMSVersion=new n.DERInteger({int:1}),this.dSignerIdentifier=null,this.dDigestAlgorithm=null,this.dSignedAttrs=new s,this.dSigAlg=null,
this.dSig=null,this.dUnsignedAttrs=new s,this.setSignerIdentifier=function(t){if("string"==typeof t&&-1!=t.indexOf("CERTIFICATE")&&-1!=t.indexOf("BEGIN")&&-1!=t.indexOf("END")){
this.dSignerIdentifier=new i.IssuerAndSerialNumber({cert:t})}},this.setForContentAndHash=function(t){void 0!==t&&(t.eciObj instanceof a&&(this.dSignedAttrs.add(new o({oid:"1.2.840.113549.1.7.1"})),
this.dSignedAttrs.add(new u({eciObj:t.eciObj,hashAlg:t.hashAlg
}))),void 0!==t.sdObj&&t.sdObj instanceof c&&-1==t.sdObj.digestAlgNameList.join(":").indexOf(t.hashAlg)&&t.sdObj.digestAlgNameList.push(t.hashAlg),
"string"==typeof t.hashAlg&&(this.dDigestAlgorithm=new h({name:t.hashAlg})))},this.sign=function(t,e){this.dSigAlg=new h({name:e})
;var r=this.dSignedAttrs.getEncodedHex(),i=f.getKey(t),s=new l.Signature({alg:e});s.init(i),s.updateHex(r);var o=s.sign();this.dSig=new n.DEROctetString({hex:o})},this.addUnsigned=function(t){
this.hTLV=null,this.dUnsignedAttrs.hTLV=null,this.dUnsignedAttrs.add(t)},this.getEncodedHex=function(){
if(this.dSignedAttrs instanceof s&&0==this.dSignedAttrs.length())throw"SignedAttrs length = 0 (empty)";var t=new r({obj:this.dSignedAttrs,tag:"a0",explicit:!1}),e=null
;this.dUnsignedAttrs.length()>0&&(e=new r({obj:this.dUnsignedAttrs,tag:"a1",explicit:!1}));var i=[this.dCMSVersion,this.dSignerIdentifier,this.dDigestAlgorithm,t,this.dSigAlg,this.dSig]
;null!=e&&i.push(e);var o=new n.DERSequence({array:i});return this.hTLV=o.getEncodedHex(),this.hTLV}},s.lang.extend(ht.asn1.cms.SignerInfo,ht.asn1.ASN1Object),
ht.asn1.cms.EncapsulatedContentInfo=function(t){var e=ht.asn1,n=e.DERTaggedObject,r=e.DERSequence,i=e.DERObjectIdentifier,s=e.DEROctetString
;e.cms.EncapsulatedContentInfo.superclass.constructor.call(this),this.dEContentType=new i({name:"data"}),this.dEContent=null,this.isDetached=!1,this.eContentValueHex=null,
this.setContentType=function(t){t.match(/^[0-2][.][0-9.]+$/)?this.dEContentType=new i({oid:t}):this.dEContentType=new i({name:t})},this.setContentValue=function(t){
void 0!==t&&("string"==typeof t.hex?this.eContentValueHex=t.hex:"string"==typeof t.str&&(this.eContentValueHex=wt(t.str)))},this.setContentValueHex=function(t){this.eContentValueHex=t},
this.setContentValueStr=function(t){this.eContentValueHex=wt(t)},this.getEncodedHex=function(){if("string"!=typeof this.eContentValueHex)throw"eContentValue not yet set";var t=new s({
hex:this.eContentValueHex});this.dEContent=new n({obj:t,tag:"a0",explicit:!0});var e=[this.dEContentType];this.isDetached||e.push(this.dEContent);var i=new r({array:e})
;return this.hTLV=i.getEncodedHex(),this.hTLV}},s.lang.extend(ht.asn1.cms.EncapsulatedContentInfo,ht.asn1.ASN1Object),ht.asn1.cms.ContentInfo=function(t){
var e=ht.asn1,n=e.DERTaggedObject,r=e.DERSequence,i=e.x509;ht.asn1.cms.ContentInfo.superclass.constructor.call(this),this.dContentType=null,this.dContent=null,this.setContentType=function(t){
"string"==typeof t&&(this.dContentType=i.OID.name2obj(t))},this.getEncodedHex=function(){var t=new n({obj:this.dContent,tag:"a0",explicit:!0}),e=new r({array:[this.dContentType,t]})
;return this.hTLV=e.getEncodedHex(),this.hTLV},void 0!==t&&(t.type&&this.setContentType(t.type),t.obj&&t.obj instanceof e.ASN1Object&&(this.dContent=t.obj))},
s.lang.extend(ht.asn1.cms.ContentInfo,ht.asn1.ASN1Object),ht.asn1.cms.SignedData=function(t){
var e=ht.asn1,n=e.ASN1Object,r=e.DERInteger,i=e.DERSet,s=e.DERSequence,o=e.DERTaggedObject,a=e.cms,u=a.EncapsulatedContentInfo,c=a.SignerInfo,h=a.ContentInfo,l=e.x509.AlgorithmIdentifier
;ht.asn1.cms.SignedData.superclass.constructor.call(this),this.dCMSVersion=new r({int:1}),this.dDigestAlgs=null,this.digestAlgNameList=[],this.dEncapContentInfo=new u,this.dCerts=null,
this.certificateList=[],this.crlList=[],this.signerInfoList=[new c],this.addCertificatesByPEM=function(t){var e=Pt(t),r=new n;r.hTLV=e,this.certificateList.push(r)},this.getEncodedHex=function(){
if("string"==typeof this.hTLV)return this.hTLV;if(null==this.dDigestAlgs){for(var t=[],e=0;e<this.digestAlgNameList.length;e++){var n=this.digestAlgNameList[e],r=new l({name:n});t.push(r)}
this.dDigestAlgs=new i({array:t})}var a=[this.dCMSVersion,this.dDigestAlgs,this.dEncapContentInfo];if(null==this.dCerts&&this.certificateList.length>0){var u=new i({array:this.certificateList})
;this.dCerts=new o({obj:u,tag:"a0",explicit:!1})}null!=this.dCerts&&a.push(this.dCerts);var c=new i({array:this.signerInfoList});a.push(c);var h=new s({array:a});return this.hTLV=h.getEncodedHex(),
this.hTLV},this.getContentInfo=function(){return this.getEncodedHex(),new h({type:"signed-data",obj:this})},this.getContentInfoEncodedHex=function(){return this.getContentInfo().getEncodedHex()},
this.getPEM=function(){return Tt(this.getContentInfoEncodedHex(),"CMS")}},s.lang.extend(ht.asn1.cms.SignedData,ht.asn1.ASN1Object),ht.asn1.cms.CMSUtil=new function(){},
ht.asn1.cms.CMSUtil.newSignedData=function(t){
var e=ht.asn1,r=e.cms,i=r.SignerInfo,s=r.SignedData,o=r.SigningTime,a=r.SigningCertificate,u=r.SigningCertificateV2,c=e.cades.SignaturePolicyIdentifier,h=new s
;if(h.dEncapContentInfo.setContentValue(t.content),"boolean"==typeof t.detached&&(h.dEncapContentInfo.isDetached=t.detached),
"object"==n(t.certs))for(var l=0;l<t.certs.length;l++)h.addCertificatesByPEM(t.certs[l]);h.signerInfoList=[];for(l=0;l<t.signerInfos.length;l++){var f=t.signerInfos[l],d=new i
;for(attrName in d.setSignerIdentifier(f.signerCert),d.setForContentAndHash({sdObj:h,eciObj:h.dEncapContentInfo,hashAlg:f.hashAlg}),f.sAttr){var p=f.sAttr[attrName];if("SigningTime"==attrName){
var g=new o(p);d.dSignedAttrs.add(g)}if("SigningCertificate"==attrName){g=new a(p);d.dSignedAttrs.add(g)}if("SigningCertificateV2"==attrName){g=new u(p);d.dSignedAttrs.add(g)}
if("SignaturePolicyIdentifier"==attrName){g=new c(p);d.dSignedAttrs.add(g)}}d.sign(f.signerPrvKey,f.sigAlg),h.signerInfoList.push(d)}return h},ht.asn1.cms.CMSUtil.verifySignedData=function(t){
var e=ht,n=e.asn1,r=n.cms,i=(r.SignerInfo,r.SignedData,r.SigningTime,r.SigningCertificate,r.SigningCertificateV2,n.cades.SignaturePolicyIdentifier,
e.lang.String.isHex),s=dt,o=s.getVbyList,a=s.getTLVbyList,u=s.getIdxbyList,c=s.getChildIdx,h=s.getTLV,l=s.oidname,f=e.crypto.Util.hashHex;void 0===t.cms&&i(t.cms);var d=t.cms,p=function(t,e){
var n=e.idx;e.signerid_issuer1=a(t,n,[1,0],"30"),e.signerid_serial1=o(t,n,[1,1],"02"),e.hashalg=l(o(t,n,[2,0],"06"));var r=u(t,n,[3],"a0");e.idxSignedAttrs=r,g(t,e,r);var i=c(t,n).length
;if(i<6)throw"malformed SignerInfo";e.sigalg=l(o(t,n,[i-2,0],"06")),e.sigval=o(t,n,[i-1],"04")},g=function(t,e,n){var r=c(t,n);e.signedAttrIdxList=r;for(var i=0;i<r.length;i++){
var s,a=r[i],u=o(t,a,[0],"06");"2a864886f70d010905"===u?(s=_t(o(t,a,[1,0])),e.saSigningTime=s):"2a864886f70d010904"===u&&(s=o(t,a,[1,0],"04"),e.saMessageDigest=s)}},v=function(t,e,n,r){
n.verifyDetail={};var i=n.verifyDetail,s=e.parse.econtent,o=n.hashalg,a=n.saMessageDigest;i.validMessageDigest=!1,f(s,o)===a&&(i.validMessageDigest=!0),function(t,e,n,r){var i,s=e.parse.certsIdx
;if(void 0===e.certs){i=[],e.certkeys=[];for(var o=c(t,s),a=0;a<o.length;a++){var u=h(t,o[a]),l=new Wt;l.readCertHex(u),i[a]=l,e.certkeys[a]=l.getPublicKey()}e.certs=i}else i=e.certs;e.cccc=i.length,
e.cccci=o.length;for(a=0;a<i.length;a++){var f=l.getIssuerHex(),d=l.getSerialNumberHex();n.signerid_issuer1===f&&n.signerid_serial1===d&&(n.certkey_idx=a)}}(t,e,n),i.validSignatureValue=!1
;var u=n.sigalg,l="31"+h(t,n.idxSignedAttrs).substr(2);n.signedattrshex=l;var d=e.certs[n.certkey_idx].getPublicKey(),p=new ht.crypto.Signature({alg:u});p.init(d),p.updateHex(l)
;var g=p.verify(n.sigval);i.validSignatureValue_isValid=g,!0===g&&(i.validSignatureValue=!0),n.isValid=!1,i.validMessageDigest&&i.validSignatureValue&&(n.isValid=!0)},y={isValid:!1,parse:{}}
;return function(t,e){if("2a864886f70d010702"!==o(t,0,[0],"06"))return e;e.cmsType="signedData",e.econtent=o(t,0,[1,0,2,1,0]),function(t,e){for(var n,r=3;r<6;r++)if(void 0!==(n=u(t,0,[1,0,r]))){
var i=t.substr(n,2);"a0"===i&&(e.certsIdx=n),"a1"===i&&(e.revinfosIdx=n),"31"===i&&(e.signerinfosIdx=n)}}(t,e),e.signerInfos=[],function(t,e){var n=e.signerinfosIdx;if(void 0!==n){var r=c(t,n)
;e.signerInfoIdxList=r;for(var i=0;i<r.length;i++){var s={idx:r[i]};p(t,s),e.signerInfos.push(s)}}}(t,e)}(d,y.parse),function(t,e){for(var n=e.parse.signerInfos,r=n.length,i=!0,s=0;s<r;s++){var o=n[s]
;v(t,e,o,s),o.isValid||(i=!1)}e.isValid=i}(d,y),y},void 0!==ht&&ht||(ht={}),void 0!==ht.asn1&&ht.asn1||(ht.asn1={}),void 0!==ht.asn1.tsp&&ht.asn1.tsp||(ht.asn1.tsp={}),
ht.asn1.tsp.Accuracy=function(t){var e=ht.asn1,n=e.DERInteger,r=e.DERSequence,i=e.DERTaggedObject;e.tsp.Accuracy.superclass.constructor.call(this),this.seconds=null,this.millis=null,this.micros=null,
this.getEncodedHex=function(){var t=null,e=null,s=null,o=[];if(null!=this.seconds&&(t=new n({int:this.seconds}),o.push(t)),null!=this.millis){var a=new n({int:this.millis});e=new i({obj:a,tag:"80",
explicit:!1}),o.push(e)}if(null!=this.micros){var u=new n({int:this.micros});s=new i({obj:u,tag:"81",explicit:!1}),o.push(s)}var c=new r({array:o});return this.hTLV=c.getEncodedHex(),this.hTLV},
void 0!==t&&("number"==typeof t.seconds&&(this.seconds=t.seconds),"number"==typeof t.millis&&(this.millis=t.millis),"number"==typeof t.micros&&(this.micros=t.micros))},
s.lang.extend(ht.asn1.tsp.Accuracy,ht.asn1.ASN1Object),ht.asn1.tsp.MessageImprint=function(t){var e=ht.asn1,n=e.DERSequence,r=e.DEROctetString,i=e.x509.AlgorithmIdentifier
;e.tsp.MessageImprint.superclass.constructor.call(this),this.dHashAlg=null,this.dHashValue=null,this.getEncodedHex=function(){return"string"==typeof this.hTLV?this.hTLV:new n({
array:[this.dHashAlg,this.dHashValue]}).getEncodedHex()},void 0!==t&&("string"==typeof t.hashAlg&&(this.dHashAlg=new i({name:t.hashAlg})),"string"==typeof t.hashValue&&(this.dHashValue=new r({
hex:t.hashValue})))},s.lang.extend(ht.asn1.tsp.MessageImprint,ht.asn1.ASN1Object),ht.asn1.tsp.TimeStampReq=function(t){
var e=ht.asn1,r=e.DERSequence,i=e.DERInteger,s=e.DERBoolean,o=e.DERObjectIdentifier,a=e.tsp,u=a.MessageImprint;a.TimeStampReq.superclass.constructor.call(this),this.dVersion=new i({int:1}),
this.dMessageImprint=null,this.dPolicy=null,this.dNonce=null,this.certReq=!0,this.setMessageImprint=function(t){t instanceof u?this.dMessageImprint=t:"object"==n(t)&&(this.dMessageImprint=new u(t))},
this.getEncodedHex=function(){if(null==this.dMessageImprint)throw"messageImprint shall be specified";var t=[this.dVersion,this.dMessageImprint];null!=this.dPolicy&&t.push(this.dPolicy),
null!=this.dNonce&&t.push(this.dNonce),this.certReq&&t.push(new s);var e=new r({array:t});return this.hTLV=e.getEncodedHex(),this.hTLV},void 0!==t&&("object"==n(t.mi)&&this.setMessageImprint(t.mi),
"object"==n(t.policy)&&(this.dPolicy=new o(t.policy)),"object"==n(t.nonce)&&(this.dNonce=new i(t.nonce)),"boolean"==typeof t.certreq&&(this.certReq=t.certreq))},
s.lang.extend(ht.asn1.tsp.TimeStampReq,ht.asn1.ASN1Object),ht.asn1.tsp.TSTInfo=function(t){
var e=ht.asn1,n=e.DERSequence,r=e.DERInteger,i=e.DERBoolean,s=e.DERGeneralizedTime,o=e.DERObjectIdentifier,a=e.tsp,u=a.MessageImprint,c=a.Accuracy,h=e.x509.X500Name
;if(a.TSTInfo.superclass.constructor.call(this),this.dVersion=new r({int:1}),this.dPolicy=null,this.dMessageImprint=null,this.dSerialNumber=null,this.dGenTime=null,this.dAccuracy=null,
this.dOrdering=null,this.dNonce=null,this.dTsa=null,this.getEncodedHex=function(){var t=[this.dVersion];if(null==this.dPolicy)throw"policy shall be specified.";if(t.push(this.dPolicy),
null==this.dMessageImprint)throw"messageImprint shall be specified.";if(t.push(this.dMessageImprint),null==this.dSerialNumber)throw"serialNumber shall be specified.";if(t.push(this.dSerialNumber),
null==this.dGenTime)throw"genTime shall be specified.";t.push(this.dGenTime),null!=this.dAccuracy&&t.push(this.dAccuracy),null!=this.dOrdering&&t.push(this.dOrdering),
null!=this.dNonce&&t.push(this.dNonce),null!=this.dTsa&&t.push(this.dTsa);var e=new n({array:t});return this.hTLV=e.getEncodedHex(),this.hTLV},void 0!==t){if("string"==typeof t.policy){
if(!t.policy.match(/^[0-9.]+$/))throw"policy shall be oid like 0.1.4.134";this.dPolicy=new o({oid:t.policy})}void 0!==t.messageImprint&&(this.dMessageImprint=new u(t.messageImprint)),
void 0!==t.serialNumber&&(this.dSerialNumber=new r(t.serialNumber)),void 0!==t.genTime&&(this.dGenTime=new s(t.genTime)),void 0!==t.accuracy&&(this.dAccuracy=new c(t.accuracy)),
void 0!==t.ordering&&1==t.ordering&&(this.dOrdering=new i),void 0!==t.nonce&&(this.dNonce=new r(t.nonce)),void 0!==t.tsa&&(this.dTsa=new h(t.tsa))}},
s.lang.extend(ht.asn1.tsp.TSTInfo,ht.asn1.ASN1Object),ht.asn1.tsp.TimeStampResp=function(t){var e=ht.asn1,r=e.DERSequence,i=e.ASN1Object,s=e.tsp,o=s.PKIStatusInfo
;s.TimeStampResp.superclass.constructor.call(this),this.dStatus=null,this.dTST=null,this.getEncodedHex=function(){if(null==this.dStatus)throw"status shall be specified";var t=[this.dStatus]
;null!=this.dTST&&t.push(this.dTST);var e=new r({array:t});return this.hTLV=e.getEncodedHex(),this.hTLV},void 0!==t&&("object"==n(t.status)&&(this.dStatus=new o(t.status)),
void 0!==t.tst&&t.tst instanceof i&&(this.dTST=t.tst.getContentInfo()))},s.lang.extend(ht.asn1.tsp.TimeStampResp,ht.asn1.ASN1Object),ht.asn1.tsp.PKIStatusInfo=function(t){
var e=ht.asn1,r=e.DERSequence,i=e.tsp,s=i.PKIStatus,o=i.PKIFreeText,a=i.PKIFailureInfo;i.PKIStatusInfo.superclass.constructor.call(this),this.dStatus=null,this.dStatusString=null,
this.dFailureInfo=null,this.getEncodedHex=function(){if(null==this.dStatus)throw"status shall be specified";var t=[this.dStatus];null!=this.dStatusString&&t.push(this.dStatusString),
null!=this.dFailureInfo&&t.push(this.dFailureInfo);var e=new r({array:t});return this.hTLV=e.getEncodedHex(),this.hTLV},void 0!==t&&("object"==n(t.status)&&(this.dStatus=new s(t.status)),
"object"==n(t.statstr)&&(this.dStatusString=new o({array:t.statstr})),"object"==n(t.failinfo)&&(this.dFailureInfo=new a(t.failinfo)))},s.lang.extend(ht.asn1.tsp.PKIStatusInfo,ht.asn1.ASN1Object),
ht.asn1.tsp.PKIStatus=function(t){var e=ht.asn1,n=e.DERInteger,r=e.tsp,i=r.PKIStatus;r.PKIStatus.superclass.constructor.call(this);if(this.getEncodedHex=function(){
return this.hTLV=this.dStatus.getEncodedHex(),this.hTLV},void 0!==t)if(void 0!==t.name){var s=i.valueList;if(void 0===s[t.name])throw"name undefined: "+t.name;this.dStatus=new n({int:s[t.name]})
}else this.dStatus=new n(t)},s.lang.extend(ht.asn1.tsp.PKIStatus,ht.asn1.ASN1Object),ht.asn1.tsp.PKIStatus.valueList={granted:0,grantedWithMods:1,rejection:2,waiting:3,revocationWarning:4,
revocationNotification:5},ht.asn1.tsp.PKIFreeText=function(t){var e=ht.asn1,r=e.DERSequence,i=e.DERUTF8String;e.tsp.PKIFreeText.superclass.constructor.call(this),this.textList=[],
this.getEncodedHex=function(){for(var t=[],e=0;e<this.textList.length;e++)t.push(new i({str:this.textList[e]}));var n=new r({array:t});return this.hTLV=n.getEncodedHex(),this.hTLV},
void 0!==t&&"object"==n(t.array)&&(this.textList=t.array)},s.lang.extend(ht.asn1.tsp.PKIFreeText,ht.asn1.ASN1Object),ht.asn1.tsp.PKIFailureInfo=function(t){
var e=ht.asn1,n=e.DERBitString,r=e.tsp.PKIFailureInfo;if(r.superclass.constructor.call(this),this.value=null,this.getEncodedHex=function(){if(null==this.value)throw"value shall be specified"
;var t=new Number(this.value).toString(2),e=new n;return e.setByBinaryString(t),this.hTLV=e.getEncodedHex(),this.hTLV},void 0!==t)if("string"==typeof t.name){var i=r.valueList
;if(void 0===i[t.name])throw"name undefined: "+t.name;this.value=i[t.name]}else"number"==typeof t.int&&(this.value=t.int)},s.lang.extend(ht.asn1.tsp.PKIFailureInfo,ht.asn1.ASN1Object),
ht.asn1.tsp.PKIFailureInfo.valueList={badAlg:0,badRequest:2,badDataFormat:5,timeNotAvailable:14,unacceptedPolicy:15,unacceptedExtension:16,addInfoNotAvailable:17,systemFailure:25},
ht.asn1.tsp.AbstractTSAAdapter=function(t){this.getTSTHex=function(t,e){throw"not implemented yet"}},ht.asn1.tsp.SimpleTSAAdapter=function(t){var e=ht,n=e.asn1.tsp,r=e.crypto.Util.hashHex
;n.SimpleTSAAdapter.superclass.constructor.call(this),this.params=null,this.serial=0,this.getTSTHex=function(t,e){var i=r(t,e);this.params.tstInfo.messageImprint={hashAlg:e,hashValue:i},
this.params.tstInfo.serialNumber={int:this.serial++};var s=Math.floor(1e9*Math.random());return this.params.tstInfo.nonce={int:s},n.TSPUtil.newTimeStampToken(this.params).getContentInfoEncodedHex()},
void 0!==t&&(this.params=t)},s.lang.extend(ht.asn1.tsp.SimpleTSAAdapter,ht.asn1.tsp.AbstractTSAAdapter),ht.asn1.tsp.FixedTSAAdapter=function(t){var e=ht,n=e.asn1.tsp,r=e.crypto.Util.hashHex
;n.FixedTSAAdapter.superclass.constructor.call(this),this.params=null,this.getTSTHex=function(t,e){var i=r(t,e);return this.params.tstInfo.messageImprint={hashAlg:e,hashValue:i},
n.TSPUtil.newTimeStampToken(this.params).getContentInfoEncodedHex()},void 0!==t&&(this.params=t)},s.lang.extend(ht.asn1.tsp.FixedTSAAdapter,ht.asn1.tsp.AbstractTSAAdapter),
ht.asn1.tsp.TSPUtil=new function(){},ht.asn1.tsp.TSPUtil.newTimeStampToken=function(t){var e=ht.asn1,r=e.cms,i=(e.tsp,e.tsp.TSTInfo),s=new r.SignedData,o=new i(t.tstInfo).getEncodedHex()
;if(s.dEncapContentInfo.setContentValue({hex:o}),s.dEncapContentInfo.setContentType("tstinfo"),"object"==n(t.certs))for(var a=0;a<t.certs.length;a++)s.addCertificatesByPEM(t.certs[a])
;var u=s.signerInfoList[0];u.setSignerIdentifier(t.signerCert),u.setForContentAndHash({sdObj:s,eciObj:s.dEncapContentInfo,hashAlg:t.hashAlg});var c=new r.SigningCertificate({array:[t.signerCert]})
;return u.dSignedAttrs.add(c),u.sign(t.signerPrvKey,t.sigAlg),s},ht.asn1.tsp.TSPUtil.parseTimeStampReq=function(t){var e=dt,n=e.getChildIdx,r=e.getV,i=e.getTLV,s={certreq:!1},o=n(t,0)
;if(o.length<2)throw"TimeStampReq must have at least 2 items";var a=i(t,o[1]);s.mi=ht.asn1.tsp.TSPUtil.parseMessageImprint(a);for(var u=2;u<o.length;u++){var c=o[u],h=t.substr(c,2);if("06"==h){
var l=r(t,c);s.policy=e.hextooidstr(l)}"02"==h&&(s.nonce=r(t,c)),"01"==h&&(s.certreq=!0)}return s},ht.asn1.tsp.TSPUtil.parseMessageImprint=function(t){
var e=dt,n=e.getChildIdx,r=e.getV,i=e.getIdxbyList,s={};if("30"!=t.substr(0,2))throw"head of messageImprint hex shall be '30'";n(t,0)
;var o=r(t,i(t,0,[0,0])),a=e.hextooidstr(o),u=ht.asn1.x509.OID.oid2name(a);if(""==u)throw"hashAlg name undefined: "+a;var c=u,h=i(t,0,[1]);return s.hashAlg=c,s.hashValue=r(t,h),s},
void 0!==ht&&ht||(ht={}),void 0!==ht.asn1&&ht.asn1||(ht.asn1={}),void 0!==ht.asn1.cades&&ht.asn1.cades||(ht.asn1.cades={}),ht.asn1.cades.SignaturePolicyIdentifier=function(t){
var e=ht.asn1,r=e.DERObjectIdentifier,i=e.DERSequence,s=e.cades,o=s.OtherHashAlgAndValue;if(s.SignaturePolicyIdentifier.superclass.constructor.call(this),this.attrTypeOid="1.2.840.113549.1.9.16.2.15",
void 0!==t&&"string"==typeof t.oid&&"object"==n(t.hash)){var a=new i({array:[new r({oid:t.oid}),new o(t.hash)]});this.valueList=[a]}},
s.lang.extend(ht.asn1.cades.SignaturePolicyIdentifier,ht.asn1.cms.Attribute),ht.asn1.cades.OtherHashAlgAndValue=function(t){
var e=ht.asn1,n=e.DERSequence,r=e.DEROctetString,i=e.x509.AlgorithmIdentifier;e.cades.OtherHashAlgAndValue.superclass.constructor.call(this),this.dAlg=null,this.dHash=null,
this.getEncodedHex=function(){var t=new n({array:[this.dAlg,this.dHash]});return this.hTLV=t.getEncodedHex(),this.hTLV},void 0!==t&&"string"==typeof t.alg&&"string"==typeof t.hash&&(this.dAlg=new i({
name:t.alg}),this.dHash=new r({hex:t.hash}))},s.lang.extend(ht.asn1.cades.OtherHashAlgAndValue,ht.asn1.ASN1Object),ht.asn1.cades.SignatureTimeStamp=function(t){var e=ht.asn1,n=e.ASN1Object;e.x509
;if(e.cades.SignatureTimeStamp.superclass.constructor.call(this),this.attrTypeOid="1.2.840.113549.1.9.16.2.14",this.tstHex=null,void 0!==t){
if(void 0!==t.res)if("string"==typeof t.res&&t.res.match(/^[0-9A-Fa-f]+$/));else if(!(t.res instanceof n))throw"res param shall be ASN1Object or hex string"
;if(void 0!==t.tst)if("string"==typeof t.tst&&t.tst.match(/^[0-9A-Fa-f]+$/)){var r=new n;this.tstHex=t.tst,r.hTLV=this.tstHex,r.getEncodedHex(),this.valueList=[r]
}else if(!(t.tst instanceof n))throw"tst param shall be ASN1Object or hex string"}},s.lang.extend(ht.asn1.cades.SignatureTimeStamp,ht.asn1.cms.Attribute),
ht.asn1.cades.CompleteCertificateRefs=function(t){var e=ht.asn1.cades;e.CompleteCertificateRefs.superclass.constructor.call(this),this.attrTypeOid="1.2.840.113549.1.9.16.2.21",
this.setByArray=function(t){this.valueList=[];for(var n=0;n<t.length;n++){var r=new e.OtherCertID(t[n]);this.valueList.push(r)}},
void 0!==t&&"object"==n(t)&&"number"==typeof t.length&&this.setByArray(t)},s.lang.extend(ht.asn1.cades.CompleteCertificateRefs,ht.asn1.cms.Attribute),ht.asn1.cades.OtherCertID=function(t){
var e=ht.asn1,r=e.cms,i=e.cades;i.OtherCertID.superclass.constructor.call(this),this.hasIssuerSerial=!0,this.dOtherCertHash=null,this.dIssuerSerial=null,this.setByCertPEM=function(t){
this.dOtherCertHash=new i.OtherHash(t),this.hasIssuerSerial&&(this.dIssuerSerial=new r.IssuerAndSerialNumber(t))},this.getEncodedHex=function(){if(null!=this.hTLV)return this.hTLV
;if(null==this.dOtherCertHash)throw"otherCertHash not set";var t=[this.dOtherCertHash];null!=this.dIssuerSerial&&t.push(this.dIssuerSerial);var n=new e.DERSequence({array:t})
;return this.hTLV=n.getEncodedHex(),this.hTLV},void 0!==t&&("string"==typeof t&&-1!=t.indexOf("-----BEGIN ")&&this.setByCertPEM(t),"object"==n(t)&&(!1===t.hasis&&(this.hasIssuerSerial=!1),
"string"==typeof t.cert&&this.setByCertPEM(t.cert)))},s.lang.extend(ht.asn1.cades.OtherCertID,ht.asn1.ASN1Object),ht.asn1.cades.OtherHash=function(t){var e=ht,r=e.asn1,i=(r.cms,
r.cades),s=i.OtherHashAlgAndValue,o=e.crypto.Util.hashHex;if(i.OtherHash.superclass.constructor.call(this),this.alg="sha256",this.dOtherHash=null,this.setByCertPEM=function(t){
if(-1==t.indexOf("-----BEGIN "))throw"certPEM not to seem PEM format";var e=Pt(t),n=o(e,this.alg);this.dOtherHash=new s({alg:this.alg,hash:n})},this.getEncodedHex=function(){
if(null==this.dOtherHash)throw"OtherHash not set";return this.dOtherHash.getEncodedHex()},void 0!==t)if("string"==typeof t)if(-1!=t.indexOf("-----BEGIN "))this.setByCertPEM(t);else{
if(!t.match(/^[0-9A-Fa-f]+$/))throw"unsupported string value for params";this.dOtherHash=new r.DEROctetString({hex:t})
}else"object"==n(t)&&("string"==typeof t.cert?("string"==typeof t.alg&&(this.alg=t.alg),this.setByCertPEM(t.cert)):this.dOtherHash=new s(t))},s.lang.extend(ht.asn1.cades.OtherHash,ht.asn1.ASN1Object),
ht.asn1.cades.CAdESUtil=new function(){},ht.asn1.cades.CAdESUtil.addSigTS=function(t,e,n){},ht.asn1.cades.CAdESUtil.parseSignedDataForAddingUnsigned=function(t){
var e=dt,n=e.getChildIdx,r=e.getTLV,i=e.getTLVbyList,s=(e.getTLVbyListEx,e.getIdxbyList),o=(e.getIdxbyListEx,ht.asn1),a=o.ASN1Object,u=o.cms.SignedData,c=o.cades.CAdESUtil,h={}
;if("06092a864886f70d010702"!=i(t,0,[0]))throw"hex is not CMS SignedData";var l=n(t,s(t,0,[1,0]));if(l.length<4)throw"num of SignedData elem shall be 4 at least";var f=l.shift();h.version=r(t,f)
;var d=l.shift();h.algs=r(t,d);var p=l.shift();h.encapcontent=r(t,p),h.certs=null,h.revs=null,h.si=[];var g=l.shift();"a0"==t.substr(g,2)&&(h.certs=r(t,g),g=l.shift()),
"a1"==t.substr(g,2)&&(h.revs=r(t,g),g=l.shift());var v=g;if("31"!=t.substr(v,2))throw"Can't find signerInfos";for(var y=n(t,v),m=0;m<y.length;m++){
var S=y[m],b=c.parseSignerInfoForAddingUnsigned(t,S,m);h.si[m]=b}var x=null;h.obj=new u,(x=new a).hTLV=h.version,h.obj.dCMSVersion=x,(x=new a).hTLV=h.algs,h.obj.dDigestAlgs=x,
(x=new a).hTLV=h.encapcontent,h.obj.dEncapContentInfo=x,(x=new a).hTLV=h.certs,h.obj.dCerts=x,h.obj.signerInfoList=[];for(m=0;m<h.si.length;m++)h.obj.signerInfoList.push(h.si[m].obj);return h},
ht.asn1.cades.CAdESUtil.parseSignerInfoForAddingUnsigned=function(t,e,n){var r=dt,i=r.getChildIdx,s=r.getTLV,o=r.getV,a=ht.asn1,u=a.ASN1Object,c=a.cms,h=c.AttributeList,l=c.SignerInfo,f={},d=i(t,e)
;if(6!=d.length)throw"not supported items for SignerInfo (!=6)";var p=d.shift();f.version=s(t,p);var g=d.shift();f.si=s(t,g);var v=d.shift();f.digalg=s(t,v);var y=d.shift();f.sattrs=s(t,y)
;var m=d.shift();f.sigalg=s(t,m);var S=d.shift();f.sig=s(t,S),f.sigval=o(t,S);var b=null;return f.obj=new l,(b=new u).hTLV=f.version,f.obj.dCMSVersion=b,(b=new u).hTLV=f.si,f.obj.dSignerIdentifier=b,
(b=new u).hTLV=f.digalg,f.obj.dDigestAlgorithm=b,(b=new u).hTLV=f.sattrs,f.obj.dSignedAttrs=b,(b=new u).hTLV=f.sigalg,f.obj.dSigAlg=b,(b=new u).hTLV=f.sig,f.obj.dSig=b,f.obj.dUnsignedAttrs=new h,f},
void 0!==ht.asn1.csr&&ht.asn1.csr||(ht.asn1.csr={}),ht.asn1.csr.CertificationRequest=function(t){var e=ht,n=e.asn1,r=n.DERBitString,i=n.DERSequence,s=n.csr,o=n.x509
;s.CertificationRequest.superclass.constructor.call(this);this.sign=function(t,n){null==this.prvKey&&(this.prvKey=n),this.asn1SignatureAlg=new o.AlgorithmIdentifier({name:t})
;var s=new e.crypto.Signature({alg:t});s.init(this.prvKey),s.updateHex(this.asn1CSRInfo.getEncodedHex()),this.hexSig=s.sign(),this.asn1Sig=new r({hex:"00"+this.hexSig});var a=new i({
array:[this.asn1CSRInfo,this.asn1SignatureAlg,this.asn1Sig]});this.hTLV=a.getEncodedHex(),this.isModified=!1},this.getPEMString=function(){return Tt(this.getEncodedHex(),"CERTIFICATE REQUEST")},
this.getEncodedHex=function(){if(0==this.isModified&&null!=this.hTLV)return this.hTLV;throw"not signed yet"},void 0!==t&&void 0!==t.csrinfo&&(this.asn1CSRInfo=t.csrinfo)},
s.lang.extend(ht.asn1.csr.CertificationRequest,ht.asn1.ASN1Object),ht.asn1.csr.CertificationRequestInfo=function(t){
var e=ht.asn1,n=e.DERInteger,r=e.DERSequence,i=e.DERSet,s=e.DERNull,o=e.DERTaggedObject,a=e.DERObjectIdentifier,u=e.csr,c=e.x509,h=c.X500Name,l=c.Extension,f=Ut
;u.CertificationRequestInfo.superclass.constructor.call(this),this._initialize=function(){this.asn1Array=new Array,this.asn1Version=new n({int:0}),this.asn1Subject=null,this.asn1SubjPKey=null,
this.extensionsArray=new Array},this.setSubjectByParam=function(t){this.asn1Subject=new h(t)},this.setSubjectPublicKeyByGetKey=function(t){var e=f.getKey(t)
;this.asn1SubjPKey=new c.SubjectPublicKeyInfo(e)},this.appendExtensionByName=function(t,e){l.appendByNameToArray(t,e,this.extensionsArray)},this.getEncodedHex=function(){if(this.asn1Array=new Array,
this.asn1Array.push(this.asn1Version),this.asn1Array.push(this.asn1Subject),this.asn1Array.push(this.asn1SubjPKey),this.extensionsArray.length>0){var t=new r({array:this.extensionsArray}),e=new i({
array:[t]}),n=new r({array:[new a({oid:"1.2.840.113549.1.9.14"}),e]}),u=new o({explicit:!0,tag:"a0",obj:n});this.asn1Array.push(u)}else{u=new o({explicit:!1,tag:"a0",obj:new s});this.asn1Array.push(u)
}var c=new r({array:this.asn1Array});return this.hTLV=c.getEncodedHex(),this.isModified=!1,this.hTLV},this._initialize()},s.lang.extend(ht.asn1.csr.CertificationRequestInfo,ht.asn1.ASN1Object),
ht.asn1.csr.CSRUtil=new function(){},ht.asn1.csr.CSRUtil.newCSRPEM=function(t){var e=Ut,n=ht.asn1.csr;if(void 0===t.subject)throw"parameter subject undefined"
;if(void 0===t.sbjpubkey)throw"parameter sbjpubkey undefined";if(void 0===t.sigalg)throw"parameter sigalg undefined";if(void 0===t.sbjprvkey)throw"parameter sbjpubkey undefined"
;var r=new n.CertificationRequestInfo;if(r.setSubjectByParam(t.subject),r.setSubjectPublicKeyByGetKey(t.sbjpubkey),
void 0!==t.ext&&void 0!==t.ext.length)for(var i=0;i<t.ext.length;i++)for(key in t.ext[i])r.appendExtensionByName(key,t.ext[i][key]);var s=new n.CertificationRequest({csrinfo:r
}),o=e.getKey(t.sbjprvkey);return s.sign(t.sigalg,o),s.getPEMString()},ht.asn1.csr.CSRUtil.getInfo=function(t){var e=dt.getTLVbyListEx,n={subject:{},pubkey:{}}
;if(-1==t.indexOf("-----BEGIN CERTIFICATE REQUEST"))throw"argument is not PEM file";var r=Pt(t,"CERTIFICATE REQUEST");try{n.subject.hex=e(r,0,[0,1])}catch(t){}try{
n.subject.name=Wt.hex2dn(n.subject.hex)}catch(t){}n.pubkey.hex=e(r,0,[0,2]),n.pubkey.obj=Ut.getKey(n.pubkey.hex,null,"pkcs8pub");try{n.ext=[];var i=new Wt;i.parseExt(t),n.ext.push({subjectAltName:{
array:i.getExtSubjectAltName2()}})}catch(t){}return n},void 0!==ht&&ht||(ht={}),void 0!==ht.asn1&&ht.asn1||(ht.asn1={}),void 0!==ht.asn1.ocsp&&ht.asn1.ocsp||(ht.asn1.ocsp={}),
ht.asn1.ocsp.DEFAULT_HASH="sha1",ht.asn1.ocsp.CertID=function(t){
var e=ht,n=e.asn1,r=n.DEROctetString,i=n.DERInteger,s=n.DERSequence,o=n.x509.AlgorithmIdentifier,a=n.ocsp,u=a.DEFAULT_HASH,c=e.crypto.Util.hashHex,h=Wt,l=dt
;if(a.CertID.superclass.constructor.call(this),this.dHashAlg=null,this.dIssuerNameHash=null,this.dIssuerKeyHash=null,this.dSerialNumber=null,this.setByValue=function(t,e,n,s){void 0===s&&(s=u),
this.dHashAlg=new o({name:s}),this.dIssuerNameHash=new r({hex:t}),this.dIssuerKeyHash=new r({hex:e}),this.dSerialNumber=new i({hex:n})},this.setByCert=function(t,e,n){void 0===n&&(n=u);var r=new h
;r.readCertPEM(e);var i=new h;i.readCertPEM(t);var s=i.getPublicKeyHex(),o=l.getTLVbyList(s,0,[1,0],"30"),a=r.getSerialNumberHex(),f=c(i.getSubjectHex(),n),d=c(o,n);this.setByValue(f,d,a,n),
this.hoge=r.getSerialNumberHex()},this.getEncodedHex=function(){if(null===this.dHashAlg&&null===this.dIssuerNameHash&&null===this.dIssuerKeyHash&&null===this.dSerialNumber)throw"not yet set values"
;var t=[this.dHashAlg,this.dIssuerNameHash,this.dIssuerKeyHash,this.dSerialNumber],e=new s({array:t});return this.hTLV=e.getEncodedHex(),this.hTLV},void 0!==t){var f=t
;if(void 0!==f.issuerCert&&void 0!==f.subjectCert){var d=u;void 0===f.alg&&(d=void 0),this.setByCert(f.issuerCert,f.subjectCert,d)}else{
if(void 0===f.namehash||void 0===f.keyhash||void 0===f.serial)throw"invalid constructor arguments";d=u;void 0===f.alg&&(d=void 0),this.setByValue(f.namehash,f.keyhash,f.serial,d)}}},
s.lang.extend(ht.asn1.ocsp.CertID,ht.asn1.ASN1Object),ht.asn1.ocsp.Request=function(t){var e=ht.asn1,n=e.DERSequence,r=e.ocsp;if(r.Request.superclass.constructor.call(this),this.dReqCert=null,
this.dExt=null,this.getEncodedHex=function(){var t=[];if(null===this.dReqCert)throw"reqCert not set";t.push(this.dReqCert);var e=new n({array:t});return this.hTLV=e.getEncodedHex(),this.hTLV},
void 0!==t){var i=new r.CertID(t);this.dReqCert=i}},s.lang.extend(ht.asn1.ocsp.Request,ht.asn1.ASN1Object),ht.asn1.ocsp.TBSRequest=function(t){var e=ht.asn1,n=e.DERSequence,r=e.ocsp
;r.TBSRequest.superclass.constructor.call(this),this.version=0,this.dRequestorName=null,this.dRequestList=[],this.dRequestExt=null,this.setRequestListByParam=function(t){
for(var e=[],n=0;n<t.length;n++){var i=new r.Request(t[0]);e.push(i)}this.dRequestList=e},this.getEncodedHex=function(){var t=[];if(0!==this.version)throw"not supported version: "+this.version
;if(null!==this.dRequestorName)throw"requestorName not supported";var e=new n({array:this.dRequestList});if(t.push(e),null!==this.dRequestExt)throw"requestExtensions not supported";var r=new n({
array:t});return this.hTLV=r.getEncodedHex(),this.hTLV},void 0!==t&&void 0!==t.reqList&&this.setRequestListByParam(t.reqList)},s.lang.extend(ht.asn1.ocsp.TBSRequest,ht.asn1.ASN1Object),
ht.asn1.ocsp.OCSPRequest=function(t){var e=ht.asn1,n=e.DERSequence,r=e.ocsp;if(r.OCSPRequest.superclass.constructor.call(this),this.dTbsRequest=null,this.dOptionalSignature=null,
this.getEncodedHex=function(){var t=[];if(null===this.dTbsRequest)throw"tbsRequest not set";if(t.push(this.dTbsRequest),null!==this.dOptionalSignature)throw"optionalSignature not supported"
;var e=new n({array:t});return this.hTLV=e.getEncodedHex(),this.hTLV},void 0!==t&&void 0!==t.reqList){var i=new r.TBSRequest(t);this.dTbsRequest=i}},
s.lang.extend(ht.asn1.ocsp.OCSPRequest,ht.asn1.ASN1Object),ht.asn1.ocsp.OCSPUtil={},ht.asn1.ocsp.OCSPUtil.getRequestHex=function(t,e,n){var r=ht.asn1.ocsp;void 0===n&&(n=r.DEFAULT_HASH);var i={alg:n,
issuerCert:t,subjectCert:e};return new r.OCSPRequest({reqList:[i]}).getEncodedHex()},ht.asn1.ocsp.OCSPUtil.getOCSPResponseInfo=function(t){
var e=dt,n=e.getVbyList,r=e.getVbyListEx,i=e.getIdxbyList,s=(e.getIdxbyListEx,e.getV),o={};try{var a=r(t,0,[0],"0a");o.responseStatus=parseInt(a,16)}catch(t){}if(0!==o.responseStatus)return o;try{
var u=i(t,0,[1,0,1,0,0,2,0,1]);"80"===t.substr(u,2)?o.certStatus="good":"a1"===t.substr(u,2)?(o.certStatus="revoked",o.revocationTime=_t(n(t,u,[0]))):"82"===t.substr(u,2)&&(o.certStatus="unknown")
}catch(t){}try{var c=i(t,0,[1,0,1,0,0,2,0,2]);o.thisUpdate=_t(s(t,c))}catch(t){}try{var h=i(t,0,[1,0,1,0,0,2,0,3]);"a0"===t.substr(h,2)&&(o.nextUpdate=_t(n(t,h,[0])))}catch(t){}return o},
void 0!==ht&&ht||(ht={}),void 0!==ht.lang&&ht.lang||(ht.lang={}),ht.lang.String=function(){},"function"==typeof t?(lt=function(e){return mt(new t(e,"utf8").toString("base64"))},ft=function(e){
return new t(St(e),"base64").toString("utf8")}):(lt=function(t){return bt(Dt(jt(t)))},ft=function(t){return decodeURIComponent(Bt(xt(t)))}),ht.lang.String.isInteger=function(t){
return!!t.match(/^[0-9]+$/)||!!t.match(/^-[0-9]+$/)},ht.lang.String.isHex=function(t){return!(t.length%2!=0||!t.match(/^[0-9a-f]+$/)&&!t.match(/^[0-9A-F]+$/))},ht.lang.String.isBase64=function(t){
return!(!(t=t.replace(/\s+/g,"")).match(/^[0-9A-Za-z+\/]+={0,3}$/)||t.length%4!=0)},ht.lang.String.isBase64URL=function(t){return!t.match(/[+/=]/)&&(t=St(t),ht.lang.String.isBase64(t))},
ht.lang.String.isIntegerArray=function(t){return!!(t=t.replace(/\s+/g,"")).match(/^\[[0-9,]+\]$/)};void 0!==ht&&ht||(ht={}),void 0!==ht.crypto&&ht.crypto||(ht.crypto={}),ht.crypto.Util=new function(){
this.DIGESTINFOHEAD={sha1:"3021300906052b0e03021a05000414",sha224:"302d300d06096086480165030402040500041c",sha256:"3031300d060960864801650304020105000420",
sha384:"3041300d060960864801650304020205000430",sha512:"3051300d060960864801650304020305000440",md2:"3020300c06082a864886f70d020205000410",md5:"3020300c06082a864886f70d020505000410",
ripemd160:"3021300906052b2403020105000414"},this.DEFAULTPROVIDER={md5:"cryptojs",sha1:"cryptojs",sha224:"cryptojs",sha256:"cryptojs",sha384:"cryptojs",sha512:"cryptojs",ripemd160:"cryptojs",
hmacmd5:"cryptojs",hmacsha1:"cryptojs",hmacsha224:"cryptojs",hmacsha256:"cryptojs",hmacsha384:"cryptojs",hmacsha512:"cryptojs",hmacripemd160:"cryptojs",MD5withRSA:"cryptojs/jsrsa",
SHA1withRSA:"cryptojs/jsrsa",SHA224withRSA:"cryptojs/jsrsa",SHA256withRSA:"cryptojs/jsrsa",SHA384withRSA:"cryptojs/jsrsa",SHA512withRSA:"cryptojs/jsrsa",RIPEMD160withRSA:"cryptojs/jsrsa",
MD5withECDSA:"cryptojs/jsrsa",SHA1withECDSA:"cryptojs/jsrsa",SHA224withECDSA:"cryptojs/jsrsa",SHA256withECDSA:"cryptojs/jsrsa",SHA384withECDSA:"cryptojs/jsrsa",SHA512withECDSA:"cryptojs/jsrsa",
RIPEMD160withECDSA:"cryptojs/jsrsa",SHA1withDSA:"cryptojs/jsrsa",SHA224withDSA:"cryptojs/jsrsa",SHA256withDSA:"cryptojs/jsrsa",MD5withRSAandMGF1:"cryptojs/jsrsa",SHAwithRSAandMGF1:"cryptojs/jsrsa",
SHA1withRSAandMGF1:"cryptojs/jsrsa",SHA224withRSAandMGF1:"cryptojs/jsrsa",SHA256withRSAandMGF1:"cryptojs/jsrsa",SHA384withRSAandMGF1:"cryptojs/jsrsa",SHA512withRSAandMGF1:"cryptojs/jsrsa",
RIPEMD160withRSAandMGF1:"cryptojs/jsrsa"},this.CRYPTOJSMESSAGEDIGESTNAME={md5:y.algo.MD5,sha1:y.algo.SHA1,sha224:y.algo.SHA224,sha256:y.algo.SHA256,sha384:y.algo.SHA384,sha512:y.algo.SHA512,
ripemd160:y.algo.RIPEMD160},this.getDigestInfoHex=function(t,e){if(void 0===this.DIGESTINFOHEAD[e])throw"alg not supported in Util.DIGESTINFOHEAD: "+e;return this.DIGESTINFOHEAD[e]+t},
this.getPaddedDigestInfoHex=function(t,e,n){var r=this.getDigestInfoHex(t,e),i=n/4;if(r.length+22>i)throw"key is too short for SigAlg: keylen="+n+","+e
;for(var s="0001",o="00"+r,a="",u=i-s.length-o.length,c=0;c<u;c+=2)a+="ff";return s+a+o},this.hashString=function(t,e){return new ht.crypto.MessageDigest({alg:e}).digestString(t)},
this.hashHex=function(t,e){return new ht.crypto.MessageDigest({alg:e}).digestHex(t)},this.sha1=function(t){return this.hashString(t,"sha1")},this.sha256=function(t){return this.hashString(t,"sha256")
},this.sha256Hex=function(t){return this.hashHex(t,"sha256")},this.sha512=function(t){return this.hashString(t,"sha512")},this.sha512Hex=function(t){return this.hashHex(t,"sha512")},
this.isKey=function(t){return t instanceof it||t instanceof ht.crypto.DSA||t instanceof ht.crypto.ECDSA}},ht.crypto.Util.md5=function(t){return new ht.crypto.MessageDigest({alg:"md5",prov:"cryptojs"
}).digestString(t)},ht.crypto.Util.ripemd160=function(t){return new ht.crypto.MessageDigest({alg:"ripemd160",prov:"cryptojs"}).digestString(t)},ht.crypto.Util.SECURERANDOMGEN=new et,
ht.crypto.Util.getRandomHexOfNbytes=function(t){var e=new Array(t);return ht.crypto.Util.SECURERANDOMGEN.nextBytes(e),vt(e)},ht.crypto.Util.getRandomBigIntegerOfNbytes=function(t){
return new _(ht.crypto.Util.getRandomHexOfNbytes(t),16)},ht.crypto.Util.getRandomHexOfNbits=function(t){var e=t%8,n=new Array((t-e)/8+1);return ht.crypto.Util.SECURERANDOMGEN.nextBytes(n),
n[0]=(255<<e&255^255)&n[0],vt(n)},ht.crypto.Util.getRandomBigIntegerOfNbits=function(t){return new _(ht.crypto.Util.getRandomHexOfNbits(t),16)},ht.crypto.Util.getRandomBigIntegerZeroToMax=function(t){
for(var e=t.bitLength();;){var n=ht.crypto.Util.getRandomBigIntegerOfNbits(e);if(-1!=t.compareTo(n))return n}},ht.crypto.Util.getRandomBigIntegerMinToMax=function(t,e){var n=t.compareTo(e)
;if(1==n)throw"biMin is greater than biMax";if(0==n)return t;var r=e.subtract(t);return ht.crypto.Util.getRandomBigIntegerZeroToMax(r).add(t)},ht.crypto.MessageDigest=function(t){
this.setAlgAndProvider=function(t,e){if(null!==(t=ht.crypto.MessageDigest.getCanonicalAlgName(t))&&void 0===e&&(e=ht.crypto.Util.DEFAULTPROVIDER[t]),
-1!=":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(t)&&"cryptojs"==e){try{this.md=ht.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[t].create()}catch(e){
throw"setAlgAndProvider hash alg set fail alg="+t+"/"+e}this.updateString=function(t){this.md.update(t)},this.updateHex=function(t){var e=y.enc.Hex.parse(t);this.md.update(e)},this.digest=function(){
return this.md.finalize().toString(y.enc.Hex)},this.digestString=function(t){return this.updateString(t),this.digest()},this.digestHex=function(t){return this.updateHex(t),this.digest()}}
if(-1!=":sha256:".indexOf(t)&&"sjcl"==e){try{this.md=new sjcl.hash.sha256}catch(e){throw"setAlgAndProvider hash alg set fail alg="+t+"/"+e}this.updateString=function(t){this.md.update(t)},
this.updateHex=function(t){var e=sjcl.codec.hex.toBits(t);this.md.update(e)},this.digest=function(){var t=this.md.finalize();return sjcl.codec.hex.fromBits(t)},this.digestString=function(t){
return this.updateString(t),this.digest()},this.digestHex=function(t){return this.updateHex(t),this.digest()}}},this.updateString=function(t){
throw"updateString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.updateHex=function(t){
throw"updateHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digest=function(){throw"digest() not supported for this alg/prov: "+this.algName+"/"+this.provName},
this.digestString=function(t){throw"digestString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digestHex=function(t){
throw"digestHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName},void 0!==t&&void 0!==t.alg&&(this.algName=t.alg,
void 0===t.prov&&(this.provName=ht.crypto.Util.DEFAULTPROVIDER[this.algName]),this.setAlgAndProvider(this.algName,this.provName))},ht.crypto.MessageDigest.getCanonicalAlgName=function(t){
return"string"==typeof t&&(t=(t=t.toLowerCase()).replace(/-/,"")),t},ht.crypto.MessageDigest.getHashLength=function(t){var e=ht.crypto.MessageDigest,n=e.getCanonicalAlgName(t)
;if(void 0===e.HASHLENGTH[n])throw"not supported algorithm: "+t;return e.HASHLENGTH[n]},ht.crypto.MessageDigest.HASHLENGTH={md5:16,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64,ripemd160:20},
ht.crypto.Mac=function(t){this.setAlgAndProvider=function(t,e){if(null==(t=t.toLowerCase())&&(t="hmacsha1"),"hmac"!=(t=t.toLowerCase()).substr(0,4))throw"setAlgAndProvider unsupported HMAC alg: "+t
;void 0===e&&(e=ht.crypto.Util.DEFAULTPROVIDER[t]),this.algProv=t+"/"+e;var n=t.substr(4);if(-1!=":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(n)&&"cryptojs"==e){try{
var r=ht.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[n];this.mac=y.algo.HMAC.create(r,this.pass)}catch(t){throw"setAlgAndProvider hash alg set fail hashAlg="+n+"/"+t}this.updateString=function(t){
this.mac.update(t)},this.updateHex=function(t){var e=y.enc.Hex.parse(t);this.mac.update(e)},this.doFinal=function(){return this.mac.finalize().toString(y.enc.Hex)},this.doFinalString=function(t){
return this.updateString(t),this.doFinal()},this.doFinalHex=function(t){return this.updateHex(t),this.doFinal()}}},this.updateString=function(t){
throw"updateString(str) not supported for this alg/prov: "+this.algProv},this.updateHex=function(t){throw"updateHex(hex) not supported for this alg/prov: "+this.algProv},this.doFinal=function(){
throw"digest() not supported for this alg/prov: "+this.algProv},this.doFinalString=function(t){throw"digestString(str) not supported for this alg/prov: "+this.algProv},this.doFinalHex=function(t){
throw"digestHex(hex) not supported for this alg/prov: "+this.algProv},this.setPassword=function(t){if("string"==typeof t){var e=t;return t.length%2!=1&&t.match(/^[0-9A-Fa-f]+$/)||(e=At(t)),
void(this.pass=y.enc.Hex.parse(e))}if("object"!=n(t))throw"KJUR.crypto.Mac unsupported password type: "+t;e=null;if(void 0!==t.hex){
if(t.hex.length%2!=0||!t.hex.match(/^[0-9A-Fa-f]+$/))throw"Mac: wrong hex password: "+t.hex;e=t.hex}if(void 0!==t.utf8&&(e=wt(t.utf8)),void 0!==t.rstr&&(e=At(t.rstr)),void 0!==t.b64&&(e=x(t.b64)),
void 0!==t.b64u&&(e=xt(t.b64u)),null==e)throw"KJUR.crypto.Mac unsupported password type: "+t;this.pass=y.enc.Hex.parse(e)},void 0!==t&&(void 0!==t.pass&&this.setPassword(t.pass),
void 0!==t.alg&&(this.algName=t.alg,void 0===t.prov&&(this.provName=ht.crypto.Util.DEFAULTPROVIDER[this.algName]),this.setAlgAndProvider(this.algName,this.provName)))},ht.crypto.Signature=function(t){
var e=null;if(this._setAlgNames=function(){var t=this.algName.match(/^(.+)with(.+)$/);t&&(this.mdAlgName=t[1].toLowerCase(),this.pubkeyAlgName=t[2].toLowerCase(),
"rsaandmgf1"==this.pubkeyAlgName&&"sha"==this.mdAlgName&&(this.mdAlgName="sha1"))},this._zeroPaddingOfSignature=function(t,e){for(var n="",r=e/4-t.length,i=0;i<r;i++)n+="0";return n+t},
this.setAlgAndProvider=function(t,e){if(this._setAlgNames(),"cryptojs/jsrsa"!=e)throw new Error("provider not supported: "+e)
;if(-1!=":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(this.mdAlgName)){try{this.md=new ht.crypto.MessageDigest({alg:this.mdAlgName})}catch(t){
throw new Error("setAlgAndProvider hash alg set fail alg="+this.mdAlgName+"/"+t)}this.init=function(t,e){var n=null;try{n=void 0===e?Ut.getKey(t):Ut.getKey(t,e)}catch(t){throw"init failed:"+t}
if(!0===n.isPrivate)this.prvKey=n,this.state="SIGN";else{if(!0!==n.isPublic)throw"init failed.:"+n;this.pubKey=n,this.state="VERIFY"}},this.updateString=function(t){this.md.updateString(t)},
this.updateHex=function(t){this.md.updateHex(t)},this.sign=function(){if(this.sHashHex=this.md.digest(),
void 0===this.prvKey&&void 0!==this.ecprvhex&&void 0!==this.eccurvename&&void 0!==ht.crypto.ECDSA&&(this.prvKey=new ht.crypto.ECDSA({curve:this.eccurvename,prv:this.ecprvhex})),
this.prvKey instanceof it&&"rsaandmgf1"===this.pubkeyAlgName)this.hSign=this.prvKey.signWithMessageHashPSS(this.sHashHex,this.mdAlgName,this.pssSaltLen);else if(this.prvKey instanceof it&&"rsa"===this.pubkeyAlgName)this.hSign=this.prvKey.signWithMessageHash(this.sHashHex,this.mdAlgName);else if(this.prvKey instanceof ht.crypto.ECDSA)this.hSign=this.prvKey.signWithMessageHash(this.sHashHex);else{
if(!(this.prvKey instanceof ht.crypto.DSA))throw"Signature: unsupported private key alg: "+this.pubkeyAlgName;this.hSign=this.prvKey.signWithMessageHash(this.sHashHex)}return this.hSign},
this.signString=function(t){return this.updateString(t),this.sign()},this.signHex=function(t){return this.updateHex(t),this.sign()},this.verify=function(t){if(this.sHashHex=this.md.digest(),
void 0===this.pubKey&&void 0!==this.ecpubhex&&void 0!==this.eccurvename&&void 0!==ht.crypto.ECDSA&&(this.pubKey=new ht.crypto.ECDSA({curve:this.eccurvename,pub:this.ecpubhex})),
this.pubKey instanceof it&&"rsaandmgf1"===this.pubkeyAlgName)return this.pubKey.verifyWithMessageHashPSS(this.sHashHex,t,this.mdAlgName,this.pssSaltLen)
;if(this.pubKey instanceof it&&"rsa"===this.pubkeyAlgName)return this.pubKey.verifyWithMessageHash(this.sHashHex,t)
;if(void 0!==ht.crypto.ECDSA&&this.pubKey instanceof ht.crypto.ECDSA)return this.pubKey.verifyWithMessageHash(this.sHashHex,t)
;if(void 0!==ht.crypto.DSA&&this.pubKey instanceof ht.crypto.DSA)return this.pubKey.verifyWithMessageHash(this.sHashHex,t);throw"Signature: unsupported public key alg: "+this.pubkeyAlgName}}},
this.init=function(t,e){throw"init(key, pass) not supported for this alg:prov="+this.algProvName},this.updateString=function(t){
throw"updateString(str) not supported for this alg:prov="+this.algProvName},this.updateHex=function(t){throw"updateHex(hex) not supported for this alg:prov="+this.algProvName},this.sign=function(){
throw"sign() not supported for this alg:prov="+this.algProvName},this.signString=function(t){throw"digestString(str) not supported for this alg:prov="+this.algProvName},this.signHex=function(t){
throw"digestHex(hex) not supported for this alg:prov="+this.algProvName},this.verify=function(t){throw"verify(hSigVal) not supported for this alg:prov="+this.algProvName},this.initParams=t,
void 0!==t&&(void 0!==t.alg&&(this.algName=t.alg,void 0===t.prov?this.provName=ht.crypto.Util.DEFAULTPROVIDER[this.algName]:this.provName=t.prov,this.algProvName=this.algName+":"+this.provName,
this.setAlgAndProvider(this.algName,this.provName),this._setAlgNames()),void 0!==t.psssaltlen&&(this.pssSaltLen=t.psssaltlen),void 0!==t.prvkeypem)){
if(void 0!==t.prvkeypas)throw"both prvkeypem and prvkeypas parameters not supported";try{e=Ut.getKey(t.prvkeypem);this.init(e)}catch(t){throw"fatal error to load pem private key: "+t}}},
ht.crypto.Cipher=function(t){},ht.crypto.Cipher.encrypt=function(t,e,n){if(e instanceof it&&e.isPublic){var r=ht.crypto.Cipher.getAlgByKeyAndName(e,n);if("RSA"===r)return e.encrypt(t)
;if("RSAOAEP"===r)return e.encryptOAEP(t,"sha1");var i=r.match(/^RSAOAEP(\d+)$/);if(null!==i)return e.encryptOAEP(t,"sha"+i[1]);throw"Cipher.encrypt: unsupported algorithm for RSAKey: "+n}
throw"Cipher.encrypt: unsupported key or algorithm"},ht.crypto.Cipher.decrypt=function(t,e,n){if(e instanceof it&&e.isPrivate){var r=ht.crypto.Cipher.getAlgByKeyAndName(e,n)
;if("RSA"===r)return e.decrypt(t);if("RSAOAEP"===r)return e.decryptOAEP(t,"sha1");var i=r.match(/^RSAOAEP(\d+)$/);if(null!==i)return e.decryptOAEP(t,"sha"+i[1])
;throw"Cipher.decrypt: unsupported algorithm for RSAKey: "+n}throw"Cipher.decrypt: unsupported key or algorithm"},ht.crypto.Cipher.getAlgByKeyAndName=function(t,e){if(t instanceof it){
if(-1!=":RSA:RSAOAEP:RSAOAEP224:RSAOAEP256:RSAOAEP384:RSAOAEP512:".indexOf(e))return e;if(null==e)return"RSA";throw"getAlgByKeyAndName: not supported algorithm name for RSAKey: "+e}
throw"getAlgByKeyAndName: not supported algorithm name: "+e},ht.crypto.OID=new function(){this.oidhex2name={"2a864886f70d010101":"rsaEncryption","2a8648ce3d0201":"ecPublicKey","2a8648ce380401":"dsa",
"2a8648ce3d030107":"secp256r1","2b8104001f":"secp192k1","2b81040021":"secp224r1","2b8104000a":"secp256k1","2b81040023":"secp521r1","2b81040022":"secp384r1","2a8648ce380403":"SHA1withDSA",
"608648016503040301":"SHA224withDSA","608648016503040302":"SHA256withDSA"}},void 0!==ht&&ht||(ht={}),void 0!==ht.crypto&&ht.crypto||(ht.crypto={}),ht.crypto.ECDSA=function(t){
var e=Error,r=_,i=at,s=ht.crypto.ECDSA,o=ht.crypto.ECParameterDB,a=s.getName,u=dt,c=u.getVbyListEx,h=u.isASN1HEX,l=new et;this.type="EC",this.isPrivate=!1,this.isPublic=!1,
this.getBigRandom=function(t){return new r(t.bitLength(),l).mod(t.subtract(r.ONE)).add(r.ONE)},this.setNamedCurve=function(t){this.ecparams=o.getByName(t),this.prvKeyHex=null,this.pubKeyHex=null,
this.curveName=t},this.setPrivateKeyHex=function(t){this.isPrivate=!0,this.prvKeyHex=t},this.setPublicKeyHex=function(t){this.isPublic=!0,this.pubKeyHex=t},this.getPublicKeyXYHex=function(){
var t=this.pubKeyHex;if("04"!==t.substr(0,2))throw"this method supports uncompressed format(04) only";var e=this.ecparams.keylen/4;if(t.length!==2+2*e)throw"malformed public key hex length";var n={}
;return n.x=t.substr(2,e),n.y=t.substr(2+e),n},this.getShortNISTPCurveName=function(){var t=this.curveName
;return"secp256r1"===t||"NIST P-256"===t||"P-256"===t||"prime256v1"===t?"P-256":"secp384r1"===t||"NIST P-384"===t||"P-384"===t?"P-384":null},this.generateKeyPairHex=function(){
var t=this.ecparams.n,e=this.getBigRandom(t),n=this.ecparams.G.multiply(e),r=n.getX().toBigInteger(),i=n.getY().toBigInteger(),s=this.ecparams.keylen/4,o=("0000000000"+e.toString(16)).slice(-s),a="04"+("0000000000"+r.toString(16)).slice(-s)+("0000000000"+i.toString(16)).slice(-s)
;return this.setPrivateKeyHex(o),this.setPublicKeyHex(a),{ecprvhex:o,ecpubhex:a}},this.signWithMessageHash=function(t){return this.signHex(t,this.prvKeyHex)},this.signHex=function(t,e){
var n=new r(e,16),i=this.ecparams.n,o=new r(t.substring(0,this.ecparams.keylen/4),16);do{var a=this.getBigRandom(i),u=this.ecparams.G.multiply(a).getX().toBigInteger().mod(i)
}while(u.compareTo(r.ZERO)<=0);var c=a.modInverse(i).multiply(o.add(n.multiply(u))).mod(i);return s.biRSSigToASN1Sig(u,c)},this.sign=function(t,e){
var n=e,i=this.ecparams.n,s=r.fromByteArrayUnsigned(t);do{var o=this.getBigRandom(i),a=this.ecparams.G.multiply(o).getX().toBigInteger().mod(i)}while(a.compareTo(_.ZERO)<=0)
;var u=o.modInverse(i).multiply(s.add(n.multiply(a))).mod(i);return this.serializeSig(a,u)},this.verifyWithMessageHash=function(t,e){return this.verifyHex(t,e,this.pubKeyHex)},
this.verifyHex=function(t,e,n){try{var o,a,u=s.parseSigHex(e);o=u.r,a=u.s;var c=i.decodeFromHex(this.ecparams.curve,n),h=new r(t.substring(0,this.ecparams.keylen/4),16);return this.verifyRaw(h,o,a,c)
}catch(t){return!1}},this.verify=function(t,e,s){var o,a,u;if(Bitcoin.Util.isArray(e)){var c=this.parseSig(e);o=c.r,a=c.s}else{if("object"!==n(e)||!e.r||!e.s)throw"Invalid value for signature";o=e.r,
a=e.s}if(s instanceof at)u=s;else{if(!Bitcoin.Util.isArray(s))throw"Invalid format for pubkey value, must be byte array or ECPointFp";u=i.decodeFrom(this.ecparams.curve,s)}
var h=r.fromByteArrayUnsigned(t);return this.verifyRaw(h,o,a,u)},this.verifyRaw=function(t,e,n,i){var s=this.ecparams.n,o=this.ecparams.G;if(e.compareTo(r.ONE)<0||e.compareTo(s)>=0)return!1
;if(n.compareTo(r.ONE)<0||n.compareTo(s)>=0)return!1;var a=n.modInverse(s),u=t.multiply(a).mod(s),c=e.multiply(a).mod(s);return o.multiply(u).add(i.multiply(c)).getX().toBigInteger().mod(s).equals(e)
},this.serializeSig=function(t,e){var n=t.toByteArraySigned(),r=e.toByteArraySigned(),i=[];return i.push(2),i.push(n.length),(i=i.concat(n)).push(2),i.push(r.length),(i=i.concat(r)).unshift(i.length),
i.unshift(48),i},this.parseSig=function(t){var e;if(48!=t[0])throw new Error("Signature not a valid DERSequence");if(2!=t[e=2])throw new Error("First element in signature must be a DERInteger")
;var n=t.slice(e+2,e+2+t[e+1]);if(2!=t[e+=2+t[e+1]])throw new Error("Second element in signature must be a DERInteger");var i=t.slice(e+2,e+2+t[e+1]);return e+=2+t[e+1],{r:r.fromByteArrayUnsigned(n),
s:r.fromByteArrayUnsigned(i)}},this.parseSigCompact=function(t){if(65!==t.length)throw"Signature has the wrong length";var e=t[0]-27;if(e<0||e>7)throw"Invalid signature type";var n=this.ecparams.n
;return{r:r.fromByteArrayUnsigned(t.slice(1,33)).mod(n),s:r.fromByteArrayUnsigned(t.slice(33,65)).mod(n),i:e}},this.readPKCS5PrvKeyHex=function(t){if(!1===h(t))throw new Error("not ASN.1 hex string")
;var e,n,r;try{e=c(t,0,["[0]",0],"06"),n=c(t,0,[1],"04");try{r=c(t,0,["[1]",0],"03")}catch(t){}}catch(t){throw new Error("malformed PKCS#1/5 plain ECC private key")}if(this.curveName=a(e),
void 0===this.curveName)throw"unsupported curve name";this.setNamedCurve(this.curveName),this.setPublicKeyHex(r),this.setPrivateKeyHex(n),this.isPublic=!1},this.readPKCS8PrvKeyHex=function(t){
if(!1===h(t))throw new e("not ASN.1 hex string");var n,r,i;try{c(t,0,[1,0],"06"),n=c(t,0,[1,1],"06"),r=c(t,0,[2,0,1],"04");try{i=c(t,0,[2,0,"[1]",0],"03")}catch(t){}}catch(t){
throw new e("malformed PKCS#8 plain ECC private key")}if(this.curveName=a(n),void 0===this.curveName)throw new e("unsupported curve name");this.setNamedCurve(this.curveName),this.setPublicKeyHex(i),
this.setPrivateKeyHex(r),this.isPublic=!1},this.readPKCS8PubKeyHex=function(t){if(!1===h(t))throw new e("not ASN.1 hex string");var n,r;try{c(t,0,[0,0],"06"),n=c(t,0,[0,1],"06"),r=c(t,0,[1],"03")
}catch(t){throw new e("malformed PKCS#8 ECC public key")}if(this.curveName=a(n),null===this.curveName)throw new e("unsupported curve name");this.setNamedCurve(this.curveName),this.setPublicKeyHex(r)},
this.readCertPubKeyHex=function(t,n){if(!1===h(t))throw new e("not ASN.1 hex string");var r,i;try{r=c(t,0,[0,5,0,1],"06"),i=c(t,0,[0,5,1],"03")}catch(t){
throw new e("malformed X.509 certificate ECC public key")}if(this.curveName=a(r),null===this.curveName)throw new e("unsupported curve name");this.setNamedCurve(this.curveName),this.setPublicKeyHex(i)
},void 0!==t&&void 0!==t.curve&&(this.curveName=t.curve),void 0===this.curveName&&(this.curveName="secp256r1"),this.setNamedCurve(this.curveName),
void 0!==t&&(void 0!==t.prv&&this.setPrivateKeyHex(t.prv),void 0!==t.pub&&this.setPublicKeyHex(t.pub))},ht.crypto.ECDSA.parseSigHex=function(t){var e=ht.crypto.ECDSA.parseSigHexInHexRS(t);return{
r:new _(e.r,16),s:new _(e.s,16)}},ht.crypto.ECDSA.parseSigHexInHexRS=function(t){var e=dt,n=e.getChildIdx,r=e.getV;if(e.checkStrictDER(t,0),
"30"!=t.substr(0,2))throw new Error("signature is not a ASN.1 sequence");var i=n(t,0);if(2!=i.length)throw new Error("signature shall have two elements");var s=i[0],o=i[1]
;if("02"!=t.substr(s,2))throw new Error("1st item not ASN.1 integer");if("02"!=t.substr(o,2))throw new Error("2nd item not ASN.1 integer");return{r:r(t,s),s:r(t,o)}},
ht.crypto.ECDSA.asn1SigToConcatSig=function(t){var e=ht.crypto.ECDSA.parseSigHexInHexRS(t),n=e.r,r=e.s;if("00"==n.substr(0,2)&&n.length%32==2&&(n=n.substr(2)),
"00"==r.substr(0,2)&&r.length%32==2&&(r=r.substr(2)),n.length%32==30&&(n="00"+n),r.length%32==30&&(r="00"+r),n.length%32!=0)throw"unknown ECDSA sig r length error"
;if(r.length%32!=0)throw"unknown ECDSA sig s length error";return n+r},ht.crypto.ECDSA.concatSigToASN1Sig=function(t){if(t.length/2*8%128!=0)throw"unknown ECDSA concatinated r-s sig  length error"
;var e=t.substr(0,t.length/2),n=t.substr(t.length/2);return ht.crypto.ECDSA.hexRSSigToASN1Sig(e,n)},ht.crypto.ECDSA.hexRSSigToASN1Sig=function(t,e){var n=new _(t,16),r=new _(e,16)
;return ht.crypto.ECDSA.biRSSigToASN1Sig(n,r)},ht.crypto.ECDSA.biRSSigToASN1Sig=function(t,e){var n=ht.asn1,r=new n.DERInteger({bigint:t}),i=new n.DERInteger({bigint:e});return new n.DERSequence({
array:[r,i]}).getEncodedHex()},ht.crypto.ECDSA.getName=function(t){
return"2b8104001f"===t?"secp192k1":"2a8648ce3d030107"===t?"secp256r1":"2b8104000a"===t?"secp256k1":"2b81040021"===t?"secp224r1":"2b81040022"===t?"secp384r1":-1!=="|secp256r1|NIST P-256|P-256|prime256v1|".indexOf(t)?"secp256r1":-1!=="|secp256k1|".indexOf(t)?"secp256k1":-1!=="|secp224r1|NIST P-224|P-224|".indexOf(t)?"secp224r1":-1!=="|secp384r1|NIST P-384|P-384|".indexOf(t)?"secp384r1":null
},void 0!==ht&&ht||(ht={}),void 0!==ht.crypto&&ht.crypto||(ht.crypto={}),ht.crypto.ECParameterDB=new function(){var t={},e={};function n(t){return new _(t,16)}this.getByName=function(n){var r=n
;if(void 0!==e[r]&&(r=e[n]),void 0!==t[r])return t[r];throw"unregistered EC curve name: "+r},this.regist=function(r,i,s,o,a,u,c,h,l,f,d,p){t[r]={}
;var g=n(s),v=n(o),y=n(a),m=n(u),S=n(c),b=new ut(g,v,y),x=b.decodePointHex("04"+h+l);t[r].name=r,t[r].keylen=i,t[r].curve=b,t[r].G=x,t[r].n=m,t[r].h=S,t[r].oid=d,t[r].info=p
;for(var w=0;w<f.length;w++)e[f[w]]=r}
},ht.crypto.ECParameterDB.regist("secp128r1",128,"FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFC","E87579C11079F43DD824993C2CEE5ED3","FFFFFFFE0000000075A30D1B9038A115","1","161FF7528B899B2D0C28607CA52C5B86","CF5AC8395BAFEB13C02DA292DDED7A83",[],"","secp128r1 : SECG curve over a 128 bit prime field"),
ht.crypto.ECParameterDB.regist("secp160k1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFAC73","0","7","0100000000000000000001B8FA16DFAB9ACA16B6B3","1","3B4C382CE37AA192A4019E763036F4F5DD4D7EBB","938CF935318FDCED6BC28286531733C3F03C4FEE",[],"","secp160k1 : SECG curve over a 160 bit prime field"),
ht.crypto.ECParameterDB.regist("secp160r1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFC","1C97BEFC54BD7A8B65ACF89F81D4D4ADC565FA45","0100000000000000000001F4C8F927AED3CA752257","1","4A96B5688EF573284664698968C38BB913CBFC82","23A628553168947D59DCC912042351377AC5FB32",[],"","secp160r1 : SECG curve over a 160 bit prime field"),
ht.crypto.ECParameterDB.regist("secp192k1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFEE37","0","3","FFFFFFFFFFFFFFFFFFFFFFFE26F2FC170F69466A74DEFD8D","1","DB4FF10EC057E9AE26B07D0280B7F4341DA5D1B1EAE06C7D","9B2F2F6D9C5628A7844163D015BE86344082AA88D95E2F9D",[]),
ht.crypto.ECParameterDB.regist("secp192r1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFC","64210519E59C80E70FA7E9AB72243049FEB8DEECC146B9B1","FFFFFFFFFFFFFFFFFFFFFFFF99DEF836146BC9B1B4D22831","1","188DA80EB03090F67CBF20EB43A18800F4FF0AFD82FF1012","07192B95FFC8DA78631011ED6B24CDD573F977A11E794811",[]),
ht.crypto.ECParameterDB.regist("secp224r1",224,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF000000000000000000000001","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFE","B4050A850C04B3ABF54132565044B0B7D7BFD8BA270B39432355FFB4","FFFFFFFFFFFFFFFFFFFFFFFFFFFF16A2E0B8F03E13DD29455C5C2A3D","1","B70E0CBD6BB4BF7F321390B94A03C1D356C21122343280D6115C1D21","BD376388B5F723FB4C22DFE6CD4375A05A07476444D5819985007E34",[]),
ht.crypto.ECParameterDB.regist("secp256k1",256,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F","0","7","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141","1","79BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798","483ADA7726A3C4655DA4FBFC0E1108A8FD17B448A68554199C47D08FFB10D4B8",[]),
ht.crypto.ECParameterDB.regist("secp256r1",256,"FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFC","5AC635D8AA3A93E7B3EBBD55769886BC651D06B0CC53B0F63BCE3C3E27D2604B","FFFFFFFF00000000FFFFFFFFFFFFFFFFBCE6FAADA7179E84F3B9CAC2FC632551","1","6B17D1F2E12C4247F8BCE6E563A440F277037D812DEB33A0F4A13945D898C296","4FE342E2FE1A7F9B8EE7EB4A7C0F9E162BCE33576B315ECECBB6406837BF51F5",["NIST P-256","P-256","prime256v1"]),
ht.crypto.ECParameterDB.regist("secp384r1",384,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFC","B3312FA7E23EE7E4988E056BE3F82D19181D9C6EFE8141120314088F5013875AC656398D8A2ED19D2A85C8EDD3EC2AEF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC7634D81F4372DDF581A0DB248B0A77AECEC196ACCC52973","1","AA87CA22BE8B05378EB1C71EF320AD746E1D3B628BA79B9859F741E082542A385502F25DBF55296C3A545E3872760AB7","3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f",["NIST P-384","P-384"]),
ht.crypto.ECParameterDB.regist("secp521r1",521,"1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC","051953EB9618E1C9A1F929A21A0B68540EEA2DA725B99B315F3B8B489918EF109E156193951EC7E937B1652C0BD3BB1BF073573DF883D2C34F1EF451FD46B503F00","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA51868783BF2F966B7FCC0148F709A5D03BB5C9B8899C47AEBB6FB71E91386409","1","C6858E06B70404E9CD9E3ECB662395B4429C648139053FB521F828AF606B4D3DBAA14B5E77EFE75928FE1DC127A2FFA8DE3348B3C1856A429BF97E7E31C2E5BD66","011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650",["NIST P-521","P-521"]),
void 0!==ht&&ht||(ht={}),void 0!==ht.crypto&&ht.crypto||(ht.crypto={}),ht.crypto.DSA=function(){var t=dt,e=(t.getVbyList,t.getVbyListEx),n=t.isASN1HEX,r=_;this.p=null,this.q=null,this.g=null,
this.y=null,this.x=null,this.type="DSA",this.isPrivate=!1,this.isPublic=!1,this.setPrivate=function(t,e,n,r,i){this.isPrivate=!0,this.p=t,this.q=e,this.g=n,this.y=r,this.x=i},
this.setPrivateHex=function(t,e,n,r,i){var s,o,a,u,c;s=new _(t,16),o=new _(e,16),a=new _(n,16),u="string"==typeof r&&r.length>1?new _(r,16):null,c=new _(i,16),this.setPrivate(s,o,a,u,c)},
this.setPublic=function(t,e,n,r){this.isPublic=!0,this.p=t,this.q=e,this.g=n,this.y=r,this.x=null},this.setPublicHex=function(t,e,n,r){var i,s,o,a;i=new _(t,16),s=new _(e,16),o=new _(n,16),
a=new _(r,16),this.setPublic(i,s,o,a)},this.signWithMessageHash=function(t){var e=this.p,n=this.q,r=this.g,i=(this.y,
this.x),s=ht.crypto.Util.getRandomBigIntegerMinToMax(_.ONE.add(_.ONE),n.subtract(_.ONE)),o=new _(t.substr(0,n.bitLength()/4),16),a=r.modPow(s,e).mod(n),u=s.modInverse(n).multiply(o.add(i.multiply(a))).mod(n)
;return ht.asn1.ASN1Util.jsonToASN1HEX({seq:[{int:{bigint:a}},{int:{bigint:u}}]})},this.verifyWithMessageHash=function(t,e){
var n=this.p,r=this.q,i=this.g,s=this.y,o=this.parseASN1Signature(e),a=o[0],u=o[1],c=new _(t.substr(0,r.bitLength()/4),16);if(_.ZERO.compareTo(a)>0||a.compareTo(r)>0)throw"invalid DSA signature"
;if(_.ZERO.compareTo(u)>=0||u.compareTo(r)>0)throw"invalid DSA signature";var h=u.modInverse(r),l=c.multiply(h).mod(r),f=a.multiply(h).mod(r)
;return 0==i.modPow(l,n).multiply(s.modPow(f,n)).mod(n).mod(r).compareTo(a)},this.parseASN1Signature=function(t){try{return[new r(e(t,0,[0],"02"),16),new r(e(t,0,[1],"02"),16)]}catch(t){
throw new Error("malformed ASN.1 DSA signature")}},this.readPKCS5PrvKeyHex=function(t){var r,i,s,o,a;if(!1===n(t))throw new Error("not ASN.1 hex string");try{r=e(t,0,[1],"02"),i=e(t,0,[2],"02"),
s=e(t,0,[3],"02"),o=e(t,0,[4],"02"),a=e(t,0,[5],"02")}catch(t){throw new Error("malformed PKCS#1/5 plain DSA private key")}this.setPrivateHex(r,i,s,o,a)},this.readPKCS8PrvKeyHex=function(t){
var r,i,s,o;if(!1===n(t))throw new Error("not ASN.1 hex string");try{r=e(t,0,[1,1,0],"02"),i=e(t,0,[1,1,1],"02"),s=e(t,0,[1,1,2],"02"),o=e(t,0,[2,0],"02")}catch(t){
throw new Error("malformed PKCS#8 plain DSA private key")}this.setPrivateHex(r,i,s,null,o)},this.readPKCS8PubKeyHex=function(t){var r,i,s,o;if(!1===n(t))throw new Error("not ASN.1 hex string");try{
r=e(t,0,[0,1,0],"02"),i=e(t,0,[0,1,1],"02"),s=e(t,0,[0,1,2],"02"),o=e(t,0,[1,0],"02")}catch(t){throw new Error("malformed PKCS#8 DSA public key")}this.setPublicHex(r,i,s,o)},
this.readCertPubKeyHex=function(t,r){var i,s,o,a;if(!1===n(t))throw new Error("not ASN.1 hex string");try{i=e(t,0,[0,5,0,1,0],"02"),s=e(t,0,[0,5,0,1,1],"02"),o=e(t,0,[0,5,0,1,2],"02"),
a=e(t,0,[0,5,1,0],"02")}catch(t){throw new Error("malformed X.509 certificate DSA public key")}this.setPublicHex(i,s,o,a)}};var Ut=function(){var t=function(t,n,r){return e(y.AES,t,n,r)
},e=function(t,e,n,r){var i=y.enc.Hex.parse(e),s=y.enc.Hex.parse(n),o=y.enc.Hex.parse(r),a={};a.key=s,a.iv=o,a.ciphertext=i;var u=t.decrypt(a,s,{iv:o});return y.enc.Hex.stringify(u)
},n=function(t,e,n){return r(y.AES,t,e,n)},r=function(t,e,n,r){var i=y.enc.Hex.parse(e),s=y.enc.Hex.parse(n),o=y.enc.Hex.parse(r),a=t.encrypt(i,s,{iv:o}),u=y.enc.Hex.parse(a.toString())
;return y.enc.Base64.stringify(u)},i={"AES-256-CBC":{proc:t,eproc:n,keylen:32,ivlen:16},"AES-192-CBC":{proc:t,eproc:n,keylen:24,ivlen:16},"AES-128-CBC":{proc:t,eproc:n,keylen:16,ivlen:16},
"DES-EDE3-CBC":{proc:function(t,n,r){return e(y.TripleDES,t,n,r)},eproc:function(t,e,n){return r(y.TripleDES,t,e,n)},keylen:24,ivlen:8},"DES-CBC":{proc:function(t,n,r){return e(y.DES,t,n,r)},
eproc:function(t,e,n){return r(y.DES,t,e,n)},keylen:8,ivlen:8}},s=function(t){var e={},n=t.match(new RegExp("DEK-Info: ([^,]+),([0-9A-Fa-f]+)","m"));n&&(e.cipher=n[1],e.ivsalt=n[2])
;var r=t.match(new RegExp("-----BEGIN ([A-Z]+) PRIVATE KEY-----"));r&&(e.type=r[1]);var i=-1,s=0;-1!=t.indexOf("\r\n\r\n")&&(i=t.indexOf("\r\n\r\n"),s=2),-1!=t.indexOf("\n\n")&&(i=t.indexOf("\n\n"),
s=1);var o=t.indexOf("-----END");if(-1!=i&&-1!=o){var a=t.substring(i+2*s,o-s);a=a.replace(/\s+/g,""),e.data=a}return e},o=function(t,e,n){
for(var r=n.substring(0,16),s=y.enc.Hex.parse(r),o=y.enc.Utf8.parse(e),a=i[t].keylen+i[t].ivlen,u="",c=null;;){var h=y.algo.MD5.create();if(null!=c&&h.update(c),h.update(o),h.update(s),c=h.finalize(),
(u+=y.enc.Hex.stringify(c)).length>=2*a)break}var l={};return l.keyhex=u.substr(0,2*i[t].keylen),l.ivhex=u.substr(2*i[t].keylen,2*i[t].ivlen),l},a=function(t,e,n,r){
var s=y.enc.Base64.parse(t),o=y.enc.Hex.stringify(s);return(0,i[e].proc)(o,n,r)};return{version:"1.0.0",parsePKCS5PEM:function(t){return s(t)},getKeyAndUnusedIvByPasscodeAndIvsalt:function(t,e,n){
return o(t,e,n)},decryptKeyB64:function(t,e,n,r){return a(t,e,n,r)},getDecryptedKeyHex:function(t,e){var n=s(t),r=(n.type,n.cipher),i=n.ivsalt,u=n.data,c=o(r,e,i).keyhex;return a(u,r,c,i)},
getEncryptedPKCS5PEMFromPrvKeyHex:function(t,e,n,r,s){var a="";if(void 0!==r&&null!=r||(r="AES-256-CBC"),void 0===i[r])throw"KEYUTIL unsupported algorithm: "+r;void 0!==s&&null!=s||(s=function(t){
var e=y.lib.WordArray.random(t);return y.enc.Hex.stringify(e)}(i[r].ivlen).toUpperCase());var u=function(t,e,n,r){return(0,i[e].eproc)(t,n,r)}(e,r,o(r,n,s).keyhex,s)
;a="-----BEGIN "+t+" PRIVATE KEY-----\r\n";return a+="Proc-Type: 4,ENCRYPTED\r\n",a+="DEK-Info: "+r+","+s+"\r\n",a+="\r\n",a+=u.replace(/(.{64})/g,"$1\r\n"),
a+="\r\n-----END "+t+" PRIVATE KEY-----\r\n"},parseHexOfEncryptedPKCS8:function(t){var e=dt,n=e.getChildIdx,r=e.getV,i={},s=n(t,0)
;if(2!=s.length)throw"malformed format: SEQUENCE(0).items != 2: "+s.length;i.ciphertext=r(t,s[1]);var o=n(t,s[0]);if(2!=o.length)throw"malformed format: SEQUENCE(0.0).items != 2: "+o.length
;if("2a864886f70d01050d"!=r(t,o[0]))throw"this only supports pkcs5PBES2";var a=n(t,o[1]);if(2!=o.length)throw"malformed format: SEQUENCE(0.0.1).items != 2: "+a.length;var u=n(t,a[1])
;if(2!=u.length)throw"malformed format: SEQUENCE(0.0.1.1).items != 2: "+u.length;if("2a864886f70d0307"!=r(t,u[0]))throw"this only supports TripleDES";i.encryptionSchemeAlg="TripleDES",
i.encryptionSchemeIV=r(t,u[1]);var c=n(t,a[0]);if(2!=c.length)throw"malformed format: SEQUENCE(0.0.1.0).items != 2: "+c.length;if("2a864886f70d01050c"!=r(t,c[0]))throw"this only supports pkcs5PBKDF2"
;var h=n(t,c[1]);if(h.length<2)throw"malformed format: SEQUENCE(0.0.1.0.1).items < 2: "+h.length;i.pbkdf2Salt=r(t,h[0]);var l=r(t,h[1]);try{i.pbkdf2Iter=parseInt(l,16)}catch(t){
throw"malformed format pbkdf2Iter: "+l}return i},getPBKDF2KeyHexFromParam:function(t,e){var n=y.enc.Hex.parse(t.pbkdf2Salt),r=t.pbkdf2Iter,i=y.PBKDF2(e,n,{keySize:6,iterations:r})
;return y.enc.Hex.stringify(i)},_getPlainPKCS8HexFromEncryptedPKCS8PEM:function(t,e){var n=Pt(t,"ENCRYPTED PRIVATE KEY"),r=this.parseHexOfEncryptedPKCS8(n),i=Ut.getPBKDF2KeyHexFromParam(r,e),s={}
;s.ciphertext=y.enc.Hex.parse(r.ciphertext);var o=y.enc.Hex.parse(i),a=y.enc.Hex.parse(r.encryptionSchemeIV),u=y.TripleDES.decrypt(s,o,{iv:a});return y.enc.Hex.stringify(u)},
getKeyFromEncryptedPKCS8PEM:function(t,e){var n=this._getPlainPKCS8HexFromEncryptedPKCS8PEM(t,e);return this.getKeyFromPlainPrivatePKCS8Hex(n)},parsePlainPrivatePKCS8Hex:function(t){
var e=dt,n=e.getChildIdx,r=e.getV,i={algparam:null};if("30"!=t.substr(0,2))throw"malformed plain PKCS8 private key(code:001)";var s=n(t,0)
;if(3!=s.length)throw"malformed plain PKCS8 private key(code:002)";if("30"!=t.substr(s[1],2))throw"malformed PKCS8 private key(code:003)";var o=n(t,s[1])
;if(2!=o.length)throw"malformed PKCS8 private key(code:004)";if("06"!=t.substr(o[0],2))throw"malformed PKCS8 private key(code:005)";if(i.algoid=r(t,o[0]),
"06"==t.substr(o[1],2)&&(i.algparam=r(t,o[1])),"04"!=t.substr(s[2],2))throw"malformed PKCS8 private key(code:006)";return i.keyidx=e.getVidx(t,s[2]),i},getKeyFromPlainPrivatePKCS8PEM:function(t){
var e=Pt(t,"PRIVATE KEY");return this.getKeyFromPlainPrivatePKCS8Hex(e)},getKeyFromPlainPrivatePKCS8Hex:function(t){var e,n=this.parsePlainPrivatePKCS8Hex(t)
;if("2a864886f70d010101"==n.algoid)e=new it;else if("2a8648ce380401"==n.algoid)e=new ht.crypto.DSA;else{if("2a8648ce3d0201"!=n.algoid)throw"unsupported private key algorithm";e=new ht.crypto.ECDSA}
return e.readPKCS8PrvKeyHex(t),e},_getKeyFromPublicPKCS8Hex:function(t){var e,n=dt.getVbyList(t,0,[0,0],"06")
;if("2a864886f70d010101"===n)e=new it;else if("2a8648ce380401"===n)e=new ht.crypto.DSA;else{if("2a8648ce3d0201"!==n)throw"unsupported PKCS#8 public key hex";e=new ht.crypto.ECDSA}
return e.readPKCS8PubKeyHex(t),e},parsePublicRawRSAKeyHex:function(t){var e=dt,n=e.getChildIdx,r=e.getV,i={};if("30"!=t.substr(0,2))throw"malformed RSA key(code:001)";var s=n(t,0)
;if(2!=s.length)throw"malformed RSA key(code:002)";if("02"!=t.substr(s[0],2))throw"malformed RSA key(code:003)";if(i.n=r(t,s[0]),"02"!=t.substr(s[1],2))throw"malformed RSA key(code:004)"
;return i.e=r(t,s[1]),i},parsePublicPKCS8Hex:function(t){var e=dt,n=e.getChildIdx,r=e.getV,i={algparam:null},s=n(t,0);if(2!=s.length)throw"outer DERSequence shall have 2 elements: "+s.length
;var o=s[0];if("30"!=t.substr(o,2))throw"malformed PKCS8 public key(code:001)";var a=n(t,o);if(2!=a.length)throw"malformed PKCS8 public key(code:002)"
;if("06"!=t.substr(a[0],2))throw"malformed PKCS8 public key(code:003)";if(i.algoid=r(t,a[0]),"06"==t.substr(a[1],2)?i.algparam=r(t,a[1]):"30"==t.substr(a[1],2)&&(i.algparam={},
i.algparam.p=e.getVbyList(t,a[1],[0],"02"),i.algparam.q=e.getVbyList(t,a[1],[1],"02"),i.algparam.g=e.getVbyList(t,a[1],[2],"02")),"03"!=t.substr(s[1],2))throw"malformed PKCS8 public key(code:004)"
;return i.key=r(t,s[1]).substr(2),i}}}();Ut.getKey=function(t,e,n){var r=(v=dt).getChildIdx,i=(v.getV,v.getVbyList),s=ht.crypto,o=s.ECDSA,a=s.DSA,u=it,c=Pt,h=Ut;if(void 0!==u&&t instanceof u)return t
;if(void 0!==o&&t instanceof o)return t;if(void 0!==a&&t instanceof a)return t;if(void 0!==t.curve&&void 0!==t.xy&&void 0===t.d)return new o({pub:t.xy,curve:t.curve})
;if(void 0!==t.curve&&void 0!==t.d)return new o({prv:t.d,curve:t.curve});if(void 0===t.kty&&void 0!==t.n&&void 0!==t.e&&void 0===t.d)return(k=new u).setPublic(t.n,t.e),k
;if(void 0===t.kty&&void 0!==t.n&&void 0!==t.e&&void 0!==t.d&&void 0!==t.p&&void 0!==t.q&&void 0!==t.dp&&void 0!==t.dq&&void 0!==t.co&&void 0===t.qi)return(k=new u).setPrivateEx(t.n,t.e,t.d,t.p,t.q,t.dp,t.dq,t.co),
k;if(void 0===t.kty&&void 0!==t.n&&void 0!==t.e&&void 0!==t.d&&void 0===t.p)return(k=new u).setPrivate(t.n,t.e,t.d),k
;if(void 0!==t.p&&void 0!==t.q&&void 0!==t.g&&void 0!==t.y&&void 0===t.x)return(k=new a).setPublic(t.p,t.q,t.g,t.y),k
;if(void 0!==t.p&&void 0!==t.q&&void 0!==t.g&&void 0!==t.y&&void 0!==t.x)return(k=new a).setPrivate(t.p,t.q,t.g,t.y,t.x),k
;if("RSA"===t.kty&&void 0!==t.n&&void 0!==t.e&&void 0===t.d)return(k=new u).setPublic(xt(t.n),xt(t.e)),k
;if("RSA"===t.kty&&void 0!==t.n&&void 0!==t.e&&void 0!==t.d&&void 0!==t.p&&void 0!==t.q&&void 0!==t.dp&&void 0!==t.dq&&void 0!==t.qi)return(k=new u).setPrivateEx(xt(t.n),xt(t.e),xt(t.d),xt(t.p),xt(t.q),xt(t.dp),xt(t.dq),xt(t.qi)),
k;if("RSA"===t.kty&&void 0!==t.n&&void 0!==t.e&&void 0!==t.d)return(k=new u).setPrivate(xt(t.n),xt(t.e),xt(t.d)),k;if("EC"===t.kty&&void 0!==t.crv&&void 0!==t.x&&void 0!==t.y&&void 0===t.d){
var l=(C=new o({curve:t.crv})).ecparams.keylen/4,f="04"+("0000000000"+xt(t.x)).slice(-l)+("0000000000"+xt(t.y)).slice(-l);return C.setPublicKeyHex(f),C}
if("EC"===t.kty&&void 0!==t.crv&&void 0!==t.x&&void 0!==t.y&&void 0!==t.d){l=(C=new o({curve:t.crv})).ecparams.keylen/4,f="04"+("0000000000"+xt(t.x)).slice(-l)+("0000000000"+xt(t.y)).slice(-l)
;var d=("0000000000"+xt(t.d)).slice(-l);return C.setPublicKeyHex(f),C.setPrivateKeyHex(d),C}if("pkcs5prv"===n){var p,g=t,v=dt
;if(9===(p=r(g,0)).length)(k=new u).readPKCS5PrvKeyHex(g);else if(6===p.length)(k=new a).readPKCS5PrvKeyHex(g);else{
if(!(p.length>2&&"04"===g.substr(p[1],2)))throw"unsupported PKCS#1/5 hexadecimal key";(k=new o).readPKCS5PrvKeyHex(g)}return k}if("pkcs8prv"===n)return k=h.getKeyFromPlainPrivatePKCS8Hex(t)
;if("pkcs8pub"===n)return h._getKeyFromPublicPKCS8Hex(t);if("x509pub"===n)return Wt.getPublicKeyFromCertHex(t)
;if(-1!=t.indexOf("-END CERTIFICATE-",0)||-1!=t.indexOf("-END X509 CERTIFICATE-",0)||-1!=t.indexOf("-END TRUSTED CERTIFICATE-",0))return Wt.getPublicKeyFromCertPEM(t)
;if(-1!=t.indexOf("-END PUBLIC KEY-")){var y=Pt(t,"PUBLIC KEY");return h._getKeyFromPublicPKCS8Hex(y)}if(-1!=t.indexOf("-END RSA PRIVATE KEY-")&&-1==t.indexOf("4,ENCRYPTED")){
var m=c(t,"RSA PRIVATE KEY");return h.getKey(m,null,"pkcs5prv")}if(-1!=t.indexOf("-END DSA PRIVATE KEY-")&&-1==t.indexOf("4,ENCRYPTED")){
var S=i(R=c(t,"DSA PRIVATE KEY"),0,[1],"02"),b=i(R,0,[2],"02"),x=i(R,0,[3],"02"),w=i(R,0,[4],"02"),E=i(R,0,[5],"02")
;return(k=new a).setPrivate(new _(S,16),new _(b,16),new _(x,16),new _(w,16),new _(E,16)),k}if(-1!=t.indexOf("-END EC PRIVATE KEY-")&&-1==t.indexOf("4,ENCRYPTED")){m=c(t,"EC PRIVATE KEY")
;return h.getKey(m,null,"pkcs5prv")}if(-1!=t.indexOf("-END PRIVATE KEY-"))return h.getKeyFromPlainPrivatePKCS8PEM(t);if(-1!=t.indexOf("-END RSA PRIVATE KEY-")&&-1!=t.indexOf("4,ENCRYPTED")){
var A=h.getDecryptedKeyHex(t,e),F=new it;return F.readPKCS5PrvKeyHex(A),F}if(-1!=t.indexOf("-END EC PRIVATE KEY-")&&-1!=t.indexOf("4,ENCRYPTED")){
var C,k=i(R=h.getDecryptedKeyHex(t,e),0,[1],"04"),T=i(R,0,[2,0],"06"),P=i(R,0,[3,0],"03").substr(2);if(void 0===ht.crypto.OID.oidhex2name[T])throw"undefined OID(hex) in KJUR.crypto.OID: "+T
;return(C=new o({curve:ht.crypto.OID.oidhex2name[T]})).setPublicKeyHex(P),C.setPrivateKeyHex(k),C.isPublic=!1,C}if(-1!=t.indexOf("-END DSA PRIVATE KEY-")&&-1!=t.indexOf("4,ENCRYPTED")){var R
;S=i(R=h.getDecryptedKeyHex(t,e),0,[1],"02"),b=i(R,0,[2],"02"),x=i(R,0,[3],"02"),w=i(R,0,[4],"02"),E=i(R,0,[5],"02")
;return(k=new a).setPrivate(new _(S,16),new _(b,16),new _(x,16),new _(w,16),new _(E,16)),k}if(-1!=t.indexOf("-END ENCRYPTED PRIVATE KEY-"))return h.getKeyFromEncryptedPKCS8PEM(t,e)
;throw new Error("not supported argument")},Ut.generateKeypair=function(t,e){if("RSA"==t){var n=e;(o=new it).generate(n,"10001"),o.isPrivate=!0,o.isPublic=!0
;var r=new it,i=o.n.toString(16),s=o.e.toString(16);return r.setPublic(i,s),r.isPrivate=!1,r.isPublic=!0,(a={}).prvKeyObj=o,a.pubKeyObj=r,a}if("EC"==t){var o,a,u=e,c=new ht.crypto.ECDSA({curve:u
}).generateKeyPairHex();return(o=new ht.crypto.ECDSA({curve:u})).setPublicKeyHex(c.ecpubhex),o.setPrivateKeyHex(c.ecprvhex),o.isPrivate=!0,o.isPublic=!1,(r=new ht.crypto.ECDSA({curve:u
})).setPublicKeyHex(c.ecpubhex),r.isPrivate=!1,r.isPublic=!0,(a={}).prvKeyObj=o,a.pubKeyObj=r,a}throw"unknown algorithm: "+t},Ut.getPEM=function(t,e,n,r,i,s){
var o=ht,a=o.asn1,u=a.DERObjectIdentifier,c=a.DERInteger,h=a.ASN1Util.newObject,l=a.x509.SubjectPublicKeyInfo,f=o.crypto,d=f.DSA,p=f.ECDSA,g=it;function v(t){return h({seq:[{int:0},{int:{bigint:t.n}
},{int:t.e},{int:{bigint:t.d}},{int:{bigint:t.p}},{int:{bigint:t.q}},{int:{bigint:t.dmp1}},{int:{bigint:t.dmq1}},{int:{bigint:t.coeff}}]})}function m(t){return h({seq:[{int:1},{octstr:{hex:t.prvKeyHex
}},{tag:["a0",!0,{oid:{name:t.curveName}}]},{tag:["a1",!0,{bitstr:{hex:"00"+t.pubKeyHex}}]}]})}function S(t){return h({seq:[{int:0},{int:{bigint:t.p}},{int:{bigint:t.q}},{int:{bigint:t.g}},{int:{
bigint:t.y}},{int:{bigint:t.x}}]})}
if((void 0!==g&&t instanceof g||void 0!==d&&t instanceof d||void 0!==p&&t instanceof p)&&1==t.isPublic&&(void 0===e||"PKCS8PUB"==e))return Tt(_=new l(t).getEncodedHex(),"PUBLIC KEY")
;if("PKCS1PRV"==e&&void 0!==g&&t instanceof g&&(void 0===n||null==n)&&1==t.isPrivate)return Tt(_=v(t).getEncodedHex(),"RSA PRIVATE KEY")
;if("PKCS1PRV"==e&&void 0!==p&&t instanceof p&&(void 0===n||null==n)&&1==t.isPrivate){var b=new u({name:t.curveName}).getEncodedHex(),x=m(t).getEncodedHex(),w="";return w+=Tt(b,"EC PARAMETERS"),
w+=Tt(x,"EC PRIVATE KEY")}if("PKCS1PRV"==e&&void 0!==d&&t instanceof d&&(void 0===n||null==n)&&1==t.isPrivate)return Tt(_=S(t).getEncodedHex(),"DSA PRIVATE KEY")
;if("PKCS5PRV"==e&&void 0!==g&&t instanceof g&&void 0!==n&&null!=n&&1==t.isPrivate){var _=v(t).getEncodedHex();return void 0===r&&(r="DES-EDE3-CBC"),
this.getEncryptedPKCS5PEMFromPrvKeyHex("RSA",_,n,r,s)}if("PKCS5PRV"==e&&void 0!==p&&t instanceof p&&void 0!==n&&null!=n&&1==t.isPrivate){_=m(t).getEncodedHex();return void 0===r&&(r="DES-EDE3-CBC"),
this.getEncryptedPKCS5PEMFromPrvKeyHex("EC",_,n,r,s)}if("PKCS5PRV"==e&&void 0!==d&&t instanceof d&&void 0!==n&&null!=n&&1==t.isPrivate){_=S(t).getEncodedHex();return void 0===r&&(r="DES-EDE3-CBC"),
this.getEncryptedPKCS5PEMFromPrvKeyHex("DSA",_,n,r,s)}var E=function(t,e){var n=A(t,e);return new h({seq:[{seq:[{oid:{name:"pkcs5PBES2"}},{seq:[{seq:[{oid:{name:"pkcs5PBKDF2"}},{seq:[{octstr:{
hex:n.pbkdf2Salt}},{int:n.pbkdf2Iter}]}]},{seq:[{oid:{name:"des-EDE3-CBC"}},{octstr:{hex:n.encryptionSchemeIV}}]}]}]},{octstr:{hex:n.ciphertext}}]}).getEncodedHex()},A=function(t,e){
var n=y.lib.WordArray.random(8),r=y.lib.WordArray.random(8),i=y.PBKDF2(e,n,{keySize:6,iterations:100}),s=y.enc.Hex.parse(t),o=y.TripleDES.encrypt(s,i,{iv:r})+"",a={};return a.ciphertext=o,
a.pbkdf2Salt=y.enc.Hex.stringify(n),a.pbkdf2Iter=100,a.encryptionSchemeAlg="DES-EDE3-CBC",a.encryptionSchemeIV=y.enc.Hex.stringify(r),a};if("PKCS8PRV"==e&&null!=g&&t instanceof g&&1==t.isPrivate){
var F=v(t).getEncodedHex();_=h({seq:[{int:0},{seq:[{oid:{name:"rsaEncryption"}},{null:!0}]},{octstr:{hex:F}}]}).getEncodedHex()
;return void 0===n||null==n?Tt(_,"PRIVATE KEY"):Tt(x=E(_,n),"ENCRYPTED PRIVATE KEY")}if("PKCS8PRV"==e&&void 0!==p&&t instanceof p&&1==t.isPrivate){F=new h({seq:[{int:1},{octstr:{hex:t.prvKeyHex}},{
tag:["a1",!0,{bitstr:{hex:"00"+t.pubKeyHex}}]}]}).getEncodedHex(),_=h({seq:[{int:0},{seq:[{oid:{name:"ecPublicKey"}},{oid:{name:t.curveName}}]},{octstr:{hex:F}}]}).getEncodedHex()
;return void 0===n||null==n?Tt(_,"PRIVATE KEY"):Tt(x=E(_,n),"ENCRYPTED PRIVATE KEY")}if("PKCS8PRV"==e&&void 0!==d&&t instanceof d&&1==t.isPrivate){F=new c({bigint:t.x}).getEncodedHex(),_=h({seq:[{
int:0},{seq:[{oid:{name:"dsa"}},{seq:[{int:{bigint:t.p}},{int:{bigint:t.q}},{int:{bigint:t.g}}]}]},{octstr:{hex:F}}]}).getEncodedHex()
;return void 0===n||null==n?Tt(_,"PRIVATE KEY"):Tt(x=E(_,n),"ENCRYPTED PRIVATE KEY")}throw"unsupported object nor format"},Ut.getKeyFromCSRPEM=function(t){var e=Pt(t,"CERTIFICATE REQUEST")
;return Ut.getKeyFromCSRHex(e)},Ut.getKeyFromCSRHex=function(t){var e=Ut.parseCSRHex(t);return Ut.getKey(e.p8pubkeyhex,null,"pkcs8pub")},Ut.parseCSRHex=function(t){
var e=dt,n=e.getChildIdx,r=e.getTLV,i={},s=t;if("30"!=s.substr(0,2))throw"malformed CSR(code:001)";var o=n(s,0);if(o.length<1)throw"malformed CSR(code:002)"
;if("30"!=s.substr(o[0],2))throw"malformed CSR(code:003)";var a=n(s,o[0]);if(a.length<3)throw"malformed CSR(code:004)";return i.p8pubkeyhex=r(s,a[2]),i},Ut.getKeyID=function(t){var e=Ut,n=dt
;"string"==typeof t&&-1!=t.indexOf("BEGIN ")&&(t=e.getKey(t));var r=Pt(e.getPEM(t)),i=n.getIdxbyList(r,0,[1]),s=n.getV(r,i).substring(2);return ht.crypto.Util.hashHex(s,"sha1")},
Ut.getJWKFromKey=function(t){var e={};if(t instanceof it&&t.isPrivate)return e.kty="RSA",e.n=bt(t.n.toString(16)),e.e=bt(t.e.toString(16)),e.d=bt(t.d.toString(16)),e.p=bt(t.p.toString(16)),
e.q=bt(t.q.toString(16)),e.dp=bt(t.dmp1.toString(16)),e.dq=bt(t.dmq1.toString(16)),e.qi=bt(t.coeff.toString(16)),e;if(t instanceof it&&t.isPublic)return e.kty="RSA",e.n=bt(t.n.toString(16)),
e.e=bt(t.e.toString(16)),e;if(t instanceof ht.crypto.ECDSA&&t.isPrivate){if("P-256"!==(r=t.getShortNISTPCurveName())&&"P-384"!==r)throw"unsupported curve name for JWT: "+r;var n=t.getPublicKeyXYHex()
;return e.kty="EC",e.crv=r,e.x=bt(n.x),e.y=bt(n.y),e.d=bt(t.prvKeyHex),e}if(t instanceof ht.crypto.ECDSA&&t.isPublic){var r
;if("P-256"!==(r=t.getShortNISTPCurveName())&&"P-384"!==r)throw"unsupported curve name for JWT: "+r;n=t.getPublicKeyXYHex();return e.kty="EC",e.crv=r,e.x=bt(n.x),e.y=bt(n.y),e}
throw"not supported key object"},it.getPosArrayOfChildrenFromHex=function(t){return dt.getChildIdx(t,0)},it.getHexValueArrayOfChildrenFromHex=function(t){
var e,n=dt.getV,r=n(t,(e=it.getPosArrayOfChildrenFromHex(t))[0]),i=n(t,e[1]),s=n(t,e[2]),o=n(t,e[3]),a=n(t,e[4]),u=n(t,e[5]),c=n(t,e[6]),h=n(t,e[7]),l=n(t,e[8])
;return(e=new Array).push(r,i,s,o,a,u,c,h,l),e},it.prototype.readPrivateKeyFromPEMString=function(t){var e=Pt(t),n=it.getHexValueArrayOfChildrenFromHex(e)
;this.setPrivateEx(n[1],n[2],n[3],n[4],n[5],n[6],n[7],n[8])},it.prototype.readPKCS5PrvKeyHex=function(t){var e=it.getHexValueArrayOfChildrenFromHex(t)
;this.setPrivateEx(e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8])},it.prototype.readPKCS8PrvKeyHex=function(t){var e,n,r,i,s,o,a,u,c=dt,h=c.getVbyListEx
;if(!1===c.isASN1HEX(t))throw new Error("not ASN.1 hex string");try{e=h(t,0,[2,0,1],"02"),n=h(t,0,[2,0,2],"02"),r=h(t,0,[2,0,3],"02"),i=h(t,0,[2,0,4],"02"),s=h(t,0,[2,0,5],"02"),o=h(t,0,[2,0,6],"02"),
a=h(t,0,[2,0,7],"02"),u=h(t,0,[2,0,8],"02")}catch(t){throw new Error("malformed PKCS#8 plain RSA private key")}this.setPrivateEx(e,n,r,i,s,o,a,u)},it.prototype.readPKCS5PubKeyHex=function(t){
var e=dt,n=e.getV;if(!1===e.isASN1HEX(t))throw"keyHex is not ASN.1 hex string";var r=e.getChildIdx(t,0)
;if(2!==r.length||"02"!==t.substr(r[0],2)||"02"!==t.substr(r[1],2))throw"wrong hex for PKCS#5 public key";var i=n(t,r[0]),s=n(t,r[1]);this.setPublic(i,s)},it.prototype.readPKCS8PubKeyHex=function(t){
var e=dt;if(!1===e.isASN1HEX(t))throw new Error("not ASN.1 hex string");if("06092a864886f70d010101"!==e.getTLVbyListEx(t,0,[0,0]))throw new Error("not PKCS8 RSA public key")
;var n=e.getTLVbyListEx(t,0,[1,0]);this.readPKCS5PubKeyHex(n)},it.prototype.readCertPubKeyHex=function(t,e){var n,r;(n=new Wt).readCertHex(t),r=n.getPublicKeyHex(),this.readPKCS8PubKeyHex(r)}
;var Kt=new RegExp("[^0-9a-f]","gi");function Mt(t,e){for(var n="",r=e/4-t.length,i=0;i<r;i++)n+="0";return n+t}function qt(t,e,n){
for(var r="",i=0;r.length<e;)r+=Et(n(At(t+String.fromCharCode.apply(String,[(4278190080&i)>>24,(16711680&i)>>16,(65280&i)>>8,255&i])))),i+=1;return r}function zt(t){
for(var e in ht.crypto.Util.DIGESTINFOHEAD){var n=ht.crypto.Util.DIGESTINFOHEAD[e],r=n.length;if(t.substring(0,r)==n)return[e,t.substring(r)]}return[]}function Wt(){
var t,e=dt,n=e.getChildIdx,r=e.getV,i=e.getTLV,s=e.getVbyList,o=e.getVbyListEx,a=e.getTLVbyList,u=e.getTLVbyListEx,c=e.getIdxbyList,h=e.getVidx,l=e.oidname,f=Wt,d=Pt;try{
t=ht.asn1.x509.AlgorithmIdentifier.PSSNAME2ASN1TLV}catch(t){}this.hex=null,this.version=0,this.foffset=0,this.aExtInfo=null,this.getVersion=function(){
return null===this.hex||0!==this.version?this.version:"a003020102"!==a(this.hex,0,[0,0])?(this.version=1,this.foffset=-1,1):(this.version=3,3)},this.getSerialNumberHex=function(){
return s(this.hex,0,[0,1+this.foffset],"02")},this.getSignatureAlgorithmField=function(){var e=u(this.hex,0,[0,1]);for(var n in t)if(e===t[n])return n;return l(o(this.hex,0,[0,1,0],"06"))},
this.getIssuerHex=function(){return a(this.hex,0,[0,3+this.foffset],"30")},this.getIssuerString=function(){return f.hex2dn(this.getIssuerHex())},this.getSubjectHex=function(){
return a(this.hex,0,[0,5+this.foffset],"30")},this.getSubjectString=function(){return f.hex2dn(this.getSubjectHex())},this.getNotBefore=function(){var t=s(this.hex,0,[0,4+this.foffset,0])
;return t=t.replace(/(..)/g,"%$1"),t=decodeURIComponent(t)},this.getNotAfter=function(){var t=s(this.hex,0,[0,4+this.foffset,1]);return t=t.replace(/(..)/g,"%$1"),t=decodeURIComponent(t)},
this.getPublicKeyHex=function(){return e.getTLVbyList(this.hex,0,[0,6+this.foffset],"30")},this.getPublicKeyIdx=function(){return c(this.hex,0,[0,6+this.foffset],"30")},
this.getPublicKeyContentIdx=function(){var t=this.getPublicKeyIdx();return c(this.hex,t,[1,0],"30")},this.getPublicKey=function(){return Ut.getKey(this.getPublicKeyHex(),null,"pkcs8pub")},
this.getSignatureAlgorithmName=function(){return l(s(this.hex,0,[1,0],"06"))},this.getSignatureValueHex=function(){return s(this.hex,0,[2],"03",!0)},this.verifySignature=function(t){
var e=this.getSignatureAlgorithmField(),n=this.getSignatureValueHex(),r=a(this.hex,0,[0],"30"),i=new ht.crypto.Signature({alg:e});return i.init(t),i.updateHex(r),i.verify(n)},
this.parseExt=function(t){var i,o,a;if(void 0===t){if(a=this.hex,3!==this.version)return-1;i=c(a,0,[0,7,0],"30"),o=n(a,i)}else{a=Pt(t);var u=c(a,0,[0,3,0,0],"06")
;if("2a864886f70d01090e"!=r(a,u))return void(this.aExtInfo=new Array);i=c(a,0,[0,3,0,1,0],"30"),o=n(a,i),this.hex=a}this.aExtInfo=new Array;for(var l=0;l<o.length;l++){var f={critical:!1},d=0
;3===n(a,o[l]).length&&(f.critical=!0,d=1),f.oid=e.hextooidstr(s(a,o[l],[0],"06"));var p=c(a,o[l],[1+d]);f.vidx=h(a,p),this.aExtInfo.push(f)}},this.getExtInfo=function(t){var e=this.aExtInfo,n=t
;if(t.match(/^[0-9.]+$/)||(n=ht.asn1.x509.OID.name2oid(t)),""!==n)for(var r=0;r<e.length;r++)if(e[r].oid===n)return e[r]},this.getExtBasicConstraints=function(){
var t=this.getExtInfo("basicConstraints");if(void 0===t)return t;var e=r(this.hex,t.vidx);if(""===e)return{};if("0101ff"===e)return{cA:!0};if("0101ff02"===e.substr(0,8)){var n=r(e,6);return{cA:!0,
pathLen:parseInt(n,16)}}throw"basicConstraints parse error"},this.getExtKeyUsageBin=function(){var t=this.getExtInfo("keyUsage");if(void 0===t)return"";var e=r(this.hex,t.vidx)
;if(e.length%2!=0||e.length<=2)throw new Error("malformed key usage value");var n=parseInt(e.substr(0,2)),i=parseInt(e.substr(2),16).toString(2);return(i=("0000000"+i).slice(-8)).substr(0,i.length-n)
},this.getExtKeyUsageString=function(){for(var t=this.getExtKeyUsageBin(),e=new Array,n=0;n<t.length;n++)"1"==t.substr(n,1)&&e.push(Wt.KEYUSAGE_NAME[n]);return e.join(",")},
this.getExtSubjectKeyIdentifier=function(){var t=this.getExtInfo("subjectKeyIdentifier");return void 0===t?t:r(this.hex,t.vidx)},this.getExtAuthorityKeyIdentifier=function(){
var t=this.getExtInfo("authorityKeyIdentifier");if(void 0===t)return t;for(var e={},s=i(this.hex,t.vidx),o=n(s,0),a=0;a<o.length;a++)"80"===s.substr(o[a],2)&&(e.kid=r(s,o[a]));return e},
this.getExtExtKeyUsageName=function(){var t=this.getExtInfo("extKeyUsage");if(void 0===t)return t;var e=new Array,s=i(this.hex,t.vidx);if(""===s)return e
;for(var o=n(s,0),a=0;a<o.length;a++)e.push(l(r(s,o[a])));return e},this.getExtSubjectAltName=function(){
for(var t=this.getExtSubjectAltName2(),e=new Array,n=0;n<t.length;n++)"DNS"===t[n][0]&&e.push(t[n][1]);return e},this.getExtSubjectAltName2=function(){var t,e,s,o=this.getExtInfo("subjectAltName")
;if(void 0===o)return o;for(var a=new Array,u=i(this.hex,o.vidx),c=n(u,0),h=0;h<c.length;h++)s=u.substr(c[h],2),t=r(u,c[h]),"81"===s&&(e=_t(t),a.push(["MAIL",e])),"82"===s&&(e=_t(t),
a.push(["DNS",e])),"84"===s&&(e=Wt.hex2dn(t,0),a.push(["DN",e])),"86"===s&&(e=_t(t),a.push(["URI",e])),"87"===s&&(e=Ht(t),a.push(["IP",e]));return a},this.getExtCRLDistributionPointsURI=function(){
var t=this.getExtInfo("cRLDistributionPoints");if(void 0===t)return t;for(var e=new Array,r=n(this.hex,t.vidx),i=0;i<r.length;i++)try{var o=_t(s(this.hex,r[i],[0,0,0],"86"));e.push(o)}catch(t){}
return e},this.getExtAIAInfo=function(){var t=this.getExtInfo("authorityInfoAccess");if(void 0===t)return t;for(var e={ocsp:[],caissuer:[]},r=n(this.hex,t.vidx),i=0;i<r.length;i++){
var o=s(this.hex,r[i],[0],"06"),a=s(this.hex,r[i],[1],"86");"2b06010505073001"===o&&e.ocsp.push(_t(a)),"2b06010505073002"===o&&e.caissuer.push(_t(a))}return e},
this.getExtCertificatePolicies=function(){var t=this.getExtInfo("certificatePolicies");if(void 0===t)return t;for(var e=i(this.hex,t.vidx),o=[],a=n(e,0),u=0;u<a.length;u++){var c={},h=n(e,a[u])
;if(c.id=l(r(e,h[0])),2===h.length)for(var f=n(e,h[1]),d=0;d<f.length;d++){var p=s(e,f[d],[0],"06")
;"2b06010505070201"===p?c.cps=_t(s(e,f[d],[1])):"2b06010505070202"===p&&(c.unotice=_t(s(e,f[d],[1,0])))}o.push(c)}return o},this.readCertPEM=function(t){this.readCertHex(d(t))},
this.readCertHex=function(t){this.hex=t,this.getVersion();try{c(this.hex,0,[0,7],"a3"),this.parseExt()}catch(t){}},this.getInfo=function(){var t,e,n;if(t="Basic Fields\n",
t+="  serial number: "+this.getSerialNumberHex()+"\n",t+="  signature algorithm: "+this.getSignatureAlgorithmField()+"\n",t+="  issuer: "+this.getIssuerString()+"\n",
t+="  notBefore: "+this.getNotBefore()+"\n",t+="  notAfter: "+this.getNotAfter()+"\n",t+="  subject: "+this.getSubjectString()+"\n",t+="  subject public key info: \n",
t+="    key algorithm: "+(e=this.getPublicKey()).type+"\n","RSA"===e.type&&(t+="    n="+Lt(e.n.toString(16)).substr(0,16)+"...\n",t+="    e="+Lt(e.e.toString(16))+"\n"),null!=(n=this.aExtInfo)){
t+="X509v3 Extensions:\n";for(var r=0;r<n.length;r++){var i=n[r],s=ht.asn1.x509.OID.oid2name(i.oid);""===s&&(s=i.oid);var o="";if(!0===i.critical&&(o="CRITICAL"),t+="  "+s+" "+o+":\n",
"basicConstraints"===s){var a=this.getExtBasicConstraints();void 0===a.cA?t+="    {}\n":(t+="    cA=true",void 0!==a.pathLen&&(t+=", pathLen="+a.pathLen),t+="\n")
}else if("keyUsage"===s)t+="    "+this.getExtKeyUsageString()+"\n";else if("subjectKeyIdentifier"===s)t+="    "+this.getExtSubjectKeyIdentifier()+"\n";else if("authorityKeyIdentifier"===s){
var u=this.getExtAuthorityKeyIdentifier();void 0!==u.kid&&(t+="    kid="+u.kid+"\n")}else{
if("extKeyUsage"===s)t+="    "+this.getExtExtKeyUsageName().join(", ")+"\n";else if("subjectAltName"===s)t+="    "+this.getExtSubjectAltName2()+"\n";else if("cRLDistributionPoints"===s)t+="    "+this.getExtCRLDistributionPointsURI()+"\n";else if("authorityInfoAccess"===s){
var c=this.getExtAIAInfo();void 0!==c.ocsp&&(t+="    ocsp: "+c.ocsp.join(",")+"\n"),void 0!==c.caissuer&&(t+="    caissuer: "+c.caissuer.join(",")+"\n")
}else if("certificatePolicies"===s)for(var h=this.getExtCertificatePolicies(),l=0;l<h.length;l++)void 0!==h[l].id&&(t+="    policy oid: "+h[l].id+"\n"),
void 0!==h[l].cps&&(t+="    cps: "+h[l].cps+"\n")}}}return t+="signature algorithm: "+this.getSignatureAlgorithmName()+"\n",t+="signature: "+this.getSignatureValueHex().substr(0,16)+"...\n"}}
it.prototype.sign=function(t,e){var n=function(t){return ht.crypto.Util.hashString(t,e)}(t);return this.signWithMessageHash(n,e)},it.prototype.signWithMessageHash=function(t,e){
var n=nt(ht.crypto.Util.getPaddedDigestInfoHex(t,e,this.n.bitLength()),16);return Mt(this.doPrivate(n).toString(16),this.n.bitLength())},it.prototype.signPSS=function(t,e,n){var r,i=(r=At(t),
ht.crypto.Util.hashHex(r,e));return void 0===n&&(n=-1),this.signWithMessageHashPSS(i,e,n)},it.prototype.signWithMessageHashPSS=function(t,e,n){
var r,i=Et(t),s=i.length,o=this.n.bitLength()-1,a=Math.ceil(o/8),u=function(t){return ht.crypto.Util.hashHex(t,e)}
;if(-1===n||void 0===n)n=s;else if(-2===n)n=a-s-2;else if(n<-2)throw"invalid salt length";if(a<s+n+2)throw"data too long";var c="";n>0&&(c=new Array(n),(new et).nextBytes(c),
c=String.fromCharCode.apply(String,c));var h=Et(u(At("\0\0\0\0\0\0\0\0"+i+c))),l=[];for(r=0;r<a-n-s-2;r+=1)l[r]=0;var f=String.fromCharCode.apply(String,l)+""+c,d=qt(h,f.length,u),p=[]
;for(r=0;r<f.length;r+=1)p[r]=f.charCodeAt(r)^d.charCodeAt(r);var g=65280>>8*a-o&255;for(p[0]&=~g,r=0;r<s;r++)p.push(h.charCodeAt(r));return p.push(188),
Mt(this.doPrivate(new _(p)).toString(16),this.n.bitLength())},it.prototype.verify=function(t,e){var n=nt(e=(e=e.replace(Kt,"")).replace(/[ \n]+/g,""),16);if(n.bitLength()>this.n.bitLength())return 0
;var r=zt(this.doPublic(n).toString(16).replace(/^1f+00/,""));if(0==r.length)return!1;var i=r[0];return r[1]==function(t){return ht.crypto.Util.hashString(t,i)}(t)},
it.prototype.verifyWithMessageHash=function(t,e){if(e.length!=Math.ceil(this.n.bitLength()/4))return!1;var n=nt(e,16);if(n.bitLength()>this.n.bitLength())return 0
;var r=zt(this.doPublic(n).toString(16).replace(/^1f+00/,""));if(0==r.length)return!1;r[0];return r[1]==t},it.prototype.verifyPSS=function(t,e,n,r){var i,s=(i=At(t),ht.crypto.Util.hashHex(i,n))
;return void 0===r&&(r=-1),this.verifyWithMessageHashPSS(s,e,n,r)},it.prototype.verifyWithMessageHashPSS=function(t,e,n,r){if(e.length!=Math.ceil(this.n.bitLength()/4))return!1
;var i,s=new _(e,16),o=function(t){return ht.crypto.Util.hashHex(t,n)},a=Et(t),u=a.length,c=this.n.bitLength()-1,h=Math.ceil(c/8)
;if(-1===r||void 0===r)r=u;else if(-2===r)r=h-u-2;else if(r<-2)throw"invalid salt length";if(h<u+r+2)throw"data too long";var l=this.doPublic(s).toByteArray();for(i=0;i<l.length;i+=1)l[i]&=255
;for(;l.length<h;)l.unshift(0);if(188!==l[h-1])throw"encoded message does not end in 0xbc";var f=(l=String.fromCharCode.apply(String,l)).substr(0,h-u-1),d=l.substr(f.length,u),p=65280>>8*h-c&255
;if(0!=(f.charCodeAt(0)&p))throw"bits beyond keysize not zero";var g=qt(d,f.length,o),v=[];for(i=0;i<f.length;i+=1)v[i]=f.charCodeAt(i)^g.charCodeAt(i);v[0]&=~p;var y=h-u-r-2
;for(i=0;i<y;i+=1)if(0!==v[i])throw"leftmost octets not zero";if(1!==v[y])throw"0x01 marker not found";return d===Et(o(At("\0\0\0\0\0\0\0\0"+a+String.fromCharCode.apply(String,v.slice(-r)))))},
it.SALT_LEN_HLEN=-1,it.SALT_LEN_MAX=-2,it.SALT_LEN_RECOVER=-2,Wt.hex2dn=function(t,e){if(void 0===e&&(e=0),"30"!==t.substr(e,2))throw"malformed DN"
;for(var n=new Array,r=dt.getChildIdx(t,e),i=0;i<r.length;i++)n.push(Wt.hex2rdn(t,r[i]));return"/"+(n=n.map((function(t){return t.replace("/","\\/")}))).join("/")},Wt.hex2rdn=function(t,e){
if(void 0===e&&(e=0),"31"!==t.substr(e,2))throw"malformed RDN";for(var n=new Array,r=dt.getChildIdx(t,e),i=0;i<r.length;i++)n.push(Wt.hex2attrTypeValue(t,r[i]));return(n=n.map((function(t){
return t.replace("+","\\+")}))).join("+")},Wt.hex2attrTypeValue=function(t,e){var n=dt,r=n.getV;if(void 0===e&&(e=0),"30"!==t.substr(e,2))throw"malformed attribute type and value"
;var i=n.getChildIdx(t,e);2!==i.length||t.substr(i[0],2);var s=r(t,i[0]),o=ht.asn1.ASN1Util.oidHexToInt(s);return ht.asn1.x509.OID.oid2atype(o)+"="+Et(r(t,i[1]))},
Wt.getPublicKeyFromCertHex=function(t){var e=new Wt;return e.readCertHex(t),e.getPublicKey()},Wt.getPublicKeyFromCertPEM=function(t){var e=new Wt;return e.readCertPEM(t),e.getPublicKey()},
Wt.getPublicKeyInfoPropOfCertPEM=function(t){var e,n,r=dt.getVbyList,i={};return i.algparam=null,(e=new Wt).readCertPEM(t),n=e.getPublicKeyHex(),i.keyhex=r(n,0,[1],"03").substr(2),
i.algoid=r(n,0,[0,0],"06"),"2a8648ce3d0201"===i.algoid&&(i.algparam=r(n,0,[0,1],"06")),i},
Wt.KEYUSAGE_NAME=["digitalSignature","nonRepudiation","keyEncipherment","dataEncipherment","keyAgreement","keyCertSign","cRLSign","encipherOnly","decipherOnly"],void 0!==ht&&ht||(ht={}),
void 0!==ht.jws&&ht.jws||(ht.jws={}),ht.jws.JWS=function(){var t=ht.jws.JWS.isSafeJSONString;this.parseJWS=function(e,n){if(void 0===this.parsedJWS||!n&&void 0===this.parsedJWS.sigvalH){
var r=e.match(/^([^.]+)\.([^.]+)\.([^.]+)$/);if(null==r)throw"JWS signature is not a form of 'Head.Payload.SigValue'.";var i=r[1],s=r[2],o=r[3],a=i+"."+s;if(this.parsedJWS={},
this.parsedJWS.headB64U=i,this.parsedJWS.payloadB64U=s,this.parsedJWS.sigvalB64U=o,this.parsedJWS.si=a,!n){var u=xt(o),c=nt(u,16);this.parsedJWS.sigvalH=u,this.parsedJWS.sigvalBI=c}var h=ft(i),l=ft(s)
;if(this.parsedJWS.headS=h,this.parsedJWS.payloadS=l,!t(h,this.parsedJWS,"headP"))throw"malformed JSON string for JWS Head: "+h}}},ht.jws.JWS.sign=function(t,e,r,i,s){
var o,a,u,c=ht,h=c.jws.JWS,l=h.readSafeJSONString,f=h.isSafeJSONString,d=c.crypto,p=(d.ECDSA,d.Mac),g=d.Signature,v=JSON
;if("string"!=typeof e&&"object"!=n(e))throw"spHeader must be JSON string or object: "+e;if("object"==n(e)&&(a=e,o=v.stringify(a)),"string"==typeof e){
if(!f(o=e))throw"JWS Head is not safe JSON string: "+o;a=l(o)}if(u=r,"object"==n(r)&&(u=v.stringify(r)),""!=t&&null!=t||void 0===a.alg||(t=a.alg),""!=t&&null!=t&&void 0===a.alg&&(a.alg=t,
o=v.stringify(a)),t!==a.alg)throw"alg and sHeader.alg doesn't match: "+t+"!="+a.alg;var y=null;if(void 0===h.jwsalg2sigalg[t])throw"unsupported alg name: "+t;y=h.jwsalg2sigalg[t]
;var m=lt(o)+"."+lt(u),S="";if("Hmac"==y.substr(0,4)){if(void 0===i)throw"mac key shall be specified for HS* alg";var b=new p({alg:y,prov:"cryptojs",pass:i});b.updateString(m),S=b.doFinal()
}else if(-1!=y.indexOf("withECDSA")){(w=new g({alg:y})).init(i,s),w.updateString(m);var x=w.sign();S=ht.crypto.ECDSA.asn1SigToConcatSig(x)}else{var w;if("none"!=y)(w=new g({alg:y})).init(i,s),
w.updateString(m),S=w.sign()}return m+"."+bt(S)},ht.jws.JWS.verify=function(t,e,r){var i,s=ht,o=s.jws.JWS,a=o.readSafeJSONString,u=s.crypto,c=u.ECDSA,h=u.Mac,l=u.Signature;void 0!==n(it)&&(i=it)
;var f=t.split(".");if(3!==f.length)return!1;var d=f[0]+"."+f[1],p=xt(f[2]),g=a(ft(f[0])),v=null,y=null;if(void 0===g.alg)throw"algorithm not specified in header";if((y=(v=g.alg).substr(0,2),
null!=r&&"[object Array]"===Object.prototype.toString.call(r)&&r.length>0)&&-1==(":"+r.join(":")+":").indexOf(":"+v+":"))throw"algorithm '"+v+"' not accepted in the list"
;if("none"!=v&&null===e)throw"key shall be specified to verify.";if("string"==typeof e&&-1!=e.indexOf("-----BEGIN ")&&(e=Ut.getKey(e)),
!("RS"!=y&&"PS"!=y||e instanceof i))throw"key shall be a RSAKey obj for RS* and PS* algs";if("ES"==y&&!(e instanceof c))throw"key shall be a ECDSA obj for ES* algs";var m=null
;if(void 0===o.jwsalg2sigalg[g.alg])throw"unsupported alg name: "+v;if("none"==(m=o.jwsalg2sigalg[v]))throw"not supported";if("Hmac"==m.substr(0,4)){
if(void 0===e)throw"hexadecimal key shall be specified for HMAC";var S=new h({alg:m,pass:e});return S.updateString(d),p==S.doFinal()}if(-1!=m.indexOf("withECDSA")){var b,x=null;try{
x=c.concatSigToASN1Sig(p)}catch(t){return!1}return(b=new l({alg:m})).init(e),b.updateString(d),b.verify(x)}return(b=new l({alg:m})).init(e),b.updateString(d),b.verify(p)},ht.jws.JWS.parse=function(t){
var e,n,r,i=t.split("."),s={};if(2!=i.length&&3!=i.length)throw"malformed sJWS: wrong number of '.' splitted elements";return e=i[0],n=i[1],3==i.length&&(r=i[2]),
s.headerObj=ht.jws.JWS.readSafeJSONString(ft(e)),s.payloadObj=ht.jws.JWS.readSafeJSONString(ft(n)),s.headerPP=JSON.stringify(s.headerObj,null,"  "),
null==s.payloadObj?s.payloadPP=ft(n):s.payloadPP=JSON.stringify(s.payloadObj,null,"  "),void 0!==r&&(s.sigHex=xt(r)),s},ht.jws.JWS.verifyJWT=function(t,e,r){
var i=ht.jws,s=i.JWS,o=s.readSafeJSONString,a=s.inArray,u=s.includedArray,c=t.split("."),h=c[0],l=c[1],f=(xt(c[2]),o(ft(h))),d=o(ft(l));if(void 0===f.alg)return!1
;if(void 0===r.alg)throw"acceptField.alg shall be specified";if(!a(f.alg,r.alg))return!1;if(void 0!==d.iss&&"object"===n(r.iss)&&!a(d.iss,r.iss))return!1
;if(void 0!==d.sub&&"object"===n(r.sub)&&!a(d.sub,r.sub))return!1;if(void 0!==d.aud&&"object"===n(r.aud))if("string"==typeof d.aud){if(!a(d.aud,r.aud))return!1
}else if("object"==n(d.aud)&&!u(d.aud,r.aud))return!1;var p=i.IntDate.getNow();return void 0!==r.verifyAt&&"number"==typeof r.verifyAt&&(p=r.verifyAt),
void 0!==r.gracePeriod&&"number"==typeof r.gracePeriod||(r.gracePeriod=0),
!(void 0!==d.exp&&"number"==typeof d.exp&&d.exp+r.gracePeriod<p)&&(!(void 0!==d.nbf&&"number"==typeof d.nbf&&p<d.nbf-r.gracePeriod)&&(!(void 0!==d.iat&&"number"==typeof d.iat&&p<d.iat-r.gracePeriod)&&((void 0===d.jti||void 0===r.jti||d.jti===r.jti)&&!!s.verify(t,e,r.alg))))
},ht.jws.JWS.includedArray=function(t,e){var r=ht.jws.JWS.inArray;if(null===t)return!1;if("object"!==n(t))return!1;if("number"!=typeof t.length)return!1
;for(var i=0;i<t.length;i++)if(!r(t[i],e))return!1;return!0},ht.jws.JWS.inArray=function(t,e){if(null===e)return!1;if("object"!==n(e))return!1;if("number"!=typeof e.length)return!1
;for(var r=0;r<e.length;r++)if(e[r]==t)return!0;return!1},ht.jws.JWS.jwsalg2sigalg={HS256:"HmacSHA256",HS384:"HmacSHA384",HS512:"HmacSHA512",RS256:"SHA256withRSA",RS384:"SHA384withRSA",
RS512:"SHA512withRSA",ES256:"SHA256withECDSA",ES384:"SHA384withECDSA",PS256:"SHA256withRSAandMGF1",PS384:"SHA384withRSAandMGF1",PS512:"SHA512withRSAandMGF1",none:"none"},
ht.jws.JWS.isSafeJSONString=function(t,e,r){var i=null;try{return"object"!=n(i=ct(t))||i.constructor===Array?0:(e&&(e[r]=i),1)}catch(t){return 0}},ht.jws.JWS.readSafeJSONString=function(t){var e=null
;try{return"object"!=n(e=ct(t))||e.constructor===Array?null:e}catch(t){return null}},ht.jws.JWS.getEncodedSignatureValueFromJWS=function(t){var e=t.match(/^[^.]+\.[^.]+\.([^.]+)$/)
;if(null==e)throw"JWS signature is not a form of 'Head.Payload.SigValue'.";return e[1]},ht.jws.JWS.getJWKthumbprint=function(t){
if("RSA"!==t.kty&&"EC"!==t.kty&&"oct"!==t.kty)throw"unsupported algorithm for JWK Thumprint";var e="{";if("RSA"===t.kty){
if("string"!=typeof t.n||"string"!=typeof t.e)throw"wrong n and e value for RSA key";e+='"e":"'+t.e+'",',e+='"kty":"'+t.kty+'",',e+='"n":"'+t.n+'"}'}else if("EC"===t.kty){
if("string"!=typeof t.crv||"string"!=typeof t.x||"string"!=typeof t.y)throw"wrong crv, x and y value for EC key";e+='"crv":"'+t.crv+'",',e+='"kty":"'+t.kty+'",',e+='"x":"'+t.x+'",',e+='"y":"'+t.y+'"}'
}else if("oct"===t.kty){if("string"!=typeof t.k)throw"wrong k value for oct(symmetric) key";e+='"kty":"'+t.kty+'",',e+='"k":"'+t.k+'"}'}var n=At(e);return bt(ht.crypto.Util.hashHex(n,"sha256"))},
ht.jws.IntDate={},ht.jws.IntDate.get=function(t){var e=ht.jws.IntDate,n=e.getNow,r=e.getZulu;if("now"==t)return n();if("now + 1hour"==t)return n()+3600;if("now + 1day"==t)return n()+86400
;if("now + 1month"==t)return n()+2592e3;if("now + 1year"==t)return n()+31536e3;if(t.match(/Z$/))return r(t);if(t.match(/^[0-9]+$/))return parseInt(t);throw"unsupported format: "+t},
ht.jws.IntDate.getZulu=function(t){return It(t)},ht.jws.IntDate.getNow=function(){return~~(new Date/1e3)},ht.jws.IntDate.intDate2UTCString=function(t){return new Date(1e3*t).toUTCString()},
ht.jws.IntDate.intDate2Zulu=function(t){var e=new Date(1e3*t)
;return("0000"+e.getUTCFullYear()).slice(-4)+("00"+(e.getUTCMonth()+1)).slice(-2)+("00"+e.getUTCDate()).slice(-2)+("00"+e.getUTCHours()).slice(-2)+("00"+e.getUTCMinutes()).slice(-2)+("00"+e.getUTCSeconds()).slice(-2)+"Z"
},void 0!==ht&&ht||(ht={}),void 0!==ht.jws&&ht.jws||(ht.jws={}),ht.jws.JWSJS=function(){var t=ht.jws.JWS,e=t.readSafeJSONString;this.aHeader=[],this.sPayload="",this.aSignature=[],
this.init=function(){this.aHeader=[],this.sPayload=void 0,this.aSignature=[]},this.initWithJWS=function(t){this.init();var e=t.split(".");if(3!=e.length)throw"malformed input JWS"
;this.aHeader.push(e[0]),this.sPayload=e[1],this.aSignature.push(e[2])},this.addSignature=function(t,e,n,r){if(void 0===this.sPayload||null===this.sPayload)throw"there's no JSON-JS signature to add."
;var i=this.aHeader.length;if(this.aHeader.length!=this.aSignature.length)throw"aHeader.length != aSignature.length";try{var s=ht.jws.JWS.sign(t,e,this.sPayload,n,r).split(".");s[0],s[2]
;this.aHeader.push(s[0]),this.aSignature.push(s[2])}catch(t){throw this.aHeader.length>i&&this.aHeader.pop(),this.aSignature.length>i&&this.aSignature.pop(),"addSignature failed: "+t}},
this.verifyAll=function(t){if(this.aHeader.length!==t.length||this.aSignature.length!==t.length)return!1;for(var e=0;e<t.length;e++){var n=t[e];if(2!==n.length)return!1
;if(!1===this.verifyNth(e,n[0],n[1]))return!1}return!0},this.verifyNth=function(e,n,r){if(this.aHeader.length<=e||this.aSignature.length<=e)return!1
;var i=this.aHeader[e],s=this.aSignature[e],o=i+"."+this.sPayload+"."+s,a=!1;try{a=t.verify(o,n,r)}catch(t){return!1}return a},this.readJWSJS=function(t){if("string"==typeof t){var n=e(t)
;if(null==n)throw"argument is not safe JSON object string";this.aHeader=n.headers,this.sPayload=n.payload,this.aSignature=n.signatures}else try{if(!(t.headers.length>0))throw"malformed header"
;if(this.aHeader=t.headers,"string"!=typeof t.payload)throw"malformed signatures";if(this.sPayload=t.payload,!(t.signatures.length>0))throw"malformed signatures";this.aSignature=t.signatures}catch(t){
throw"malformed JWS-JS JSON object: "+t}},this.getJSON=function(){return{headers:this.aHeader,payload:this.sPayload,signatures:this.aSignature}},this.isEmpty=function(){
return 0==this.aHeader.length?1:0}},e.SecureRandom=et,e.rng_seed_time=Y,e.BigInteger=_,e.RSAKey=it,e.ECDSA=ht.crypto.ECDSA,e.DSA=ht.crypto.DSA,e.Signature=ht.crypto.Signature,
e.MessageDigest=ht.crypto.MessageDigest,e.Mac=ht.crypto.Mac,e.Cipher=ht.crypto.Cipher,e.KEYUTIL=Ut,e.ASN1HEX=dt,e.X509=Wt,e.CryptoJS=y,e.b64tohex=x,e.b64toBA=w,e.ECFieldElementFp=ot,e.ECPointFp=at,
e.ECCurveFp=ut,e.stoBA=pt,e.BAtos=gt,e.BAtohex=vt,e.stohex=yt,e.stob64=function(t){return b(yt(t))},e.stob64u=function(t){return mt(b(yt(t)))},e.b64utos=function(t){return gt(w(St(t)))},
e.b64tob64u=mt,e.b64utob64=St,e.hex2b64=b,e.hextob64u=bt,e.b64utohex=xt,e.utf8tob64u=lt,e.b64utoutf8=ft,e.utf8tob64=function(t){return b(Dt(jt(t)))},e.b64toutf8=function(t){
return decodeURIComponent(Bt(x(t)))},e.utf8tohex=wt,e.hextoutf8=_t,e.hextorstr=Et,e.rstrtohex=At,e.hextob64=Ft,e.hextob64nl=Ct,e.b64nltohex=kt,e.hextopem=Tt,e.pemtohex=Pt,
e.hextoArrayBuffer=function(t){if(t.length%2!=0)throw"input is not even length";if(null==t.match(/^[0-9A-Fa-f]+$/))throw"input is not hexadecimal"
;for(var e=new ArrayBuffer(t.length/2),n=new DataView(e),r=0;r<t.length/2;r++)n.setUint8(r,parseInt(t.substr(2*r,2),16));return e},e.ArrayBuffertohex=function(t){
for(var e="",n=new DataView(t),r=0;r<t.byteLength;r++)e+=("00"+n.getUint8(r).toString(16)).slice(-2);return e},e.zulutomsec=Rt,e.zulutosec=It,e.zulutodate=function(t){return new Date(Rt(t))},
e.datetozulu=function(t,e,n){var r,i=t.getUTCFullYear();if(e){if(i<1950||2049<i)throw"not proper year for UTCTime: "+i;r=(""+i).slice(-2)}else r=("000"+i).slice(-4)
;if(r+=("0"+(t.getUTCMonth()+1)).slice(-2),r+=("0"+t.getUTCDate()).slice(-2),r+=("0"+t.getUTCHours()).slice(-2),r+=("0"+t.getUTCMinutes()).slice(-2),r+=("0"+t.getUTCSeconds()).slice(-2),n){
var s=t.getUTCMilliseconds();0!==s&&(r+="."+(s=(s=("00"+s).slice(-3)).replace(/0+$/g,"")))}return r+="Z"},e.uricmptohex=Dt,e.hextouricmp=Bt,e.ipv6tohex=Nt,e.hextoipv6=Ot,e.hextoip=Ht,
e.iptohex=function(t){var e="malformed IP address";if(!(t=t.toLowerCase(t)).match(/^[0-9.]+$/)){if(t.match(/^[0-9a-f:]+$/)&&-1!==t.indexOf(":"))return Nt(t);throw e}var n=t.split(".")
;if(4!==n.length)throw e;var r="";try{for(var i=0;i<4;i++){r+=("0"+parseInt(n[i]).toString(16)).slice(-2)}return r}catch(t){throw e}},e.encodeURIComponentAll=jt,e.newline_toUnix=function(t){
return t=t.replace(/\r\n/gm,"\n")},e.newline_toDos=function(t){return t=(t=t.replace(/\r\n/gm,"\n")).replace(/\n/gm,"\r\n")},e.hextoposhex=Lt,e.intarystrtohex=Vt,e.strdiffidx=function(t,e){
var n=t.length;t.length>e.length&&(n=e.length);for(var r=0;r<n;r++)if(t.charCodeAt(r)!=e.charCodeAt(r))return r;return t.length!=e.length?n:-1},e.KJUR=ht,e.crypto=ht.crypto,e.asn1=ht.asn1,
e.jws=ht.jws,e.lang=ht.lang}).call(this,n(13).Buffer)},function(t,e,n){t.exports=n(4).Uri},function(t,e,n){"use strict";function r(t,e){if(null==t)return{};var n,r,i=function(t,e){if(null==t)return{}
;var n,r,i={},s=Object.keys(t);for(r=0;r<s.length;r++)n=s[r],e.indexOf(n)>=0||(i[n]=t[n]);return i}(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t)
;for(r=0;r<s.length;r++)n=s[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}function i(t,e,n,r,i,s,o){try{var a=t[s](o),u=a.value}catch(t){return void n(t)}
a.done?e(u):Promise.resolve(u).then(r,i)}function s(t){return function(){var e=this,n=arguments;return new Promise((function(r,s){var o=t.apply(e,n);function a(t){i(o,r,s,a,u,"next",t)}function u(t){
i(o,r,s,a,u,"throw",t)}a(void 0)}))}}function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),
Object.defineProperty(t,r.key,r)}}
var a=n(35),u=n(36),c=n(37),h=n(38),l=n(6),f=n(5),d=n(0).AuthenticationError,p=n(1),g=p.Config,v=p.BaseError,y=n(3).LoggerFactory,m=n(8),S="uu_app_oidc_providers_",b={enabled:{oidcg01:!0,oidcg02:!0},
width:{oidcg01:599,oidcg02:655},height:{oidcg01:600,oidcg02:875}},x={type:{oidcg01:"iframe",oidcg02:"iframe"},popupWidth:{oidcg01:599,oidcg02:655},popupHeight:{oidcg01:600,oidcg02:875}
},w=document.querySelector("base"),_=location.protocol+"//"+location.host+(w&&w.getAttribute("data-uu-app-base")||"/"),E=function(){function t(e,n,r){!function(t,e){
if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._oauthClient=e,this._serviceName=n,this._defaultRedirectUri=r;var i=g.getBoolean(S+n+"_login_popup_enabled")
;null==i?(i=b.enabled[n],this._popupEnabled=null==i||i):this._popupEnabled=i,this._defaultAcrValues=g.getString("uu_app_oidc_requested_acr_values",!1),
this._defaultMaxAge=g.getNumber("uu_app_oidc_max_authentication_age",!1),this._logger=y.get("uuapp.oidc.internal."+n+"."+this.constructor.name),this._checkSessionIframe=null,
this._loadCheckSessionIframePromise=null,this._runningCheckSessionPromise=null,this._runningCheckSessionResolve=null}var e,n,i,p,w;return e=t,(n=[{key:"getAuthResponseFromCallback",value:function(t){
throw new Error("AbstractFlow.getAuthResponseFromCallback must be implemented on child class.")}},{key:"createAuthState",value:function(){
var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n={r:Math.random().toString(32).substr(2),
appUri:location.pathname+location.search+(location.hash.length>1?location.hash:""),authCtx:t,usePopup:e};return n}},{key:"authenticate",value:function(t,e){
var n,r=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=new Promise(function(){var a=s(regeneratorRuntime.mark((function s(a,d){var p,g,y,S,b,x,w,_,E,A,F,C,k,T,P,R,I
;return regeneratorRuntime.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:if(s.prev=0,g=(p=t||{}).acrValues,y=p.maxAge,S=p.prompt,b=p.language,x=p.usePopup,w=p.authenticationContext,
_=p.loginHint,null==g&&(g=r._defaultAcrValues),null==y&&(y=r._defaultMaxAge),null==x&&(x=!0),x=x&&r._popupEnabled,"none"!==S){s.next=15;break}return s.next=9,f.getClientCredentials(r._serviceName)
;case 9:return A=s.sent,s.next=12,r._oauthClient.getAuthorizationUri(e,r._defaultRedirectUri,A,g,i);case 12:E=s.sent,s.next=31;break;case 15:s.prev=15,A=f.getClientCredentialsSync(r._serviceName),
s.next=23;break;case 19:throw s.prev=19,s.t0=s.catch(15),s.t0 instanceof l&&(r._logger.debug("Trying to reload client credentials on background."),f.getClientCredentials(r._serviceName)),
new v("Unable to get client credentials for service ".concat(r._serviceName,": ").concat(s.t0.message),s.t0);case 23:s.prev=23,E=r._oauthClient.getAuthorizationUriSync(e,r._defaultRedirectUri,A,g,i),
s.next=31;break;case 27:throw s.prev=27,s.t1=s.catch(23),s.t1 instanceof l&&(r._logger.debug("Trying to reload service metadata on background."),r._oauthClient.getMetadata()),
new v("Unable to get metadata of service ".concat(r._serviceName,": ").concat(s.t1.message),s.t1);case 31:return F=Math.random().toString(32).substr(2),
C=m.urlSafeEncode(JSON.stringify(r.createAuthState(w,x))),k=r._addUriParams(E,{max_age:y,login_hint:_,prompt:S,state:C,nonce:F,language:b}),T="none"!==S?x?u:h:c,
r._logger.debug("Invoking authorization request: ".concat(k)),P=r.sendRequest(k,T),o?o.uiComponent=P.uiComponent:n=P.uiComponent,s.next=40,P;case 40:R=s.sent,I=A.client_id,a({authResponse:R,state:C,
nonce:F,scope:i,acrValues:g,maxAge:y,clientId:I}),s.next=48;break;case 45:s.prev=45,s.t2=s.catch(0),d(s.t2);case 48:case"end":return s.stop()}}),s,null,[[0,45],[15,19],[23,27]])})))
;return function(t,e){return a.apply(this,arguments)}}());return n&&(o.uiComponent=n),o}},{key:"isCheckSessionSupported",value:(w=s(regeneratorRuntime.mark((function t(){
return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return null==this._loadCheckSessionIframePromise&&(this._loadCheckSessionIframePromise=this._loadCheckSessionIframe()),
t.next=3,this._loadCheckSessionIframePromise;case 3:return t.abrupt("return",!!this._checkSessionIframe);case 4:case"end":return t.stop()}}),t,this)}))),function(){return w.apply(this,arguments)})},{
key:"checkSession",value:function(t){var e=this;if(this._runningCheckSessionPromise)return this._runningCheckSessionPromise;var n=null,r=new Promise(function(){
var r=s(regeneratorRuntime.mark((function r(i,s){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=i,r.next=3,e.isCheckSessionSupported();case 3:if(r.sent){
r.next=7;break}return e._runningCheckSessionResolve=null,e._runningCheckSessionPromise=null,r.abrupt("return",s(new v("Check session is not supported.")));case 7:
e._logger.debug("Querying session state change from check session iframe. Query: ".concat(t)),e._checkSessionIframe.contentWindow.postMessage(t,e._iframeTrustedOrigin);case 9:case"end":return r.stop()
}}),r)})));return function(t,e){return r.apply(this,arguments)}}());return this._runningCheckSessionResolve=n,this._runningCheckSessionPromise=r,r}},{key:"getEndSessionUri",value:function(){
throw new Error("AbstractFlow.getEndSessionUri must be implemented on child class.")}},{key:"endSession",value:function(t){var e=this;return new Promise(function(){
var n=s(regeneratorRuntime.mark((function n(r,i){var s,o,a,l,f,d,p,v,y,m;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(s=e.getEndSessionUri(),o=null,
!(a=null==(a=g.getBoolean(S+t.getServiceName()+"_logout_token_hint_enabled"))||a)){n.next=23;break}if(l="".concat(S).concat(t.getServiceName(),"_default_call_token_scope_mode"),
"none"!==(g.getString(l)||"allUseCases")){n.next=11;break}o=t._idToken,n.next=23;break;case 11:return n.prev=11,e._logger.debug("Obtaining token to be used as id_token_hint for end session request."),
f={callTokenType:"idToken",excludeAuthenticationType:!0},n.next=16,t.getCallToken(s,f);case 16:o=n.sent,n.next=23;break;case 19:n.prev=19,n.t0=n.catch(11),
e._logger.warn("Unable to provide id_token_hint for end session request, using standard token.",n.t0),o=t._idToken;case 23:o&&(s+="?id_token_hint="+encodeURIComponent(o),
d=(d=g.getString("uu_app_oidc_post_logout_redirect_uri"))?e._toFullAppUrl(d):e._defaultRedirectUri,s+="&post_logout_redirect_uri="+encodeURIComponent(d)),
p=g.getString(S+e._serviceName+"_logout_type")||x.type[e._serviceName],v=g.getNumber(S+e._serviceName+"_logout_popup_width")||x.popupWidth[e._serviceName]||655,
y=g.getNumber(S+e._serviceName+"_logout_popup_height")||x.popupHeight[e._serviceName]||875,m="main"===p?h:"popup"===p?u:c,e._logger.debug("Invoking end session request: ".concat(s)),new m({width:v,
height:y,url:s,onResult:function(t){t instanceof Error?i(t):r()}}).render();case 30:case"end":return n.stop()}}),n,null,[[11,19]])})));return function(t,e){return n.apply(this,arguments)}}())}},{
key:"sendRequest",value:function(t){
var e,n=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:c,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.getAuthResponseFromCallback.bind(this),o=new Promise((function(o,a){
var c=g.getNumber(S+n._serviceName+"_login_popup_width")||b.width[n._serviceName]||655,h=g.getNumber(S+n._serviceName+"_login_popup_height")||b.height[n._serviceName]||875;(e=new i({width:c,height:h,
url:t,onResult:function(t){if(t instanceof Error)return a(t);if(!1===t)return a(new d("User refused to log in."));if(t===u.ERROR_POPUP_BLOCKED)return a(new d("Login failed due to popup blocking."))
;var e=s(t);if(e.error){
var n=e.error,i=e.error_description,c=e.uu_oidc_error_id,h=e.uu_oidc_error_code,l=r(e,["error","error_description","uu_oidc_error_id","uu_oidc_error_code"]),f=new d(i||"Authentication error: "+n)
;c&&(f.id=c),f.code=h||n,Object.assign(f,l),a(f)}else o(e)}})).render()}));return o.uiComponent=e,o}},{key:"_loadCheckSessionIframe",value:(p=s(regeneratorRuntime.mark((function t(){var e=this
;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise(function(){var t=s(regeneratorRuntime.mark((function t(n){var r,i
;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.domReady;case 2:return t.next=4,e._oauthClient.getCheckSessionIframeUri();case 4:
(r=t.sent)?(e._logger.debug("Creating iframe with check_session_iframe endpoint URL: ".concat(r)),
(i=document.createElement("iframe")).style.cssText="position: absolute;top: -300px; left: -300px; width: 200px; height: 200px; opacity: 0;",i.tabIndex="-1",i.onload=function(){
e._iframeTrustedOrigin=r.match(/^(https?:\/\/[^\/]+).*$/)[1]||null,e._checkSessionIframe=i,window.addEventListener("message",e._onMessage.bind(e)),n()},i.src=r,
document.body.appendChild(i)):(e._logger.warn("The OpenID Connect server ".concat(e._oauthClient.getServiceUri()," doesn't support check_session_iframe endpoint.")),n());case 6:case"end":
return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 1:case"end":return t.stop()}}),t)}))),function(){return p.apply(this,arguments)})},{key:"_onMessage",
value:function(t){this._logger.debug("Received message from ".concat(t.origin,": ").concat(t.data)),
this._checkSessionIframe&&t.source===this._checkSessionIframe.contentWindow&&t.origin===this._iframeTrustedOrigin?(this._logger.debug('Propagating session state "'.concat(t.data,'" to listeners.')),
this._runningCheckSessionResolve&&this._runningCheckSessionResolve(t.data),this._runningCheckSessionResolve=null,
this._runningCheckSessionPromise=null):this._logger.debug('Message "'.concat(t.data,'" from ').concat(t.origin," is not from check session iframe, ignoring."))}},{key:"_toFullAppUrl",
value:function(t){var e=document.createElement("a");return e.href=t&&t.match(/^[a-z]+:/i)?t:_+(t?t.replace(/^\/+/,""):""),e.href.toString()}},{key:"_addUriParams",value:function(t,e){var n=[]
;for(var r in e){var i=e[r];null!=i&&n.push(encodeURIComponent(r)+"="+encodeURIComponent(i+""))}return t+"&"+n.join("&")}}])&&o(e.prototype,n),i&&o(e,i),t}();t.exports=E},function(t,e){function n(t){
return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){
return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}"undefined"==typeof window||window.uuOidcCallbackFn||(window.uuOidcCallbackFn=function(t,e,r){
for(var i=window.uuOidcCallbackFn.loginWindows,s=0;s<i.length;++s){var o=i[s];if(o.state.loginWindow==e)return r&&sessionStorage.setItem("uu_app_oidc_auth_ctx","object"===n(r)?JSON.stringify(r):r),
void o.component.finalize(t)}console.warn("["+(new Date).toISOString()+"]  WARN uuapp.oidc.CallbackHandler: Received unexpected callback from window",e,"Passed result was:",t,"Ignoring the callback.")
},window.uuOidcCallbackFn.loginWindows=[]),t.exports={registerForCallback:function(t,e){window.uuOidcCallbackFn.loginWindows.push({component:t,state:e})},unregisterForCallback:function(t){
for(var e=window.uuOidcCallbackFn.loginWindows,n=0;n<e.length;++n)if(e[n].component===t){e.splice(n,1);break}}}},function(t,e,n){"use strict";function r(t){
return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){
return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e,n,r,i,s,o){try{var a=t[s](o),u=a.value}catch(t){return void n(t)}
a.done?e(u):Promise.resolve(u).then(r,i)}function s(t){return function(){var e=this,n=arguments;return new Promise((function(r,s){var o=t.apply(e,n);function a(t){i(o,r,s,a,u,"next",t)}function u(t){
i(o,r,s,a,u,"throw",t)}a(void 0)}))}}function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),
Object.defineProperty(t,r.key,r)}}function a(t,e,n){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){
for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=l(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function u(t,e){
return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1
;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){
var n,r=l(t);if(e){var i=l(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return h(this,n)}}function h(t,e){
return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function l(t){
return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=n(0).AuthenticationError,d=n(2).AppClient,p=function(t){!function(t,e){
if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}
}),e&&u(t,e)}(g,t);var e,n,r,i,h,p=c(g);function g(t,e,n,r){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,g),
(i=p.call(this,t,e,n))._oauthClient=t,i._serviceName=e,i._redirectUri=n,i._appBaseUri=r,i._client=new d,i}return e=g,(n=[{key:"authenticate",value:function(t){
var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=a(l(g.prototype),"authenticate",this).call(this,t,"code",n),i=r.then((function(t){
var n=t.authResponse,r=t.state,i=t.nonce,s=t.scope,o=t.acrValues,a=t.maxAge,u=t.clientId;return e._processAuthResponse(n,r,i,s,o,a,u)}));return i.uiComponent=r.uiComponent,i}},{
key:"getAuthResponseFromCallback",value:function(t){var e={};return t.replace(/^[^?#]*[?#]?/,"").replace(/#/,"&").split(/&/).filter(Boolean).forEach((function(t){
var n=t.indexOf("="),r=decodeURIComponent((-1==n?t.substr(0):t.substr(0,n)).replace(/\+/g," ")),i=decodeURIComponent((-1==n?"":t.substr(n+1)).replace(/\+/g," "));e[r]=i})),e}},{key:"createAuthState",
value:function(){
var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=a(l(g.prototype),"createAuthState",this).call(this,t,e)
;return n.redirectUri=this._redirectUri,n}},{key:"getEndSessionUri",value:function(){return this._appBaseUri+"oidc/logout"}},{key:"_processAuthResponse",
value:(h=s(regeneratorRuntime.mark((function t(e,n,r,i,s,o,a){var u,c,h,l,f,d;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return u=Date.now(),t.next=3,
this._validateAuthResponse(e,n,r);case 3:return t.next=5,this._client.get(this._appBaseUri+"oidc/introspect",{_:Date.now()});case 5:return c=t.sent.data,h=e.session_expires_in,l=e.session_state,
f=h?u+1e3*h:null,(d=sessionStorage.getItem("uu_app_oidc_auth_ctx"))&&(d=JSON.parse(d),sessionStorage.removeItem("uu_app_oidc_auth_ctx")),t.abrupt("return",{claims:c,idToken:null,accessToken:null,
authenticationContext:d,globalSessionExpiresAt:f,globalSessionState:l,clientId:a,scope:i,acrValues:s,maxAge:o});case 11:case"end":return t.stop()}}),t,this)}))),function(t,e,n,r,i,s,o){
return h.apply(this,arguments)})},{key:"_validateAuthResponse",value:(i=s(regeneratorRuntime.mark((function t(e,n,r){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:
if(!n||e.state===n){t.next=2;break}throw new f("Invalid 'state' in received authorization response. Expected "+n+" but got "+e.state+". Response: "+JSON.stringify(e));case 2:case"end":return t.stop()}
}),t)}))),function(t,e,n){return i.apply(this,arguments)})}])&&o(e.prototype,n),r&&o(e,r),g}(n(16));t.exports=p},function(t,e,n){t.exports=n(20)},function(t,e,n){
var r=n(21),i="undefined"!=typeof document,s=((r?r.uri:i&&(document.currentScript||Array.prototype.slice.call(document.getElementsByTagName("script"),-1)[0]||{}).src)||"").toString()
;"/2.0.0/"===(s=s.split(/\//).slice(0,-1).join("/")+"/").substr(-"/2.0.0/".length)&&(s=s.substr(0,s.length-"/2.0.0/".length)+"/2.2.9/"),n.p=s,t.exports=n(22)},function(t,n){t.exports=e
},function(t,e,n){"use strict";String.prototype.startsWith||Object.defineProperty(String.prototype,"startsWith",{value:function(t,e){return e=!e||e<0?0:+e,this.substring(e,e+t.length)===t}})
;var r,i=!1;if(t.exports={get AuthenticationService(){return n(23)},get Session(){var e=n(9);return i||(i=!0,n(43).wrapClass(e,t.exports.AuthenticationService)),e},get OidcAuthenticationService(){
return this.AuthenticationService},get OidcSession(){return this.Session}},window.UuOidc||(window.UuOidc={Session:t.exports.Session}),window.history&&window.history.replaceState){
var s=location.href.match(/[?&]?access_token=([^&#]+)/);if(s){r=s[1];try{var o=location.href.replace(/([?&])access_token=[^&#]*(&)?/,(function(t,e,n){return n?e:""}))
;o!==location.href&&history.replaceState(history.state,"",o)}catch(t){}}}("interactive"===document.readyState||"complete"===document.readyState?Promise.resolve():new Promise((function(t){
document.addEventListener("DOMContentLoaded",t,!1)}))).then((function(){t.exports.AuthenticationService._onPageLoad(r)}))},function(t,e,n){"use strict";function r(t){
return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){
return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){
if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,i=!1,s=void 0;try{for(var o,a=t[Symbol.iterator]();!(r=(o=a.next()).done)&&(n.push(o.value),!e||n.length!==e);r=!0);
}catch(t){i=!0,s=t}finally{try{r||null==a.return||a.return()}finally{if(i)throw s}}return n}(t,e)||o(t,e)||function(){
throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(t,e){var n
;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=o(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{
done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}
throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,a=!0,u=!1;return{s:function(){
n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){u=!0,s=t},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw s}}}}function o(t,e){if(t){
if("string"==typeof t)return a(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),
"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(t,e):void 0}}function a(t,e){(null==e||e>t.length)&&(e=t.length)
;for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function u(t,e,n,r,i,s,o){try{var a=t[s](o),u=a.value}catch(t){return void n(t)}a.done?e(u):Promise.resolve(u).then(r,i)}function c(t){
return function(){var e=this,n=arguments;return new Promise((function(r,i){var s=t.apply(e,n);function o(t){u(s,r,i,o,a,"next",t)}function a(t){u(s,r,i,o,a,"throw",t)}o(void 0)}))}}function h(t,e){
if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,
"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function f(t,e,n){return e&&l(t.prototype,e),n&&l(t,n),t}
var d=n(0),p=d.AuthenticationService,g=d.InvalidCredentials,v=n(1),y=v.Config,m=v.BaseError,S=n(3).LoggerFactory,b=n(2).AppClient,x=n(24),w=n(25),_=n(9),E=n(11),A=n(18),F=n(39),C=n(5),k=n(40),T=n(41),P="uu_app_oidc_providers_",R=/^[a-zA-Z0-9\-_]+\.[a-zA-Z0-9\-_]+\.[a-zA-Z0-9\-_]+$/,I=document.querySelector("base"),D=location.protocol+"//"+location.host+(I&&I.getAttribute("data-uu-app-base")||"/"),B=(new RegExp("uu.app.cbu=([^;]+)").exec(document.cookie)||[])[1],N=function(){
var t,e,n,o,a,u,l,d,v,I,N,O,H,j;function L(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(h(this,L),!t)throw new m("Service name is not defined");if(this._serviceName=t,
this._serviceUri=e.serviceUri||e.uu_oidc_server_uri,!this._serviceUri&&e.uu_oidc_server_tenant_id){var n=e.uu_oidc_server_tenant_id
;this._serviceUri="https://oidc.plus4u.net/uu-oidcg01-main/".concat(n)}if(!this._serviceUri)throw new m("There is no service URI defined for service ".concat(this._serviceName))
;this._oauthClient=new w(this._serviceUri,e),this._emptySession=T.from(_._createEmptySession(),void 0,void 0,void 0,void 0,this),this._currentSession=this._emptySession,this._runningAuthnPromise=null,
this._restoreSessionPromise=null,this._isRestoringSession=!1,this._listeners=[],this._globalSessionExpiring=!1,
this._defaultAcrValues=y.getString("uu_app_oidc_requested_acr_values",!1)||"low standard high veryHigh",this._defaultMaxAge=y.getNumber("uu_app_oidc_max_authentication_age",!1),
this._defaultScopeMode=y.getString(P+this._serviceName+"_default_call_token_scope_mode")||"allUseCases",this._logger=S.get("uuapp.oidc.AuthenticationService")
;var r=y.getString("uu_app_oidc_redirect_uri");if(r)r=this._toFullAppUrl(r);else{var i=y.getString("uuoidc.redirectUri")
;i||y.getBoolean("uu_app_oidc_backend_available")||(i="callbacks/oidc-callback.html"),r=i?this._toFullUrl(i):this._toFullAppUrl("/oidc/callback")}this._redirectUri=r,this._authnFlow=null,
this._loadAuthnFlowPromise=this._loadAuthnFlow(),this._autoLogoutSupportInitialized=!1,this._autoTokenRefreshInitialized=!1,this._sessionExtendedAndExpiringSupportInitialized=!1,
this._sessionStateChangeNotifierInitialized=!1}return f(L,null,[{key:"_onPageLoad",value:(o=c(regeneratorRuntime.mark((function t(e){var n;return regeneratorRuntime.wrap((function(t){
for(;;)switch(t.prev=t.next){case 0:return this._onPageLoadPromise||(this._onPageLoadFinished=!1,n=c(regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){
for(;;)switch(t.prev=t.next){case 0:if(null==(n=y.getBoolean("uu_app_oidc_restore_session_on_load"))&&(n=!0),!n){t.next=7;break}return t.next=5,this.restoreSession({callToken:e});case 5:t.next=11
;break;case 7:if(!(r=this._providers[this._primaryProvider])){t.next=11;break}return t.next=11,r._loadAsyncData();case 11:this._onPageLoadFinished=!0;case 12:case"end":return t.stop()}}),t,this)
}))).bind(this),this._onPageLoadPromise=n()),t.abrupt("return",this._onPageLoadPromise);case 2:case"end":return t.stop()}}),t,this)}))),function(t){return o.apply(this,arguments)})},{key:"load",
value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];x.load(L,t)}},{key:"create",value:function(t){
var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.force||!1;if(n||!this._providers[t]){var r=new this(t,e)
;"uu_oidcg01_main"===t||"uu_oidcg01_main"===t?(p._register("uu_oidcg01_main",r),p._register("uu_oidcg01_main",r)):p._register(t,r),p._register("uu_appg01_oidc",this),
"uu_oidcg01_main"===t&&(t="uu_oidcg01_main"),this._providers[t]=r,this._primaryProvider||(this._primaryProvider=t),this._restoreSessionPromise=null,this._isRestoringSession=!1,
this._logger=S.get("uuapp.oidc.AuthenticationService")}}},{key:"authenticate",value:(n=c(regeneratorRuntime.mark((function t(e){var n,r,i=arguments;return regeneratorRuntime.wrap((function(t){
for(;;)switch(t.prev=t.next){case 0:if(n=i.length>1&&void 0!==i[1]?i[1]:null,this._onPageLoadPromise||this._onPageLoad(null),this._onPageLoadFinished){t.next=5;break}return t.next=5,
this._onPageLoadPromise;case 5:return r=this._providers[this._primaryProvider],t.next=8,r.authenticate(e,n);case 8:return t.abrupt("return",t.sent);case 9:case"end":return t.stop()}}),t,this)}))),
function(t){return n.apply(this,arguments)})},{key:"isAuthenticating",value:function(){var t=this._providers[this._primaryProvider];return t?t.isAuthenticating():null}},{key:"getServiceName",
value:function(){var t=this._providers[this._primaryProvider];return t?t.getServiceName():null}},{key:"getServiceUri",value:(e=c(regeneratorRuntime.mark((function t(){var e
;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(e=this._providers[this._primaryProvider])){t.next=7;break}return t.next=4,e.getServiceUri();case 4:t.t0=t.sent,
t.next=8;break;case 7:t.t0=null;case 8:return t.abrupt("return",t.t0);case 9:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"getProviderUri",
value:function(){var t=this._providers[this._primaryProvider];return t?t.getProviderUri():null}},{key:"getCurrentSession",value:function(){var t=this._providers[this._primaryProvider]
;return t?t.getCurrentSession():null}},{key:"restoreSession",value:(t=c(regeneratorRuntime.mark((function t(){var e,n,r=arguments;return regeneratorRuntime.wrap((function(t){
for(;;)switch(t.prev=t.next){case 0:return e=r.length>0&&void 0!==r[0]?r[0]:{},this._restoreSessionPromise||(this._isRestoringSession=!0,n=c(regeneratorRuntime.mark((function t(){
var n,r,o,a,u,c,h,l,f,d,p,g,v,m,S,b;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null==(n=y.getBoolean("uu_app_oidc_secondary_providers_enabled"))&&(n=!1),
n&&1!==Object.keys(this._providers).length){t.next=12;break}return t.prev=3,t.next=6,this._providers[this._primaryProvider].restoreSession(e);case 6:return t.abrupt("return",t.sent);case 7:
return t.prev=7,this._isRestoringSession=!1,t.finish(7);case 10:t.next=54;break;case 12:for(this._logger.debug("Trying to restore session for any available authentication service."),
(r=[]).push(this._providers[this._primaryProvider]),o=0,a=Object.values(this._providers);o<a.length;o++)(u=a[o]).getServiceName()!==this._primaryProvider&&r.push(u);c=[],h=null,
l=this._primaryProvider,f=0,d=r;case 20:if(!(f<d.length)){t.next=39;break}return p=d[f],this._primaryProvider=p.getServiceName(),t.prev=23,t.next=26,p.restoreSession(e);case 26:
if(!(h=t.sent).getIdentity()){t.next=30;break}return this._logger.debug("Setting ".concat(p.getServiceName()," as default service.")),t.abrupt("break",39);case 30:t.next=35;break;case 32:t.prev=32,
t.t0=t.catch(23),c.push([p.getServiceName(),t.t0]);case 35:this._primaryProvider=l;case 36:f++,t.next=20;break;case 39:if(h.getIdentity()){t.next=52;break}
if(this._logger.debug("No existing session found, keeping ".concat(this._primaryProvider," as default service.")),!(c.length>0)){t.next=48;break}g=s(c);try{for(g.s();!(v=g.n()).done;)m=i(v.value,2),
S=m[0],b=m[1],this._logger.error("Authentication with ".concat(S," failed."),b)}catch(t){g.e(t)}finally{g.f()}throw this._isRestoringSession=!1,c.pop()[1];case 48:return this._isRestoringSession=!1,
t.abrupt("return",h);case 50:t.next=54;break;case 52:return this._isRestoringSession=!1,t.abrupt("return",h);case 54:case"end":return t.stop()}}),t,this,[[3,,7,10],[23,32]])}))).bind(this),
this._restoreSessionPromise=n()),t.abrupt("return",this._restoreSessionPromise);case 3:case"end":return t.stop()}}),t,this)}))),function(){return t.apply(this,arguments)})},{key:"isRestoringSession",
value:function(){return this._isRestoringSession}},{key:"addListener",value:function(t,e){for(var n=[],r=0,i=Object.values(this._providers);r<i.length;r++){var o=i[r];n.push(o.addListener(t,e))}
return function(){var t,e=s(n);try{for(e.s();!(t=e.n()).done;){(0,t.value)()}}catch(t){e.e(t)}finally{e.f()}}}},{key:"removeListener",value:function(t,e){
for(var n=0,r=Object.values(this._providers);n<r.length;n++){r[n].removeListener(t,e)}}},{key:"isSessionExpiring",value:function(){var t=this._providers[this._primaryProvider]
;return t?t.isSessionExpiring():null}}]),f(L,[{key:"getServiceName",value:function(){return this._serviceName}},{key:"getServiceUri",value:(j=c(regeneratorRuntime.mark((function t(){
return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._oauthClient.getIssuer();case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}
}),t,this)}))),function(){return j.apply(this,arguments)})},{key:"getProviderUri",value:function(){return this._serviceUri}},{key:"getCurrentSession",value:function(){return this._currentSession}},{
key:"restoreSession",value:(H=c(regeneratorRuntime.mark((function t(){var e,n,r,i,s,o,a,u,c,h=this,l=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:
if(e=l.length>0&&void 0!==l[0]?l[0]:{},this._restoreSessionPromise){t.next=11;break}return this._isRestoringSession=!0,
this._logger.debug("Trying to restore session for ".concat(this.getServiceName(),".")),r=(n=e||{}).acrValues,i=n.maxAge,s=n.callToken,t.next=7,C.getClientCredentials(this._serviceName);case 7:
o=t.sent,(a=T.loadFromCache(this,o.client_id))&&a.matches(r||this._defaultAcrValues,i||this._defaultMaxAge)?(this._logger.debug("Session for ".concat(this.getServiceName()," loaded from cache.")),
u=this._authenticateBySession.bind(this),
c=a):s?(this._logger.warn("Trying to initialize session by access_token for ".concat(this.getServiceName(),". This method is deprecated and is going to be removed!")),
u=this._authenticateByCallToken.bind(this),c=s):(u=this.authenticate.bind(this),c={prompt:"none",acrValues:r,maxAge:i}),this._restoreSessionPromise=u(c).then((function(t){
return h._logger.debug("Session for ".concat(h.getServiceName()," restored.")),h._isRestoringSession=!1,t}),(function(t){
return t&&(t.code&&t.code.match(/(interaction|login|account_selection|consent)_required/i)||t.message&&t.message.match(/interaction required/i))?h._logger.debug("Restore of session for ".concat(h.getServiceName()," failed, user interaction is required (").concat(t.code,").")):h._logger.error("Restore of session for ".concat(h.getServiceName()," failed."),t),
h._isRestoringSession=!1,h._currentSession}));case 11:return t.abrupt("return",this._restoreSessionPromise);case 12:case"end":return t.stop()}}),t,this)}))),function(){return H.apply(this,arguments)})
},{key:"isRestoringSession",value:function(){return this._isRestoringSession}},{key:"checkSession",value:function(){return this._sessionChecker&&this._sessionChecker._checkState(),null}},{
key:"authenticate",value:(O=c(regeneratorRuntime.mark((function t(e){var n,r,i,s,o,a,u,c=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:
if(n=c.length>1&&void 0!==c[1]?c[1]:null,!this._runningAuthnPromise||!this._equalsArray(this._runningAuthnArgs,Array.prototype.slice.call(c))){t.next=5;break}
return(r=this._runningAuthnPromise.uiComponent)&&"function"==typeof r.focus&&r.focus(),t.abrupt("return",this._runningAuthnPromise);case 5:if(!e||!e.os8Token){t.next=9;break}
i=new F(this._oauthClient,this._serviceName,this._redirectUri),t.next=13;break;case 9:if(this._authnFlow){t.next=12;break}return t.next=12,this._loadAuthnFlowPromise;case 12:i=this._authnFlow;case 13:
return s=e&&e.scopeMode?e.scopeMode:this._defaultScopeMode,n&&0!=n.length||"none"===s||(n=(n=B||D).replace(/\/$/,"")),t.prev=15,this._runningAuthnArgs=Array.prototype.slice.call(c),
this._runningAuthnPromise=i.authenticate(e,n),t.next=20,this._runningAuthnPromise;case 20:return o=t.sent,t.next=23,this._oauthClient.getSupportedAcrValues();case 23:return a=t.sent,
u=new _(this._serviceName,this._oauthClient,a,o.claims,o.idToken,o.accessToken),(u=T.from(u,o.authenticationContext,o.globalSessionExpiresAt,o.globalSessionState,this))._authConstraints={
scope:o.scope,acrValues:o.acrValues,maxAge:o.maxAge},this._currentSession=u,this._initHandlers(),u&&(u._onCloseListener=this._onSessionClose.bind(this),u.storeToCache(o.clientId)),
this._triggerEvent("sessionChanged",u),t.abrupt("return",u);case 32:return t.prev=32,this._runningAuthnArgs=[],this._runningAuthnPromise=null,t.finish(32);case 36:case"end":return t.stop()}
}),t,this,[[15,,32,36]])}))),function(t){return O.apply(this,arguments)})},{key:"isAuthenticating",value:function(){return!!this._runningAuthnPromise}},{key:"addListener",value:function(t,e){
var n=this._listeners[t];return n||(n=this._listeners[t]=[]),n.push(e),this.removeListener.bind(this,t,e)}},{key:"removeListener",value:function(t,e){var n=this._listeners[t];if(!n)return!1
;var r=n.indexOf(e);return-1!=r&&n.splice(r,1),-1!=r}},{key:"isSessionExpiring",value:function(){return this._globalSessionExpiring}},{key:"_loadAsyncData",
value:(N=c(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._oauthClient.getMetadata();case 2:return t.next=4,
C.getClientCredentials(this._serviceName);case 4:case"end":return t.stop()}}),t,this)}))),function(){return N.apply(this,arguments)})},{key:"_loadAuthnFlow",
value:(I=c(regeneratorRuntime.mark((function t(){var e,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(e=y.get("uu_app_oidc_authn_flow_override"))){t.next=21
;break}if("string"!=typeof e){t.next=14;break}return t.prev=3,t.next=6,SystemJS.import(e);case 6:this._authnFlow=t.sent,t.next=12;break;case 9:throw t.prev=9,t.t0=t.catch(3),
new m("Unable to load authentication flow override.",t.t0);case 12:t.next=19;break;case 14:if("object"!==r(e)){t.next=18;break}this._authnFlow=e,t.next=19;break;case 18:
throw new m("Authentication flow override '".concat(e,"' is not supported."));case 19:t.next=31;break;case 21:if("implicit"!==(n=y.getString(P+this._serviceName+"_authentication_type")||"implicit")){
t.next=26;break}this._authnFlow=new E(this._oauthClient,this._serviceName,this._redirectUri,D),t.next=31;break;case 26:if("code"!==n){t.next=30;break}
this._authnFlow=new A(this._oauthClient,this._serviceName,this._redirectUri,D),t.next=31;break;case 30:throw new m("Authentication type '".concat(n,"' is not supported."));case 31:case"end":
return t.stop()}}),t,this,[[3,9]])}))),function(){return I.apply(this,arguments)})},{key:"_authenticateBySession",value:(v=c(regeneratorRuntime.mark((function t(e){var n
;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=c(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){
for(;;)switch(t.prev=t.next){case 0:return t.next=2,C.getClientCredentials(this._serviceName);case 2:return t.next=4,this._oauthClient.getSupportedAcrValues();case 4:return t.abrupt("return",{
session:e,authCtx:e.getAuthenticationContext(),globalSessionExpiresAt:e.getExpiresAt(),globalSessionState:e.getState()});case 5:case"end":return t.stop()}}),t,this)}))).bind(this),t.prev=1,
this._runningAuthnPromise=n(),t.next=5,this._runningAuthnPromise;case 5:return this._currentSession=e,this._initHandlers(),e&&(e._onCloseListener=this._onSessionClose.bind(this)),
this._triggerEvent("sessionChanged",e),t.abrupt("return",e);case 10:return t.prev=10,this._runningAuthnArgs=[],this._runningAuthnPromise=null,t.finish(10);case 14:case"end":return t.stop()}
}),t,this,[[1,,10,14]])}))),function(t){return v.apply(this,arguments)})},{key:"_authenticateByCallToken",value:(d=c(regeneratorRuntime.mark((function t(e){var n,r,i
;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=c(regeneratorRuntime.mark((function t(){var n,r,i,s,o,a,u,h,l;return regeneratorRuntime.wrap((function(t){
for(;;)switch(t.prev=t.next){case 0:if(!e.match(R)){t.next=7;break}return t.next=3,this._oauthClient.parseToken(e);case 3:n=t.sent,r=e,t.next=14;break;case 7:return s=new b({baseUri:B||D}),o={
authorization:"Bearer ".concat(e)},a={_:Date.now()},t.next=12,s.get("oidc/introspect",a,{headers:o});case 12:n=t.sent.data,i=e;case 14:return t.next=16,this._oauthClient.getIssuer();case 16:
if(u=t.sent,n.iss===u){t.next=19;break}throw new g("Token is not trusted (unknown token issuer).");case 19:return t.next=21,C.getClientCredentials(this._serviceName);case 21:return t.next=23,
this._oauthClient.getSupportedAcrValues();case 23:return h=t.sent,l=new _(this._serviceName,this._oauthClient,h,n,r,i),
(l=T.from(l,null,null,null,null,this)).getCallToken=c(regeneratorRuntime.mark((function t(){var e,n,r=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:
if(r.length>0&&void 0!==r[0]&&r[0],e=r.length>1&&void 0!==r[1]?r[1]:{},!(n=this._idToken||this._accessToken)){t.next=12;break}if(!0!==(!!e&&e.excludeAuthenticationType)){t.next=9;break}
return t.abrupt("return",n);case 9:return t.abrupt("return","Bearer ".concat(n));case 10:t.next=13;break;case 12:return t.abrupt("return",null);case 13:case"end":return t.stop()}}),t,this)
}))).bind(l),l.close=c(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.removeFromCache(),
this._authenticated&&"function"==typeof this._onCloseListener&&this._onCloseListener(this),this._authenticated=!1,this._idToken=null,this._accessToken=null;case 5:case"end":return t.stop()}}),t,this)
}))).bind(l),t.abrupt("return",{session:l});case 29:case"end":return t.stop()}}),t,this)}))).bind(this),t.prev=1,this._runningAuthnPromise=n(),t.next=5,this._runningAuthnPromise;case 5:
return r=t.sent,i=r.session,this._currentSession=i,i&&(i._onCloseListener=this._onSessionClose.bind(this)),this._triggerEvent("sessionChanged",i),t.abrupt("return",i);case 11:return t.prev=11,
this._runningAuthnArgs=[],this._runningAuthnPromise=null,t.finish(11);case 15:case"end":return t.stop()}}),t,this,[[1,,11,15]])}))),function(t){return d.apply(this,arguments)})},{key:"_initHandlers",
value:function(){this._autoLogoutSupportInitialized||(this._initAutoLogoutSupport(),this._autoLogoutSupportInitialized=!0),this._autoTokenRefreshInitialized||(this._initAutoTokenRefresh(),
this._autoTokenRefreshInitialized=!0),this._sessionExtendedAndExpiringSupportInitialized||(this._initSessionExtendedAndExpiringSupport(),this._sessionExtendedAndExpiringSupportInitialized=!0),
this._sessionStateChangeNotifierInitialized?this._sessionChecker&&this._sessionChecker.enable():(this._initSessionStateChangeNotifier(),this._sessionStateChangeNotifierInitialized=!0)}},{
key:"_initAutoLogoutSupport",value:function(){var t,e=this;this.addListener("sessionChanged",(function(n){if(t&&(clearTimeout(t),t=null),e._currentSession&&e._currentSession.isAuthenticated()){
var r=e._currentSession.getExpiresAt()||1e3*(e._currentSession.getAttribute("exp")||0);if(r){var i=Date.now(),s=Math.max(0,r-i)
;e._logger.debug("Planning local auto-logout at ".concat(e._toTimeString(new Date(i+s)),".")),t=setTimeout((function(){t=null,e._localLogout()}),s)}}}))}},{key:"_initAutoTokenRefresh",
value:function(){var t=this,e=y.getBoolean(P+this._serviceName+"_token_refresh_enabled");null==e&&(e=y.getBoolean("uuoidc.tokenRefreshEnabled")),null==e&&(e=!0)
;var n=y.getNumber(P+this._serviceName+"_token_refresh_leeway");null==n&&(n=y.getNumber("uuoidc.tokenRefreshLeeway")),null==n&&(n=300)
;var r,i=y.getNumber(P+this._serviceName+"_token_refresh_failure_retry_interval");null==i&&(i=y.getNumber("uuoidc.tokenRefreshFailureRetryInterval")),(null==i||i<0)&&(i=30),i&&(i=Math.max(5,i)),
this._tokenRefreshFailureRetryInterval=i,this.addListener("sessionChanged",(function(i){if(e){r&&(clearTimeout(r),r=null)
;var s=t._currentSession&&t._currentSession.isAuthenticated()&&1e3*t._currentSession.getAttribute("exp");if(s){var o,a=Date.now(),u=s-a
;u<1e3*n?(t._logger.warn("Received token with unexpectedly short expiration time of ".concat(Math.floor(u/1e3),"s. Either session is ")+"nearing expiration, or current configuration of automatic token refresh is not suitable for used oidc provider."),
o=u-Math.floor(u/10)):o=u-1e3*n,o=Math.max(o,1e3),t._logger.debug("Planning token auto-refresh at ".concat(t._toTimeString(new Date(a+o)),".")),r=setTimeout((function(){r=null,t._silentTokenRefresh()
}),o)}}}))}},{key:"_initSessionExtendedAndExpiringSupport",value:function(){var t,e=this;this.addListener("sessionChanged",(function(n){var r=e._currentSession.getExpiresAt()||0,i=t&&r>t+1e4;if(t=r,
i){e._globalSessionExpiring=!1;var s=t;setTimeout((function(){e._triggerEvent("sessionExtended",{expiresAt:s})}),0)}}));var n=y.getNumber(P+this._serviceName+"_session_expiring_notification_time")
;null==n&&(n=y.getNumber("uuoidc.sessionExpiringNotificationTime")),null==n&&(n=1800);var r,i=void 0;this.addListener("sessionChanged",(function(t){if(!(n<=0)){r&&(clearTimeout(r),r=null)
;var s=e._currentSession&&e._currentSession.isAuthenticated()&&e._currentSession.getIdentity(),o=s&&s.getUuIdentity();o!=i&&(e._globalSessionExpiring=!1),i=o;var a=e._currentSession.getExpiresAt()
;if(a&&!e._globalSessionExpiring){var u=Date.now(),c=Math.max(0,a-u-1e3*n);e._logger.debug("Planning sessionExpiring notification at ".concat(e._toTimeString(new Date(u+c)),".")),
r=setTimeout((function(){r=null,e._globalSessionExpiring=!0,e._triggerEvent("sessionExpiring",{expiresAt:a})}),c)}}})),this.addListener("sessionExpiring",(function(t){
var n=t.data.expiresAt,i=Math.floor((n-Date.now())/2);i>5e3&&(r&&clearTimeout(r),r=setTimeout((function(){r=null,e._globalSessionExpiring=!0,e._triggerEvent("sessionExpiring",{expiresAt:n})}),i))}))}
},{key:"_initSessionStateChangeNotifier",value:(l=c(regeneratorRuntime.mark((function t(){var e,n,r,i=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:
if(null==(e=y.getNumber(P+this._serviceName+"_session_check_interval"))&&(e=y.getNumber("uuoidc.sessionCheckInterval")),null==e&&(e=5),t.t0=e,!t.t0){t.next=8;break}return t.next=7,
this._authnFlow.isCheckSessionSupported();case 7:t.t0=t.sent;case 8:if(!t.t0){t.next=16;break}return t.next=11,C.getClientCredentials(this._serviceName);case 11:n=t.sent,r=n.client_id,
this._sessionChecker=new k(this._authnFlow,e,r,(function(){return i._currentSession.getState()})),this._sessionChecker.onStateChange((function(){i._logger.info("Session state change detected."),
i._silentTokenRefresh(!0)})),this._sessionChecker.onStateUnknown((function(){i._logger.info("Unexpected session loss detected."),i._triggerEvent("sessionLost")}));case 16:case"end":return t.stop()}
}),t,this)}))),function(){return l.apply(this,arguments)})},{key:"_triggerEvent",value:function(t,e){var n=this;this._logger.debug('Launching event "'.concat(t,'".'));var r=this._listeners[t];if(r){
var i={type:t,data:e};r.forEach((function(t){return t.call(n,i)}))}}},{key:"_onSessionClose",value:function(t){this._localLogout()}},{key:"_localLogout",value:function(){
this._logger.debug("Performing local-logout."),this._currentSession.removeFromCache(),this._currentSession!=this._emptySession&&(this._currentSession=this._emptySession,this._globalSessionExpiring=!1,
this._triggerEvent("sessionChanged",this._currentSession)),this._sessionChecker&&this._sessionChecker.disable()}},{key:"_silentTokenRefresh",value:(u=c(regeneratorRuntime.mark((function t(e){
var n,r,i=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e||!(this._silentTokenRefreshTimeout||this._silentTokenRefreshInProgress>0)){t.next=2;break}
return t.abrupt("return");case 2:return this._silentTokenRefreshTimeout&&(clearTimeout(this._silentTokenRefreshTimeout),delete this._silentTokenRefreshTimeout),n=0,r=function(){
var t=c(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i._currentSession&&i._currentSession.isAuthenticated()){t.next=2;break}
return t.abrupt("return");case 2:return i._logger.debug("Silent token refresh - starting."),++i._silentTokenRefreshInProgress,++n,t.prev=5,t.next=8,i._doAuthenticateRefresh();case 8:
--i._silentTokenRefreshInProgress,t.next=16;break;case 11:t.prev=11,t.t0=t.catch(5),--i._silentTokenRefreshInProgress,
!i._silentTokenRefreshTimeout&&i._tokenRefreshFailureRetryInterval?(i._logger.debug("Silent token refresh - will retry in ".concat(i._tokenRefreshFailureRetryInterval,"s (operation ended with unexpected error)."),t.t0),
i._silentTokenRefreshTimeout=setTimeout((function(){delete i._silentTokenRefreshTimeout,r()
}),1e3*i._tokenRefreshFailureRetryInterval)):i._silentTokenRefreshTimeout?i._logger.debug("Silent token refresh - ending current run with no-op (operation ended with unexpected error and another retry is already planned).",t.t0):i._logger.debug("Silent token refresh - ending with no-op (operation ended with unexpected error).",t.t0),
1===n?i._logger.warn("Token refresh failed with error:",t.t0):2===n&&i._logger.error("Suppressing further notifications of token refresh problem to prevent log cluttering (until success or logout).")
;case 16:case"end":return t.stop()}}),t,null,[[5,11]])})));return function(){return t.apply(this,arguments)}}(),t.next=7,r();case 7:case"end":return t.stop()}}),t,this)}))),function(t){
return u.apply(this,arguments)})},{key:"_equalsArray",value:function(t,e){return t.length===e.length&&t.every((function(t,n){return t===e[n]}))}},{key:"_toFullAppUrl",value:function(t){
var e=document.createElement("a");return e.href=t&&t.match(/^[a-z]+:/i)?t:D+(t?t.replace(/^\/+/,""):""),e.href.toString()}},{key:"_toFullUrl",value:function(t){var e=document.createElement("a")
;return e.href=t||"",e.href.toString()}},{key:"_toTimeString",value:function(t){return("0"+t.getHours()).substr(-2)+":"+("0"+t.getMinutes()).substr(-2)+":"+("0"+t.getSeconds()).substr(-2)}},{
key:"_doAuthenticateRefresh",value:(a=c(regeneratorRuntime.mark((function t(){var e,n,r,i,s,o,a,u,c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,
this._authnFlow){t.next=4;break}return t.next=4,this._loadAuthnFlowPromise;case 4:return e=this._currentSession?this._currentSession._authConstraints:null,n=e?e.scope:null,r=e?e.acrValues:null,
i=e?e.maxAge:null,t.next=11,this._authnFlow.authenticate({acrValues:r,maxAge:i,prompt:"none",usePopup:!1},n);case 11:if(s=t.sent,this._currentSession&&this._currentSession.isAuthenticated()){t.next=16
;break}this._logger.debug("Silent token refresh - ending with no-op (local session is already logged out)."),t.next=27;break;case 16:
if(!this._currentSession||!this._currentSession._supportedAcrValues){t.next=20;break}o=this._currentSession._supportedAcrValues,t.next=23;break;case 20:return t.next=22,
this._oauthClient.getSupportedAcrValues();case 22:o=t.sent;case 23:a=new _(this._serviceName,this._oauthClient,o,s.claims,s.idToken,s.accessToken),u=this._currentSession.getIdentity(),
c=a.getIdentity(),
u&&c&&u.getUuIdentity()!==c.getUuIdentity()||(!u||!c)&&u!=c?(this._logger.debug("Silent token refresh - ending with local logout (user that is logged in on remote is different from the local one)."),
this._localLogout()):(this._logger.debug("Silent token refresh - ending with token renewed."),
(a=T.from(a,s.authenticationContext,s.globalSessionExpiresAt,s.globalSessionState,this))._authConstraints=e,this._currentSession=a,a&&(a._onCloseListener=this._onSessionClose.bind(this),
a.storeToCache(s.clientId)),this._triggerEvent("sessionChanged",a));case 27:t.next=34;break;case 29:return t.prev=29,t.t0=t.catch(0),
t.t0&&(t.t0.code&&t.t0.code.match(/(interaction|login|account_selection|consent)_required/i)||t.t0.message&&t.t0.message.match(/interaction required/i))?this._logger.debug("Silent token refresh ending with local logout, user interaction is required (".concat(t.t0.code,").")):this._logger.error("Silent token refresh failed, ending with local logout.",t.t0),
this._localLogout(),t.abrupt("return");case 34:case"end":return t.stop()}}),t,this,[[0,29]])}))),function(){return a.apply(this,arguments)})}]),L}();N._providers={},N._primaryProvider=null,N.load(!1),
t.exports=N},function(t,e,n){"use strict";function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),
Object.defineProperty(t,r.key,r)}}
var i=n(1),s=i.Config,o=i.BaseError,a=n(0).AuthenticationService,u="uu_app_oidc_providers_",c="99923616732452117-4f06dafc03cb4c7f8c155aa53f0e86be",h="https://uuidentity.plus4u.net/uu-oidc-maing02/bb977a99f4cc4c37a2afce3fd599d0a7/oidc",l=function(){
function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,i;return e=t,i=[{key:"load",value:function(t){
var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e&&(Object.keys(t._providers).forEach((function(t){delete a._realizations[t]})),delete a._realizations.uu_oidcg01_main,t._providers={},
t._primaryProvider=null),this.loadOidcg01(t,e),this.loadOidcg02(t,e);var n=null;if("undefined"==typeof window)n=s.toJSON();else{var r=s.chain._sources[0];n=Object.assign(r?r._data:{},s.chain._custom)}
for(var i=Object.keys(n),c=0;c<i.length;c+=1){var h=i[c],l=n[h],f=new RegExp("^".concat(u,"(.*)_uri$")).exec(h);if(f){var d=f[1],p="".concat(u).concat(d);if("oidcg01"!==d&&"oidcg02"!==d){
var g=s.getBoolean("".concat(p,"_enabled"),!1);if("boolean"!=typeof g||g){d=s.getString("".concat(p,"_name"),!1)||d;var v={serviceUri:l,verifySsl:s.getBoolean("".concat(p,"_verify_ssl"),!1),
accessTokenPattern:s.getString("".concat(p,"_access_token_pattern"),!1),refreshTokenPattern:s.getString("".concat(p,"_refresh_token_pattern"),!1),
verifyAudience:s.getBoolean("".concat(p,"_verify_audience"),!1),allowAudienceAlias:s.getBoolean("uu_app_oidc_allow_audience_alias",!1),tokenCacheSize:s.getNumber("".concat(p,"_token_cache_size"),!1),
tokenTimeLeeway:s.getNumber("".concat(p,"_token_time_leeway"),!1),discoveryPath:s.getNumber("".concat(p,"_discovery_path"),!1),discoveryCacheTtl:s.getNumber("".concat(p,"_discovery_cache_ttl"),!1),
jwksCacheTtl:s.getNumber("".concat(p,"_jwks_cache_ttl"),!1),defaultScope:s.getString("".concat(p,"_default_scope"),!1),perflogEnabled:s.getBoolean("".concat(p,"_perflog_enabled"),!1),force:e}
;t.create(d,v)}}}}var y=s.getString("uu_app_oidc_primary_provider",!1);if(y){if(!t._providers[y])throw new o("Cannot set primary provider to ".concat(y,". Service does not exits or is not enabled."))
;t._primaryProvider=y}}},{key:"loadOidcg01",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n="".concat(u).concat("oidcg01"),r=s.getBoolean("".concat(n,"_enabled"),!1)
;if("boolean"!=typeof r&&(r=!0),r){var i=s.getString("".concat(n,"_uri"),!1);if(!i&&!(i=s.getString("uu_oidc_server_uri",!1))&&!(i=s.getString("uuoidc.serverUri",!1))){
var o=s.getString("uu_oidc_server_tenant_id",!1);i="".concat("https://oidc.plus4u.net/uu-oidcg01-main","/").concat(o||c)}var a=s.getBoolean("".concat(n,"_verify_ssl"),!1)
;null==a&&(a=0!==s.getNumber("uu_oidc_client_ssl_verify_mode"));var h=s.getBoolean("".concat(n,"_verify_audience"),!1);null==h&&null==(h=s.getBoolean("uu_oidc_session_verify_audience",!1))&&(h=!1)
;var l={force:e,serviceUri:i,verifySsl:a,verifyAudience:h,allowAudienceAlias:s.getBoolean("uu_app_oidc_allow_audience_alias",!1),
accessTokenPattern:s.getString("".concat(n,"_access_token_pattern"),!1)||"^UUOIDCAT-.*",refreshTokenPattern:s.getString("".concat(n,"_refresh_token_pattern"),!1)||"^UUOIDCRT-.*",
tokenCacheSize:s.getNumber("".concat(n,"_token_cache_size"),!1),tokenTimeLeeway:s.getNumber("".concat(n,"_token_time_leeway"),!1),discoveryCacheTtl:s.getNumber("".concat(n,"_discovery_cache_ttl"),!1),
jwksCacheTtl:s.getNumber("".concat(n,"_jwks_cache_ttl"),!1),defaultScope:s.getString("".concat(n,"_default_scope"),!1),perflogEnabled:s.getBoolean("".concat(n,"_perflog_enabled"),!1)}
;t.create("oidcg01",l)}}},{key:"loadOidcg02",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n="".concat(u).concat("oidcg02"),r=s.getBoolean("".concat(n,"_enabled"),!1)
;if("boolean"!=typeof r&&(r=!0),r){var i=s.getString("".concat(n,"_uri"),!1),o=s.getBoolean("".concat(n,"_verify_audience"),!1);null==o&&(o=!0);var a={force:e,serviceUri:i||h,
verifySsl:s.getBoolean("".concat(n,"_verify_ssl"),!1),accessTokenPattern:s.getString("".concat(n,"_access_token_pattern"),!1)||"^at.*",
refreshTokenPattern:s.getString("".concat(n,"_refresh_token_pattern"),!1)||"^rt.*",verifyAudience:o,allowAudienceAlias:s.getBoolean("uu_app_oidc_allow_audience_alias",!1),
tokenCacheSize:s.getNumber("".concat(n,"_token_cache_size"),!1),tokenTimeLeeway:s.getNumber("".concat(n,"_token_time_leeway"),!1),discoveryCacheTtl:s.getNumber("".concat(n,"_discovery_cache_ttl"),!1),
jwksCacheTtl:s.getNumber("".concat(n,"_jwks_cache_ttl"),!1),defaultScope:s.getString("".concat(n,"_default_scope"),!1),perflogEnabled:s.getBoolean("".concat(n,"_perflog_enabled"),!1)}
;t.create("oidcg02",a)}}}],(n=null)&&r(e.prototype,n),i&&r(e,i),t}();t.exports=l},function(t,e,n){"use strict";function r(t){
return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){
return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t){return function(t){if(Array.isArray(t))return s(t)}(t)||function(t){
if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return s(t,e);var n=Object.prototype.toString.call(t).slice(8,-1)
;"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return s(t,e)}(t)||function(){
throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(t,e){
(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function o(t,e,n,r,i,s,o){try{var a=t[s](o),u=a.value}catch(t){return void n(t)}
a.done?e(u):Promise.resolve(u).then(r,i)}function a(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var s=t.apply(e,n);function a(t){o(s,r,i,a,u,"next",t)}function u(t){
o(s,r,i,a,u,"throw",t)}a(void 0)}))}}function u(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function c(t,e){for(var n=0;n<e.length;n++){var r=e[n]
;r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}
var h=n(26),l=n(1).BaseError,f=n(2),d=f.AppClient,p=f.ApplicationError,g=n(0),v=g.InvalidCredentials,y=g.AuthenticationError,m=n(2),S=m.PerflogHandler,b=m.RemoteErrorHandler,x=m.TransformParametersHandler,w=n(6),_=n(27),E=n(28),A=n(8),F=n(12),C=[S,b,x],k=[b,x],T="application/x-www-form-urlencoded",P="application/json",R="urn:ietf:params:oauth:token-type:".concat("id_token"),I="urn:ietf:params:oauth:token-type:".concat("access_token"),D="urn:ietf:params:oauth:token-type:".concat("refresh_token"),B="urn:ietf:params:oauth:client-assertion-type:jwt-bearer",N=/^[a-zA-Z0-9\-_]+\.[a-zA-Z0-9\-_]+\.[a-zA-Z0-9\-_]+$/,O=["none","low","medium","high","veryHigh"],H=["none","low","standard","high","veryHigh"],j=function(){
function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(u(this,t),!e)throw new l("Service URI must be defined");var r=n.tokenCacheSize?Number(n.tokenCacheSize):2048
;this._tokenCache=new F({maxSize:r}),this._tokenTimeLeeway=n.tokenTimeLeeway?Number(n.tokenTimeLeeway):300,this._discovery=new _(e,n),this._jwks=new E(this._discovery,n)
;var i="boolean"!=typeof n.perflogEnabled||n.perflogEnabled,s=i?C:k;this._client=new d(Object.assign(n,{interceptors:s})),this._metadata=null,this._serviceUri=e,
this._defaultScope=null!=n.defaultScope?n.defaultScope:"openid",this._accessTokenPattern=new RegExp(n.accessTokenPattern||".^"),this._refreshTokenPattern=new RegExp(n.refreshTokenPattern||".^")}
var e,n,s,o,f,g,m,S,b,x,j,L,V,U,K,M,q,z,W,J,G,Y;return e=t,(n=[{key:"getServiceUri",value:function(){return this._serviceUri}},{key:"getMetadata",value:(Y=a(regeneratorRuntime.mark((function t(){
return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._discovery.getMetadata();case 2:return this._metadata=t.sent,t.abrupt("return",this._metadata)
;case 4:case"end":return t.stop()}}),t,this)}))),function(){return Y.apply(this,arguments)})},{key:"getMetadataSync",value:function(){
if(!this._metadata)throw new w("Asynchronous method getMetadata must be invoked prior to synchronous invocation");return this._metadata}},{key:"getIssuer",
value:(G=a(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getMetadata();case 2:
return t.abrupt("return",t.sent.issuer);case 3:case"end":return t.stop()}}),t,this)}))),function(){return G.apply(this,arguments)})},{key:"getSupportedAcrValues",
value:(J=a(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getMetadata();case 2:
if(t.t0=t.sent.acr_values_supported,t.t0){t.next=5;break}t.t0=[];case 5:return t.abrupt("return",t.t0);case 6:case"end":return t.stop()}}),t,this)}))),function(){return J.apply(this,arguments)})},{
key:"getSupportedAcrValuesSync",value:function(){return this.getMetadataSync().acr_values_supported||[]}},{key:"getUserInfoUri",value:(W=a(regeneratorRuntime.mark((function t(){
return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getMetadata();case 2:return t.abrupt("return",t.sent.userinfo_endpoint);case 3:case"end":
return t.stop()}}),t,this)}))),function(){return W.apply(this,arguments)})},{key:"getEndSessionUri",value:(z=a(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){
for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getMetadata();case 2:return t.abrupt("return",t.sent.end_session_endpoint);case 3:case"end":return t.stop()}}),t,this)}))),function(){
return z.apply(this,arguments)})},{key:"getEndSessionUriSync",value:function(){return this.getMetadataSync().end_session_endpoint}},{key:"getCheckSessionIframeUri",
value:(q=a(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getMetadata();case 2:
return t.abrupt("return",t.sent.check_session_iframe);case 3:case"end":return t.stop()}}),t,this)}))),function(){return q.apply(this,arguments)})},{key:"getAuthorizationUri",
value:(M=a(regeneratorRuntime.mark((function t(e,n,r,i){var s,o=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s=o.length>4&&void 0!==o[4]?o[4]:null,
t.next=3,this.getMetadata();case 3:return t.abrupt("return",this.getAuthorizationUriSync(e,n,r,i,s));case 4:case"end":return t.stop()}}),t,this)}))),function(t,e,n,r){return M.apply(this,arguments)})
},{key:"getAuthorizationUriSync",value:function(t,e,n,r){var s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o="".concat(this.getMetadataSync().authorization_endpoint,"?")
;if(o+="response_type=".concat(encodeURIComponent(t),"&"),o+="redirect_uri=".concat(encodeURIComponent(e),"&"),o+="client_id=".concat(encodeURIComponent(n.client_id),"&"),
o+="scope=".concat(encodeURIComponent(this._getOidcScope(s))),r){var a=this.getSupportedAcrValuesSync();if(a&&a.length>0){var u=r.toString()
;a.includes("medium")?u=u.replace("standard","medium"):a.includes("standard")&&(u=u.replace("medium","standard"));var c=u.split(" "),h=[];c.forEach((function(t){if(a.includes(t))h.push(t);else{
var e=Number(t);a.includes(e)?h.push(e):a[e]?h.push(a[e]):((e=O.indexOf(t))>-1||(e=H.indexOf(t))>-1)&&h.push(e)}})),(h=h.filter((function(t){return null!=t
}))).length>1&&!isNaN(h[0])&&(h=[Math.min.apply(Math,i(h))]),h.length>0&&(o+="&acr_values=".concat(encodeURIComponent(h.join(" "))))}}return o}},{key:"grantAuthorizationCodeToken",
value:(K=a(regeneratorRuntime.mark((function t(e,n,r){var i,s,o=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=o.length>3&&void 0!==o[3]?o[3]:null,
(s={}).grant_type="authorization_code",s.code=e,s.client_id=n.client_id,s.scope=this._getOidcScope(i),r&&(s.redirect_uri=r),t.next=9,this._grantToken(s,n);case 9:return t.abrupt("return",t.sent)
;case 10:case"end":return t.stop()}}),t,this)}))),function(t,e,n){return K.apply(this,arguments)})},{key:"grantResourceOwnerPasswordCredentialsToken",
value:(U=a(regeneratorRuntime.mark((function t(e,n,r){var i,s,o=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=o.length>3&&void 0!==o[3]?o[3]:null,
(s={}).grant_type="password",s.username=e,s.password=n,s.scope=this._getOidcScope(i),t.next=8,this._grantToken(s,r);case 8:return t.abrupt("return",t.sent);case 9:case"end":return t.stop()}}),t,this)
}))),function(t,e,n){return U.apply(this,arguments)})},{key:"grantImplicitFlowToken",value:(V=a(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){
for(;;)switch(t.prev=t.next){case 0:throw new l("Method not implemented.");case 1:case"end":return t.stop()}}),t)}))),function(){return V.apply(this,arguments)})},{key:"grantHybridFlowToken",
value:(L=a(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:throw new l("Method not implemented.");case 1:case"end":return t.stop()
}}),t)}))),function(){return L.apply(this,arguments)})},{key:"grantClientCredentialsToken",value:(j=a(regeneratorRuntime.mark((function t(e){var n,r,i=arguments
;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=i.length>1&&void 0!==i[1]?i[1]:null,(r={}).grant_type="client_credentials",r.scope=this._getOidcScope(n),
t.next=6,this._grantToken(r,e);case 6:return t.abrupt("return",t.sent);case 7:case"end":return t.stop()}}),t,this)}))),function(t){return j.apply(this,arguments)})},{key:"refreshToken",
value:(x=a(regeneratorRuntime.mark((function t(e,n){var r,i,s=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=s.length>2&&void 0!==s[2]?s[2]:null,
(i={}).grant_type="refresh_token",i.refresh_token=e,i.scope=this._getOidcScope(r),t.next=7,this._grantToken(i,n);case 7:return t.abrupt("return",t.sent);case 8:case"end":return t.stop()}}),t,this)
}))),function(t,e){return x.apply(this,arguments)})},{key:"exchangeToken",value:(b=a(regeneratorRuntime.mark((function t(e,n){var r,i,s=arguments;return regeneratorRuntime.wrap((function(t){
for(;;)switch(t.prev=t.next){case 0:return r=s.length>2&&void 0!==s[2]?s[2]:null,(i={}).grant_type="urn:ietf:params:oauth:grant-type:token-exchange",i.subject_token=e,
e.match(N)?i.subject_token_type=R:i.subject_token_type=I,i.scope=this._getOidcScope(r),t.next=8,this._grantToken(i,n);case 8:return t.abrupt("return",t.sent);case 9:case"end":return t.stop()}
}),t,this)}))),function(t,e){return b.apply(this,arguments)})},{key:"introspectToken",value:(S=a(regeneratorRuntime.mark((function t(e){var n,r,i,s,o,a,u,c,h,l=arguments
;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=l.length>1&&void 0!==l[1]?l[1]:null,t.next=3,this.getMetadata();case 3:if(r=t.sent,
i=r.token_introspection_endpoint,(s={}).token=e,(o=this._getTokenTypeHint(e))&&(s.token_type_hint=o),(a={})["Content-Type"]=T,a.Accept=P,!n){t.next=17;break}return t.next=15,
this._createClientAuthnHeader(n);case 15:u=t.sent,(c=u.match(/^Bearer (.*)/))?(s.client_id=n.client_id,s.client_assertion=c[1],s.client_assertion_type=B):a.Authorization=u;case 17:return h=null,
t.prev=18,t.next=21,this._client.post(i,s,{headers:a});case 21:h=t.sent,t.next=31;break;case 24:if(t.prev=24,t.t0=t.catch(18),!(t.t0 instanceof p)){t.next=30;break}
throw new v("Invalid credentials.",t.t0);case 30:throw new y("Authentication failed.",t.t0);case 31:if(h.active){t.next=33;break}throw new v("Invalid credentials.");case 33:
return t.abrupt("return",h.data);case 34:case"end":return t.stop()}}),t,this,[[18,24]])}))),function(t){return S.apply(this,arguments)})},{key:"revokeToken",
value:(m=a(regeneratorRuntime.mark((function t(e){var n,r,i,s,o,a,u,c,h,l=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:
return n=l.length>1&&void 0!==l[1]?l[1]:null,t.next=3,this.getMetadata();case 3:if(r=t.sent,i=r.token_revocation_endpoint,(s={}).token=e,(o=this._getTokenTypeHint(e))&&(s.token_type_hint=o),
(a={})["Content-Type"]=T,a.Accept=P,!n){t.next=17;break}return t.next=15,this._createClientAuthnHeader(n);case 15:u=t.sent,(c=u.match(/^Bearer (.*)/))?(s.client_id=n.client_id,s.client_assertion=c[1],
s.client_assertion_type=B):a.Authorization=u;case 17:return h=null,t.prev=18,t.next=21,this._client.post(i,s,{headers:a});case 21:h=t.sent,t.next=31;break;case 24:if(t.prev=24,t.t0=t.catch(18),
!(t.t0 instanceof p)){t.next=30;break}throw new v("Invalid credentials.",t.t0);case 30:throw new y("Authentication failed.",t.t0);case 31:return t.abrupt("return",h.data);case 32:case"end":
return t.stop()}}),t,this,[[18,24]])}))),function(t){return m.apply(this,arguments)})},{key:"parseToken",value:(g=a(regeneratorRuntime.mark((function t(e){var n,i,s,o=arguments
;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=!(o.length>1&&void 0!==o[1])||o[1],i=o.length>2&&void 0!==o[2]?o[2]:null,"object"===r(n)&&(i=n,n=!0),!e.match(N)){
t.next=9;break}return t.next=6,this._jwks.decodeToken(e,n);case 6:s=t.sent,t.next=13;break;case 9:return t.next=11,this.introspectToken(e,i);case 11:s=t.sent,n&&this._jwks.verifyExpiration(s);case 13:
return t.abrupt("return",s);case 14:case"end":return t.stop()}}),t,this)}))),function(t){return g.apply(this,arguments)})},{key:"cacheToken",value:function(t,e,n){
var r=1e3*(e-=2*this._tokenTimeLeeway)-Date.now();r>0&&this._tokenCache.set(t,n,r)}},{key:"getToken",value:function(t){return this._tokenCache.get(t)}},{key:"deleteToken",value:function(t){
return this._tokenCache.delete(t)}},{key:"listTokens",value:function(t){this._tokenCache.forEach(t)}},{key:"_grantToken",value:(f=a(regeneratorRuntime.mark((function t(e){var n,r,i,s,o,a,u,c=arguments
;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=c.length>1&&void 0!==c[1]?c[1]:null,t.next=3,this.getMetadata();case 3:if(r=t.sent,i=r.token_endpoint,
(s={})["Content-Type"]=T,s.Accept=P,!n){t.next=13;break}return t.next=11,this._createClientAuthnHeader(n);case 11:o=t.sent,(a=o.match(/^Bearer (.*)/))?(e.client_id=n.client_id,e.client_assertion=a[1],
e.client_assertion_type=B):s.Authorization=o;case 13:return u=null,t.prev=14,t.next=17,this._client.post(i,e,{headers:s});case 17:u=t.sent,t.next=27;break;case 20:if(t.prev=20,t.t0=t.catch(14),
!(t.t0 instanceof p)){t.next=26;break}throw new v("Invalid credentials.",t.t0);case 26:throw new y("Authentication failed.",t.t0);case 27:return t.abrupt("return",u.data);case 28:case"end":
return t.stop()}}),t,this,[[14,20]])}))),function(t){return f.apply(this,arguments)})},{key:"_createClientAuthnHeader",value:(o=a(regeneratorRuntime.mark((function t(e){var n,r,i,s,o
;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=null,!e.client_private_key){t.next=9;break}return t.next=4,this.getMetadata();case 4:r=t.sent,i={
algorithm:"RS256",jwtid:Math.random().toString(16).substring(2,10),audience:r.token_endpoint,issuer:e.client_id,subject:e.client_id,expiresIn:600},
n="Bearer ".concat(h.sign({},e.client_private_key,i)),t.next=13;break;case 9:s=e.client_id,o=e.client_secret,s=encodeURIComponent(s),n="Basic ".concat(A.encode("".concat(s,":").concat(o)));case 13:
return t.abrupt("return",n);case 14:case"end":return t.stop()}}),t,this)}))),function(t){return o.apply(this,arguments)})},{key:"_getOidcScope",value:function(t){
return Array.isArray(t)?"".concat(this._defaultScope," ").concat(t.join(" ")):t?"".concat(this._defaultScope," ").concat(t):this._defaultScope}},{key:"_getTokenTypeHint",value:function(t){
return this._accessTokenPattern.test(t)?I:this._refreshTokenPattern.test(t)?D:N.test(t)?R:null}}])&&c(e.prototype,n),s&&c(e,s),t}();t.exports=j},function(t,e){},function(t,e,n){"use strict"
;function r(t,e,n,r,i,s,o){try{var a=t[s](o),u=a.value}catch(t){return void n(t)}a.done?e(u):Promise.resolve(u).then(r,i)}function i(t,e){
if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,
"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}
var o=n(2).AppClient,a=n(1).BaseError,u=n(2),c=u.PerflogHandler,h=u.RemoteErrorHandler,l=u.TransformParametersHandler,f=n(7),d=[c,h,l],p=[h,l],g=new f("discovery",{maxSize:16}),v=function(){
function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(i(this,t),!e)throw new a("Service URI must be defined");var r=n.discoveryPath||".well-known/openid-configuration"
;this._discoveryUri="".concat(e,"/").concat(r.replace(/^\//,"")),this._discoveryCacheTtl=1e3*(n.discoveryCacheTtl?Number(n.discoveryCacheTtl):3600)
;var s="boolean"!=typeof n.perflogEnabled||n.perflogEnabled,u=s?d:p;this._client=new o(Object.assign(n,{interceptors:u}))}var e,n,u,c,h;return e=t,(n=[{key:"getMetadata",
value:(c=regeneratorRuntime.mark((function t(){var e,n,r,i=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=i.length>0&&void 0!==i[0]&&i[0],
(n=g.get(this._discoveryUri))&&!e){t.next=8;break}return t.next=5,this._client.get(this._discoveryUri);case 5:r=t.sent,n=r.data,g.set(this._discoveryUri,n,this._discoveryCacheTtl);case 8:
return t.abrupt("return",n);case 9:case"end":return t.stop()}}),t,this)})),h=function(){var t=this,e=arguments;return new Promise((function(n,i){var s=c.apply(t,e);function o(t){r(s,n,i,o,a,"next",t)}
function a(t){r(s,n,i,o,a,"throw",t)}o(void 0)}))},function(){return h.apply(this,arguments)})}])&&s(e.prototype,n),u&&s(e,u),t}();t.exports=v},function(t,e,n){"use strict";function r(t,e,n,r,i,s,o){
try{var a=t[s](o),u=a.value}catch(t){return void n(t)}a.done?e(u):Promise.resolve(u).then(r,i)}function i(t){return function(){var e=this,n=arguments;return new Promise((function(i,s){
var o=t.apply(e,n);function a(t){r(o,i,s,a,u,"next",t)}function u(t){r(o,i,s,a,u,"throw",t)}a(void 0)}))}}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}
function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}
var a=n(1).BaseError,u=n(2).AppClient,c=n(0).InvalidCredentials,h=n(2),l=h.PerflogHandler,f=h.RemoteErrorHandler,d=h.TransformParametersHandler,p=n(7),g=n(29),v=[l,f,d],y=[f,d],m=new p("jwks",{
maxSize:16}),S=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(s(this,t),!e)throw new a("Instance of discovery must be provided");this._discovery=e,
this._jwksCacheTtl=1e3*(n.jwksCacheTtl?Number(n.jwksCacheTtl):3600),this._tokenTimeLeeway=n.tokenTimeLeeway?Number(n.tokenTimeLeeway):300
;var r="boolean"!=typeof n.perflogEnabled||n.perflogEnabled,i=r?v:y;this._client=new u(Object.assign(n,{interceptors:i}))}var e,n,r,h,l,f;return e=t,(n=[{key:"getPublicKeyData",
value:(f=i(regeneratorRuntime.mark((function t(e){var n,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getPublicKeySet();case 2:if(n=t.sent,
r=n&&n.keys.find((function(t){return t.kid===e}))){t.next=17;break}return t.next=7,this.getPublicKeySet(!0);case 7:if(n=t.sent,r=n&&n.keys.find((function(t){return t.kid===e}))){t.next=17;break}
return t.t0=c,t.t1="Unable to obtain public JWK key with jwk_id=".concat(e," from "),t.next=14,this._discovery.getMetadata();case 14:throw t.t2=t.sent.issuer,t.t3=t.t1.concat.call(t.t1,t.t2,"."),
new t.t0(t.t3);case 17:return t.abrupt("return",r);case 18:case"end":return t.stop()}}),t,this)}))),function(t){return f.apply(this,arguments)})},{key:"getPublicKeySet",
value:(l=i(regeneratorRuntime.mark((function t(){var e,n,r,i,s=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=s.length>0&&void 0!==s[0]&&s[0],
t.next=3,this._discovery.getMetadata();case 3:if(n=t.sent,r=n.issuer,(i=m.get(r))&&!e){t.next=11;break}return t.next=9,this._client.get(n.jwks_uri);case 9:i=t.sent.data,m.set(r,i,this._jwksCacheTtl)
;case 11:return t.abrupt("return",i);case 12:case"end":return t.stop()}}),t,this)}))),function(){return l.apply(this,arguments)})},{key:"decodeToken",value:(h=i(regeneratorRuntime.mark((function t(e){
var n,r,i,s,o,a=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=!(a.length>1&&void 0!==a[1])||a[1],r=null,t.prev=2,t.next=5,g.decode(e,{complete:!0})
;case 5:r=t.sent,t.next=11;break;case 8:throw t.prev=8,t.t0=t.catch(2),new c("Token is not valid.",t.t0);case 11:if(!n){t.next=38;break}return t.next=14,this.getPublicKeyData(r.header.kid);case 14:
return i=t.sent,s={},t.next=18,this._discovery.getMetadata();case 18:if(s.issuer=t.sent.issuer,o=i.alg){t.next=28;break}return t.next=23,this._discovery.getMetadata();case 23:
if(t.t1=t.sent.id_token_signing_alg_values_supported,t.t1){t.next=26;break}t.t1=[];case 26:(o=t.t1[0])||(o="RS256");case 28:return s.algorithms=o,s.clockTolerance=300,t.prev=30,t.next=33,
g.verify(e,i,s);case 33:t.next=38;break;case 35:throw t.prev=35,t.t2=t.catch(30),new c("Token is not valid or is expired.",t.t2);case 38:return t.abrupt("return",r.payload);case 39:case"end":
return t.stop()}}),t,this,[[2,8],[30,35]])}))),function(t){return h.apply(this,arguments)})},{key:"verifyExpiration",value:function(t){
if(t.exp<Date.now()/1e3-this._tokenTimeLeeway)throw new c("Token is not valid or is expired.")}}])&&o(e.prototype,n),r&&o(e,r),t}();t.exports=S},function(t,e,n){"use strict";function r(t,e){
return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,i=!1,s=void 0;try{
for(var o,a=t[Symbol.iterator]();!(r=(o=a.next()).done)&&(n.push(o.value),!e||n.length!==e);r=!0);}catch(t){i=!0,s=t}finally{try{r||null==a.return||a.return()}finally{if(i)throw s}}return n
}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return i(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name)
;if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(t,e)}(t,e)||function(){
throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(t,e){
(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function s(t,e,n,r,i,s,o){try{var a=t[s](o),u=a.value}catch(t){return void n(t)}
a.done?e(u):Promise.resolve(u).then(r,i)}function o(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function a(t){s(o,r,i,a,u,"next",t)}function u(t){
s(o,r,i,a,u,"throw",t)}a(void 0)}))}}function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),
Object.defineProperty(t,r.key,r)}}var u=n(8),c=n(1).BaseError,h=n(14),l=h.KJUR,f=h.KEYUTIL,d=function(){function t(){!function(t,e){
if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,i,s,h;return e=t,n=null,i=[{key:"decode",value:(h=o(regeneratorRuntime.mark((function t(e){
var n,i,s,o,a,c,h=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=(n=h.length>1&&void 0!==h[1]?h[1]:{})||{},i=e.split("."),s=r(i,3),o=s[0],a=s[1],c=s[2],
a=u.urlSafeDecode(a),a=JSON.parse(a),!0!==n.complete){t.next=11;break}return o=u.urlSafeDecode(o),o=JSON.parse(o),t.abrupt("return",{header:o,payload:a,signature:c});case 11:
return t.abrupt("return",a);case 12:case"end":return t.stop()}}),t)}))),function(t){return h.apply(this,arguments)})},{key:"verify",value:(s=o(regeneratorRuntime.mark((function t(e,n){
var r,i,s,o,a=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=a.length>2&&void 0!==a[2]?a[2]:{},i={},
(r=r||{}).algorithms&&(i.alg=Array.isArray(r.algorithms)?r.algorithms:[r.algorithms]),r.audience&&(i.aud=Array.isArray(r.audience)?r.audience:[r.audience]),
r.issuer&&(i.iss=Array.isArray(r.issuer)?r.issuer:[r.issuer]),r.subject&&(i.sub=Array.isArray(r.subject)?r.subject:[r.subject]),r.clockTolerance&&(i.gracePeriod=r.clockTolerance),s=f.getKey(n),o=!1,
t.prev=10,o=l.jws.JWS.verifyJWT(e,s,i),t.next=17;break;case 14:throw t.prev=14,t.t0=t.catch(10),new c("Verification failed: ".concat(t.t0.message||t.t0));case 17:if(o){t.next=19;break}
throw new c("Token is not valid or is expired.");case 19:case"end":return t.stop()}}),t,null,[[10,14]])}))),function(t,e){return s.apply(this,arguments)})}],n&&a(e.prototype,n),i&&a(e,i),t}()
;t.exports=d},function(t,e){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){
return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(t){
"object"===("undefined"==typeof window?"undefined":n(window))&&(r=window)}t.exports=r},function(t,e,n){"use strict";e.byteLength=function(t){var e=c(t),n=e[0],r=e[1];return 3*(n+r)/4-r},
e.toByteArray=function(t){var e,n,r=c(t),o=r[0],a=r[1],u=new s(function(t,e,n){return 3*(e+n)/4-n}(0,o,a)),h=0,l=a>0?o-4:o
;for(n=0;n<l;n+=4)e=i[t.charCodeAt(n)]<<18|i[t.charCodeAt(n+1)]<<12|i[t.charCodeAt(n+2)]<<6|i[t.charCodeAt(n+3)],u[h++]=e>>16&255,u[h++]=e>>8&255,u[h++]=255&e
;2===a&&(e=i[t.charCodeAt(n)]<<2|i[t.charCodeAt(n+1)]>>4,u[h++]=255&e);1===a&&(e=i[t.charCodeAt(n)]<<10|i[t.charCodeAt(n+1)]<<4|i[t.charCodeAt(n+2)]>>2,u[h++]=e>>8&255,u[h++]=255&e);return u},
e.fromByteArray=function(t){for(var e,n=t.length,i=n%3,s=[],o=0,a=n-i;o<a;o+=16383)s.push(h(t,o,o+16383>a?a:o+16383));1===i?(e=t[n-1],s.push(r[e>>2]+r[e<<4&63]+"==")):2===i&&(e=(t[n-2]<<8)+t[n-1],
s.push(r[e>>10]+r[e>>4&63]+r[e<<2&63]+"="));return s.join("")}
;for(var r=[],i=[],s="undefined"!=typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,u=o.length;a<u;++a)r[a]=o[a],i[o.charCodeAt(a)]=a
;function c(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");return-1===n&&(n=e),[n,n===e?0:4-n%4]}function h(t,e,n){
for(var i,s,o=[],a=e;a<n;a+=3)i=(t[a]<<16&16711680)+(t[a+1]<<8&65280)+(255&t[a+2]),o.push(r[(s=i)>>18&63]+r[s>>12&63]+r[s>>6&63]+r[63&s]);return o.join("")}i["-".charCodeAt(0)]=62,
i["_".charCodeAt(0)]=63},function(t,e){e.read=function(t,e,n,r,i){var s,o,a=8*i-r-1,u=(1<<a)-1,c=u>>1,h=-7,l=n?i-1:0,f=n?-1:1,d=t[e+l];for(l+=f,s=d&(1<<-h)-1,d>>=-h,h+=a;h>0;s=256*s+t[e+l],l+=f,h-=8);
for(o=s&(1<<-h)-1,s>>=-h,h+=r;h>0;o=256*o+t[e+l],l+=f,h-=8);if(0===s)s=1-c;else{if(s===u)return o?NaN:1/0*(d?-1:1);o+=Math.pow(2,r),s-=c}return(d?-1:1)*o*Math.pow(2,s-r)},
e.write=function(t,e,n,r,i,s){var o,a,u,c=8*s-i-1,h=(1<<c)-1,l=h>>1,f=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,d=r?0:s-1,p=r?1:-1,g=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),
isNaN(e)||e===1/0?(a=isNaN(e)?1:0,o=h):(o=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-o))<1&&(o--,u*=2),(e+=o+l>=1?f/u:f*Math.pow(2,1-l))*u>=2&&(o++,u/=2),o+l>=h?(a=0,
o=h):o+l>=1?(a=(e*u-1)*Math.pow(2,i),o+=l):(a=e*Math.pow(2,l-1)*Math.pow(2,i),o=0));i>=8;t[n+d]=255&a,d+=p,a/=256,i-=8);for(o=o<<i|a,c+=i;c>0;t[n+d]=255&o,d+=p,o/=256,c-=8);t[n+d-p]|=128*g}
},function(t,e){var n={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==n.call(t)}},function(t,e,n){"use strict";function r(t){
return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){
return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e,n,r,i,s,o){try{var a=t[s](o),u=a.value}catch(t){return void n(t)}
a.done?e(u):Promise.resolve(u).then(r,i)}function s(t){return function(){var e=this,n=arguments;return new Promise((function(r,s){var o=t.apply(e,n);function a(t){i(o,r,s,a,u,"next",t)}function u(t){
i(o,r,s,a,u,"throw",t)}a(void 0)}))}}function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),
Object.defineProperty(t,r.key,r)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){var e=function(){
if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{
return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=h(t);if(e){var i=h(this).constructor
;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return c(this,n)}}function c(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){
if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function h(t){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(t){
return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function")
;t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}(l,t);var e,n,r,i,c,h=u(l);function l(){return function(t,e){
if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),h.call(this,{authenticationTime:new Date(Date.now()),authenticationLevelOfAssurance:0,identity:null,
clientIdentity:null,applicationIdentity:null,attributes:{}})}return e=l,(n=[{key:"getServiceName",value:function(){return null}},{key:"getServiceUri",value:(c=s(regeneratorRuntime.mark((function t(){
return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",null);case 1:case"end":return t.stop()}}),t)}))),function(){return c.apply(this,arguments)})},{
key:"getProviderUri",value:function(){return null}},{key:"getCallToken",value:(i=s(regeneratorRuntime.mark((function t(e){var n=arguments;return regeneratorRuntime.wrap((function(t){
for(;;)switch(t.prev=t.next){case 0:return n.length>1&&void 0!==n[1]&&n[1],t.abrupt("return",null);case 2:case"end":return t.stop()}}),t)}))),function(t){return i.apply(this,arguments)})
}])&&o(e.prototype,n),r&&o(e,r),l}(n(0).Session);t.exports=l},function(t,e){
var n=new Function("try {return this===window;}catch(e){ return false;}")()?"interactive"===document.readyState||"complete"===document.readyState?Promise.resolve():new Promise((function(t){
document.addEventListener("DOMContentLoaded",t,!1)})):Promise.resolve();t.exports={domReady:n}},function(t,e,n){var r=n(17),i=function t(e){var n=Object.assign({},e),i={loginWindow:null,
closeCheckInterval:null};r.registerForCallback(this,i),this.finalize=function(t){this.finalize=function(){},this.destroy(),n.onResult&&n.onResult(t)}.bind(this);var s=function(){
i.loginWindow&&i.loginWindow.closed&&this.finalize(!1)}.bind(this);this.render=function(){var e=this;if(!i.loginWindow){var r={width:n.width||599,height:n.height||600}
;r.left=(screen.availWidth-r.width)/2+(screen.availLeft||0),r.top=(screen.availHeight-r.height)/2+(screen.availTop||0),
i.loginWindow=window.open(n.url,"_blank","toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=yes,resizable=yes,copyhistory=no,width=".concat(r.width,",height=").concat(r.height,",top=").concat(r.top,",left=").concat(r.left)),
i.loginWindow?i.closeCheckInterval=setInterval(s.bind(this),200):Promise.resolve().then((function(){return e.finalize(t.ERROR_POPUP_BLOCKED)}))}},this.focus=function(){
i.loginWindow&&i.loginWindow.focus()},this.destroy=function(){i.loginWindow&&!i.loginWindow.closed&&i.loginWindow.close(),i.closeCheckInterval&&clearInterval(i.closeCheckInterval),
this.destroy=function(){},r.unregisterForCallback(this)}};i.ERROR_POPUP_BLOCKED="POPUP_BLOCKED",t.exports=i},function(t,e,n){var r=n(17);t.exports=function(t){var e=Object.assign({},t),n={iframe:null}
;Object.defineProperty(n,"loginWindow",{get:function(){try{return null!=n.iframe?n.iframe.contentWindow:null}catch(t){}return null}}),r.registerForCallback(this,n),this.finalize=function(t){
this.finalize=function(){},this.destroy(),e.onResult&&e.onResult(t)}.bind(this),this.render=function(){var t=this;if(!n.iframe){
var r=new Error("Server did not provide expected callback HTML page. Check if requested URL "+e.url+" contains proper redirect parameter. If so, look also into network console for possible callback response error.")
;n.iframe=document.createElement("iframe"),n.iframe.style.cssText="position: absolute;top: -300px; left: -300px; width: 200px; height: 200px; opacity: 0;",n.iframe.src=e.url,
n.iframe.onload=function(){return t.finalize(r)},n.iframe.onerror=function(){return t.finalize(r)},document.body.appendChild(n.iframe),e.timeout&&(this._timeout=setTimeout((function(){
t.finalize(new Error("OIDC iframe didn't receive callback within "+e.timeout+"s."))}),1e3*e.timeout))}},this.destroy=function(){
n.iframe&&n.iframe.parentNode&&n.iframe.parentNode.removeChild(n.iframe),this.destroy=function(){},this._timeout&&clearTimeout(this._timeout),r.unregisterForCallback(this)}}},function(t,e){
t.exports=function(t){var e=Object.assign({},t);this.render=function(){location.href=e.url,setTimeout((function(){e.onResult(new Error("Login aborted"))}),1e4)}}},function(t,e,n){"use strict"
;function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){
return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e,n,r,i,s,o){try{var a=t[s](o),u=a.value}catch(t){return void n(t)}
a.done?e(u):Promise.resolve(u).then(r,i)}function s(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),
Object.defineProperty(t,r.key,r)}}function o(t,e){return(o=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function a(t){var e=function(){
if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{
return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=c(t);if(e){var i=c(this).constructor
;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return u(this,n)}}function u(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){
if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){
return t.__proto__||Object.getPrototypeOf(t)})(t)}var h=n(0).AuthenticationError,l=n(5),f=function(t){!function(t,e){
if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}
}),e&&o(t,e)}(d,t);var e,n,r,u,c,f=a(d);function d(t,e,n){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,d),f.call(this,t,e,n,null)}
return e=d,(n=[{key:"authenticate",value:(u=regeneratorRuntime.mark((function t(e){var n,r,i,s,o,a,u,c,f=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:
if(n=f.length>1&&void 0!==f[1]?f[1]:null,r=e.os8Token){t.next=4;break}throw new h("Authentication using Os8Flow requires option 'os8Token' passed to the authentication call.");case 4:return t.next=6,
l.getClientCredentials(this._serviceName);case 6:return i=t.sent,s=i.client_id,o={subject_token:r,response_type:"id_token",client_id:s,redirect_uri:this._redirectUri},
a=Object.keys(o).filter((function(t){return null!=o[t]})).map((function(t){return encodeURIComponent(t)+"="+encodeURIComponent(o[t]+"")})),
u=this._oauthClient.getServiceUri().replace(/\/*$/,"/")+"exchangeOs8Token?"+a.join("&"),t.next=13,this.sendRequest(u);case 13:return c=t.sent,t.next=16,
this._processAuthResponse(c,null,null,n,null,null,s);case 16:return t.abrupt("return",t.sent);case 17:case"end":return t.stop()}}),t,this)})),c=function(){var t=this,e=arguments
;return new Promise((function(n,r){var s=u.apply(t,e);function o(t){i(s,n,r,o,a,"next",t)}function a(t){i(s,n,r,o,a,"throw",t)}o(void 0)}))},function(t){return c.apply(this,arguments)})
}])&&s(e.prototype,n),r&&s(e,r),d}(n(11));t.exports=f},function(t,e,n){"use strict";function r(t,e,n,r,i,s,o){try{var a=t[s](o),u=a.value}catch(t){return void n(t)}
a.done?e(u):Promise.resolve(u).then(r,i)}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),
Object.defineProperty(t,r.key,r)}}var s=n(3).LoggerFactory,o=function(){function t(e,n,r,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),
this._authnFlow=e,this._enabled=!0,this._sessionCheckInterval=n,this._clientId=r,this._getSessionStateFn=i,this._listeners=[],this._unknownStateListeners=[],this._notifyUnknownState=!0,
this._logger=s.get("uuapp.oidc.internal.SessionStateChangeNotifier"),this._stateCheckInterval=setInterval(this._checkState.bind(this),1e3*this._sessionCheckInterval)}var e,n,o,a,u;return e=t,(n=[{
key:"enable",value:function(){this._enabled=!0}},{key:"disable",value:function(){this._enabled=!1}},{key:"onStateChange",value:function(t){var e=this;return this._listeners.push(t),function(){
var n=e._listeners.indexOf(t);return-1!=n&&e._listeners.splice(n,1),-1!=n}}},{key:"onStateUnknown",value:function(t){var e=this;return this._unknownStateListeners.push(t),function(){
var n=e._unknownStateListeners.indexOf(t);return-1!=n&&e._unknownStateListeners.splice(n,1),-1!=n}}},{key:"destroy",value:function(){this._destroyed||(this._destroyed=!0,
this._stateCheckInterval&&clearInterval(this._stateCheckInterval),delete this._stateCheckInterval,this._listeners=[],this._unknownStateListeners=[],this._notifyUnknownState=!0)}},{key:"_checkState",
value:(a=regeneratorRuntime.mark((function t(){var e,n,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._enabled){t.next=2;break}return t.abrupt("return")
;case 2:if(e=this._getSessionStateFn()){t.next=5;break}return t.abrupt("return");case 5:return n=this._clientId+" "+e,this._logger.debug("Checking session state."),t.next=9,
this._authnFlow.checkSession(n);case 9:"changed"===(r=t.sent)?(this._logger.debug("Received session state change notification (message: '".concat(r,"').")),this._notifyUnknownState=!0,
this._listeners.forEach((function(t){return t()}))):"unknown"===r?(this._logger.debug("Received session state change notification (message: '".concat(r,"').")),
this._notifyUnknownState&&(this._logger.debug("Propagating info about '".concat(r,"' session state.")),this._unknownStateListeners.forEach((function(t){return t()})),
this._notifyUnknownState=!1)):this._notifyUnknownState=!0;case 11:case"end":return t.stop()}}),t,this)})),u=function(){var t=this,e=arguments;return new Promise((function(n,i){var s=a.apply(t,e)
;function o(t){r(s,n,i,o,u,"next",t)}function u(t){r(s,n,i,o,u,"throw",t)}o(void 0)}))},function(){return u.apply(this,arguments)})}])&&i(e.prototype,n),o&&i(e,o),t}();t.exports=o},function(t,e,n){
function r(t,e,n,r,i,s,o){try{var a=t[s](o),u=a.value}catch(t){return void n(t)}a.done?e(u):Promise.resolve(u).then(r,i)}function i(t){return function(){var e=this,n=arguments
;return new Promise((function(i,s){var o=t.apply(e,n);function a(t){r(o,i,s,a,u,"next",t)}function u(t){r(o,i,s,a,u,"throw",t)}a(void 0)}))}}function s(t,e){for(var n=0;n<e.length;n++){var r=e[n]
;r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}
var o=n(1).Config,a=n(15).UriBuilder,u=n(3).LoggerFactory,c=n(9),h=n(42),l=n(10),f=document.querySelector("base"),d=location.protocol+"//"+location.host+(f&&f.getAttribute("data-uu-app-base")||"")||"/",p=(new RegExp("uu.app.cbu=([^;]+)").exec(document.cookie)||[])[1],g="uu_app_oidc_providers_",v=["none","low","medium","high","veryHigh"],y=["none","low","standard","high","veryHigh"],m=u.get("uuapp.oidc.Session"),S=function(){
function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,r;return e=t,r=[{key:"from",value:function(t,e,n,r,s){
return t?(t._authnCtx=e||null,t.getAuthenticationContext=function(){return this._authnCtx}.bind(t),t._expiresAt=n||null,t.getExpiresAt=function(){return this._expiresAt}.bind(t),t._state=r||null,
t.getState=function(){return this._state}.bind(t),Object.defineProperty(t,"_authnService",{get:function(){return s},enumerable:!1}),t.getCallTokenScope=function(){
var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e?e.scopeMode:null;if(!n){
var r="".concat(this._configPrefix,"default_call_token_scope_mode");n=o.getString(r)||"allUseCases"}if(!t||"none"===n)return null;var i=null
;if((t=t.toString()).startsWith(d)||p&&t.startsWith(p))i=(i=p||d).replace(/\/$/,"");else try{var s=a.parse(t);s.clearParameters(),s.setUseCase(null),i=s.toUri().toString()}catch(e){
i=(i=t.split("?")[0]).replace(/\/$/,"")}return i}.bind(t),t.getCallToken=i(regeneratorRuntime.mark((function e(){var n,r,i,s,a,u=arguments;return regeneratorRuntime.wrap((function(e){
for(;;)switch(e.prev=e.next){case 0:if(n=u.length>0&&void 0!==u[0]?u[0]:null,r=u.length>1&&void 0!==u[1]?u[1]:{},!n||n.startsWith(d)||p&&n.startsWith(p)){e.next=8;break}return e.next=5,
h.getCallToken(t,n,r);case 5:i=e.sent,e.next=11;break;case 8:(s=r?r.callTokenType:null)||(a="".concat(this._configPrefix,"call_token_type"),s=o.getString(a)),
"idToken"===s?i=this._idToken:"accessToken"===s?i=this._accessToken:s||(i=this._idToken||this._accessToken);case 11:if(!i){e.next=20;break}if(!0!==(!!r&&r.excludeAuthenticationType)){e.next=17;break}
return e.abrupt("return",i);case 17:return e.abrupt("return","Bearer ".concat(i));case 18:e.next=21;break;case 20:return e.abrupt("return",null);case 21:case"end":return e.stop()}}),e,this)
}))).bind(t),t.close=i(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.removeFromCache(),!this._authenticated){e.next=15
;break}return e.prev=2,e.next=5,t._authnService._authnFlow.endSession(t);case 5:"function"==typeof this._onCloseListener&&this._onCloseListener(this),t._authenticated=!1,t._idToken=null,
t._accessToken=null,e.next=15;break;case 11:e.prev=11,e.t0=e.catch(2),m.warn("Logout finished but session might not be cancelled - server responded with unexpected callback.",e.t0),
t._authnService.checkSession();case 15:case"end":return e.stop()}}),e,this,[[2,11]])}))).bind(t),t.matches=function(t,e){var n,r;if(t){var i=this._supportedAcrValues,s=t.toString()
;i.includes("medium")?s=s.replace("standard","medium"):i.includes("standard")&&(s=s.replace("medium","standard"));var o=s.split(" "),a=[];o.forEach((function(t){var e=Number(t)
;isNaN(e)&&((e=i.indexOf(t))<0&&(e=y.indexOf(t)),e<0&&(e=v.indexOf(t))),e>=0&&a.push(e)})),n=Math.min.apply(Math,a)}e&&(r=e);try{return this.assertTrustiness({minAuthenticationLevelOfAssurance:n,
maxAuthenticationAge:r}),!0}catch(t){return!1}}.bind(t),t.storeToCache=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e={attributes:this._attributes,
acrValues:this._supportedAcrValues,idToken:this._idToken,acccessToken:this._accessToken,authnCtx:this._authnCtx,expiresAt:this._expiresAt,state:this._state,authConstraints:this._authConstraints,
userAgent:l.sha1(navigator.userAgent)},n="".concat(g).concat(this._serviceName,"_session");t&&(n+="_".concat(l.sha1(t))),sessionStorage.setItem(n,JSON.stringify(e))}.bind(t),
t.removeFromCache=function(){var t="".concat(g).concat(this._serviceName,"_session");Object.keys(sessionStorage).forEach((function(e){e&&e.toString().startsWith(t)&&sessionStorage.removeItem(e)}))
}.bind(t),t):t}},{key:"loadFromCache",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=e.getServiceName(),i="".concat(g).concat(r,"_session")
;n&&(i+="_".concat(l.sha1(n)));var s=sessionStorage.getItem(i);if(!s)return null;try{s=JSON.parse(s)
;var a=Date.now()/1e3,u=s.attributes.exp,h=o.getNumber("uu_app_oidc_providers_"+r+"_token_refresh_leeway");if(null==h&&(h=o.getNumber("uuoidc.tokenRefreshLeeway")),null==h&&(h=300),
s.expiresAt&&s.expiresAt<=a||u&&u-h<=a)return m.warn("Cached session for ".concat(r," is expired.")),sessionStorage.removeItem(i),null
;if(s.userAgent!=l.sha1(navigator.userAgent))return m.warn("UserAgent does not match on cached session for service ".concat(r,".")),sessionStorage.removeItem(i),null
;var f=e._oauthClient,d=new c(r,f,s.acrValues,s.attributes,s.idToken,s.acccessToken);return d._authConstraints=s.authConstraints,t.from(d,s.authnCtx,s.expiresAt,s.state,e)}catch(t){
return m.error("Unable to restore cached session for ".concat(r,"."),t),null}}}],(n=null)&&s(e.prototype,n),r&&s(e,r),t}();t.exports=S},function(t,e,n){"use strict";function r(t,e,n,r,i,s,o){try{
var a=t[s](o),u=a.value}catch(t){return void n(t)}a.done?e(u):Promise.resolve(u).then(r,i)}function i(t){return function(){var e=this,n=arguments;return new Promise((function(i,s){var o=t.apply(e,n)
;function a(t){r(o,i,s,a,u,"next",t)}function u(t){r(o,i,s,a,u,"throw",t)}a(void 0)}))}}function s(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,
"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function o(t,e,n){return e&&s(t.prototype,e),n&&s(t,n),t}
var a=n(1).Config,u=n(3).LoggerFactory,c=n(11),h=n(18),l=document.querySelector("base"),f=location.protocol+"//"+location.host+(l&&l.getAttribute("data-uu-app-base")||"/"),d=function(){var t,e,n
;function r(t,e){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r),this._serviceName=t.getServiceName(),this._callUri=e
;var i=a.getString("uu_app_oidc_redirect_uri");if(i)i=this._toFullAppUrl(i);else{var s=a.getString("uuoidc.redirectUri")
;s||a.getBoolean("uu_app_oidc_backend_available")||(s="callbacks/oidc-callback.html"),i=s?this._toFullUrl(s):this._toFullAppUrl("/oidc/callback")}
this._configPrefix="".concat("uu_app_oidc_providers_").concat(this._serviceName,"_"),this._tokenTimeLeeway=a.getNumber("".concat(this._configPrefix,"token_time_leeway"),!1)||300,
this._logger=u.get("uuapp.oidc.ExternalCallTokenProvider"),this._authnFlow=t._authnService._authnFlow,this._authnFlow instanceof h&&(this._authnFlow=new c(t._oauthClient,this._serviceName,i,f)),
this._runningPromise=null,this._idToken=null,this._accessToken=null,this._expireAt=null,t._authnService.addListener("sessionChanged",(function(){n._refreshCallToken()}))}return o(r,null,[{
key:"getCallToken",value:(t=i(regeneratorRuntime.mark((function t(e,n,r){var i,s,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:
if((i=e.getServiceName())&&e._oauthClient){t.next=3;break}return t.abrupt("return",null);case 3:return n=n?n.toString():"",s="".concat(i,"|").concat(n),(o=this._providers[s])||(o=new this(e,n),
this._providers[s]=o),t.abrupt("return",o._getCallToken(r));case 8:case"end":return t.stop()}}),t,this)}))),function(e,n,r){return t.apply(this,arguments)})}]),o(r,[{key:"_getCallToken",
value:(n=i(regeneratorRuntime.mark((function t(){var e,n,r,i,s,o,u,c,h,l=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:
if(e=l.length>0&&void 0!==l[0]?l[0]:{},!this._isExpired()){t.next=23;break}return this._runningPromise||(this._logger.debug("Requesting new call token for ".concat(this._callUri)),n={prompt:"none",
usePopup:!1},this._runningPromise=this._authnFlow.authenticate(n,this._callUri)),t.prev=3,t.next=6,this._runningPromise;case 6:r=t.sent,i=r.idToken,s=r.accessToken,o=r.claims,this._idToken=i,
this._accessToken=s,this._expireAt=1e3*o.exp,this._logger.debug("Call token for ".concat(this._callUri," received")),t.next=20;break;case 16:return t.prev=16,t.t0=t.catch(3),
this._logger.error("Unable to get call token for ".concat(this._callUri),t.t0),t.abrupt("return",null);case 20:return t.prev=20,this._runningPromise=null,t.finish(20);case 23:return u=null,
(c=e?e.callTokenType:null)||(h="".concat(this._configPrefix,"call_token_type"),c=a.getString(h)),
"idToken"===c?u=this._idToken:"accessToken"===c?u=this._accessToken:c||(u=this._idToken||this._accessToken),t.abrupt("return",u);case 28:case"end":return t.stop()}}),t,this,[[3,16,20,23]])}))),
function(){return n.apply(this,arguments)})},{key:"_refreshCallToken",value:(e=i(regeneratorRuntime.mark((function t(){var e,n,r,i,s;return regeneratorRuntime.wrap((function(t){
for(;;)switch(t.prev=t.next){case 0:return this._runningPromise||(this._idToken=null,this._accessToken=null,this._expireAt=null,
this._logger.debug("Refreshing call token for ".concat(this._callUri," invoked by session change")),e={prompt:"none",usePopup:!1},this._runningPromise=this._authnFlow.authenticate(e,this._callUri)),
t.prev=1,t.next=4,this._runningPromise;case 4:n=t.sent,r=n.idToken,i=n.accessToken,s=n.claims,this._idToken=r,this._accessToken=i,this._expireAt=1e3*s.exp,
this._logger.debug("Call token for ".concat(this._callUri," refreshed")),t.next=20;break;case 14:t.prev=14,t.t0=t.catch(1),
t.t0&&(t.t0.code&&t.t0.code.match(/(interaction|login|account_selection|consent)_required/i)||t.t0.message&&t.t0.message.match(/interaction required/i))?this._logger.debug("Refresh of call token for ".concat(this._callUri," failed, due to user interaction is required (").concat(t.t0.code,").")):this._logger.error("Unable to refresh call token for ".concat(this._callUri),t.t0),
this._idToken=null,this._accessToken=null,this._expireAt=null;case 20:return t.prev=20,this._runningPromise=null,t.finish(20);case 23:case"end":return t.stop()}}),t,this,[[1,14,20,23]])}))),
function(){return e.apply(this,arguments)})},{key:"_isExpired",value:function(){return!this._expireAt||Date.now()>=this._expireAt-2*this._tokenTimeLeeway}},{key:"_toFullAppUrl",value:function(t){
var e=document.createElement("a");return e.href=t&&t.match(/^[a-z]+:/i)?t:f+(t?t.replace(/^\/+/,""):""),e.href.toString()}},{key:"_toFullUrl",value:function(t){var e=document.createElement("a")
;return e.href=t||"",e.href.toString()}}]),r}();d._providers={},t.exports=d},function(t,e){function n(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0
}):t[e]=n,t}function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var i=function(){
function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,i,s;return e=t,s=[{key:"wrapClass",value:function(e,n){var r
;return Object.defineProperty(e,"currentSession",{get:function(){return r||(r=t.initG01Session(e,n)),r}}),Object.defineProperty(e,"initComplete",{get:function(){return n._onPageLoadFinished}}),
Object.defineProperty(e,"initPromise",{get:function(){return n._onPageLoad().then((function(i){return r||(r=t.initG01Session(e,n)),r}))}}),e}},{key:"initG01Session",value:function(t,e){
var r=t._createEmptySession();Object.defineProperty(r,"initComplete",{get:function(){return e._onPageLoadFinished}}),Object.defineProperty(r,"initPromise",{get:function(){
return e._onPageLoad().then((function(){return r}))}});var i=null,s=function(){return i||e.getCurrentSession()};r.getIdentity=function(){var t=s(),e=t.getIdentity()
;return e?(e.id=t.getAttribute("sub"),e.name=e.getName(),e.email=t.getAttribute("email"),e.uuIdentity=e.getUuIdentity(),e.levelOfAssurance=e.getLevelOfAssurance(),
e.loginLevelOfAssurance=t.getAuthenticationLevelOfAssurance(),e):e},r.getClaims=function(){return s()._attributes},r.getCallToken=function(){
var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("string"==typeof t||Array.isArray(t))return s().getCallToken(t,e)
;var n=s();return{token:n._idToken||n._accessToken,tokenType:n._idToken?"Bearer":null}},r.isExpiring=function(){return e.isSessionExpiring()},r.isAuthenticated=function(){return s().isAuthenticated()
},r.login=function(t){var i=function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?Object(arguments[e]):{},i=Object.keys(r)
;"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(r).filter((function(t){return Object.getOwnPropertyDescriptor(r,t).enumerable})))),i.forEach((function(e){
n(t,e,r[e])}))}return t}({},t),s={};return i.access_token&&"urn:ietf:params:oauth:token-type:jwt-uuos8"===i.token_type_hint&&(s={os8Token:i.access_token},delete i.access_token,
delete i.token_type_hint),Object.assign(s,i),e.authenticate(s).then((function(){return r}))},r.logout=function(){return s().close()};var o={};r.addListener=function(n,s){
"identityChange"===n&&(n="sessionChanged");var a=e.addListener(n,(function(e){var n=e.type,o=e.data,a=i;o instanceof t&&(i=o);try{var u=n,c=o instanceof t?r:o
;return"sessionChanged"===n&&(u="identityChange",c=r.getIdentity()),s({type:u,data:c})}finally{i=a}})),u=o[n];return u||(u=o[n]=new Map),u.set(s,a),a},r.removeListener=function(t,e){
"identityChange"===t&&(t="sessionChanged");var n=o[t],r=n?n.get(e):null;return!!r&&(n.delete(e),r())};var a=new Map;return r.addIdentityChangeListener=function(t){
var e=r.addListener("identityChange",(function(e){return t(e.data)}));return a.set(t,e),e},r.removeIdentityChangeListener=function(t){var e=a.get(t);return!!e&&(a.delete(t),e())},
r.getAuthenticationContext=function(){return s().getAuthenticationContext()},r._unwrap=function(){return s()},r}}],(i=null)&&r(e.prototype,i),s&&r(e,s),t}();t.exports=i}])}));