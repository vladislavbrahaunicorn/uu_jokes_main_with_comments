import UU5 from "uu5g04";
import * as Plus4U5 from "uu_plus4u5g01";

let Calls = {
  getData(dtoIn) {
    if (dtoIn && dtoIn.data && dtoIn.data.src) {
      Plus4U5.Common.Calls.call(
        "get",
        dtoIn.data.src,
        {
          done: data => {
            dtoIn.done(typeof data === "object" ? UU5.Common.Tools.streamToString(data) : data);
          },
          fail: dtoIn.fail
        },
        {
          headers: {
            accept: "*/*"
          }
        }
      );
    }
  },

  loadPeopleCardAttributes: dtoIn => {
    Plus4U5.Common.Calls.getPeopleCardAttributes(dtoIn.data.uuIdentity, dtoIn.done, dtoIn.fail);
  },

  loadCmd(dtoIn) {
    if (/^https:\/\/([^.]+\.)?plus4u\.net/.test(dtoIn.data.url)) {
      Plus4U5.Common.Calls.call(dtoIn.data.loadMethod, dtoIn.data.url, { ...dtoIn, data: dtoIn.data.params });
    } else {
      typeof dtoIn.done === "function" && dtoIn.fail(`Url ${dtoIn.data.url} is not safe.`);
    }
  }
};

export default Calls;
