"use strict";
const AuthenticationError = require("./authentication-error.js");

/**
 * Error raised in case session does not meet required criteria
 * (e.g. login too old or authentication level of assurance not met )
 */
class UntrustedCredentials extends AuthenticationError {
  /**
   * Creates new instance of error.
   * @param {Session} session Instance of session not matching requried criteria
   * @param {string} message Error message
   * @param {Error} cause Error cause
   */
  constructor(session, message, cause = null) {
    if (typeof session === "string") {
      cause = message;
      message = session;
      session = null;
    }
    super(message, cause);
    this._session = session;
  }

  /**
   * Returns instance of untrusted session.
   * @returns {Session} Instance of untrusted session
   */
  getSession() {
    return this._session;
  }
}

module.exports = UntrustedCredentials;
