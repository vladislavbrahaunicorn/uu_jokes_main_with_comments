const path = require("path");
const shell = require("shelljs");

const paths = require("../config/paths.js");
const UuCloudConfig = require("./uu_cloud/uu-cloud-config.js");
const Package = require("uu_appg01_devkit-common/src/tools/package.js");

module.exports = class UuCloudDeploy {

  constructor(config) {
    this.config = config;
  }

  async process() {
    shell.mkdir("-p", paths.buildDir);
    let {name, version} = Package.getSingletonSync("package.json").get();
    let uuCloudConfig = new UuCloudConfig(path.resolve("."), name, version, paths.buildDir, this.config);
    let params = this.config.getAll();


    const Task = require("./uu_cloud/task-uu-cloud-logstore-export");
    await new Task(uuCloudConfig, params).process();
  }

};
